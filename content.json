{"meta":{"title":"æœ€å¾Œã®ç¥ˆã‚Šã‚’","subtitle":null,"description":null,"author":"me","url":"https://saigonoinorio.github.io"},"pages":[{"title":"about","date":"2018-12-12T14:14:36.000Z","updated":"2021-11-09T14:13:18.000Z","comments":false,"path":"about/index.html","permalink":"https://saigonoinorio.github.io/about/index.html","excerpt":"","text":"[ã•ãã‚‰è˜ã®hojun] ä¸&nbsp; Mashiro&nbsp; ï¼ˆ çœŸï¼ˆã¾ï¼‰ç™½ï¼ˆã—ã‚ï¼‰ ï¼‰ å¯¹è¯ä¸­... bot_ui_ini()","keywords":"å…³äº"},{"title":"client","date":"2018-12-20T15:13:35.000Z","updated":"2021-11-09T14:13:18.000Z","comments":false,"path":"client/index.html","permalink":"https://saigonoinorio.github.io/client/index.html","excerpt":"","text":"ç›´æ¥ä¸‹è½½ or æ‰«ç ä¸‹è½½ï¼š","keywords":"Androidå®¢æˆ·ç«¯"},{"title":"bangumi","date":"2019-02-10T13:32:48.000Z","updated":"2022-12-20T11:33:59.443Z","comments":false,"path":"bangumi/index.html","permalink":"https://saigonoinorio.github.io/bangumi/index.html","excerpt":"","text":"","keywords":null},{"title":"comment","date":"2018-12-20T15:13:48.000Z","updated":"2021-11-09T14:13:18.000Z","comments":true,"path":"comment/index.html","permalink":"https://saigonoinorio.github.io/comment/index.html","excerpt":"","text":"å¿µä¸¤å¥è¯— å™åˆ«æ¢¦ã€æ‰¬å·ä¸€è§‰ã€‚ ã€å®‹ä»£ã€‘å´æ–‡è‹±ã€Šå¤œæ¸¸å®«Â·äººå»è¥¿æ¥¼é›æ³ã€‹","keywords":"ç•™è¨€æ¿"},{"title":"donate","date":"2018-12-20T15:13:05.000Z","updated":"2022-12-20T11:34:58.202Z","comments":false,"path":"donate/index.html","permalink":"https://saigonoinorio.github.io/donate/index.html","excerpt":"","text":"","keywords":"è°¢è°¢é¥²ä¸»äº†å–µ~"},{"title":"lab","date":"2019-01-05T13:47:59.000Z","updated":"2021-11-09T14:13:18.000Z","comments":false,"path":"lab/index.html","permalink":"https://saigonoinorio.github.io/lab/index.html","excerpt":"","text":"sakuraä¸»é¢˜ balabala","keywords":"Labå®éªŒå®¤"},{"title":"links","date":"2018-12-19T15:11:06.000Z","updated":"2022-12-20T11:32:03.742Z","comments":true,"path":"links/index.html","permalink":"https://saigonoinorio.github.io/links/index.html","excerpt":"","text":"","keywords":"å‹äººå¸"},{"title":"music","date":"2018-12-20T15:14:28.000Z","updated":"2022-12-20T11:30:59.218Z","comments":false,"path":"music/index.html","permalink":"https://saigonoinorio.github.io/music/index.html","excerpt":"","text":"","keywords":"éŸ³ä¹"},{"title":"rss","date":"2018-12-20T15:09:03.000Z","updated":"2021-11-09T14:13:18.000Z","comments":true,"path":"rss/index.html","permalink":"https://saigonoinorio.github.io/rss/index.html","excerpt":"","text":""},{"title":"tags","date":"2018-12-12T14:14:16.000Z","updated":"2021-11-09T14:13:18.000Z","comments":true,"path":"tags/index.html","permalink":"https://saigonoinorio.github.io/tags/index.html","excerpt":"","text":""},{"title":"theme-sakura","date":"2019-01-04T14:53:25.000Z","updated":"2021-11-09T14:13:18.000Z","comments":false,"path":"theme-sakura/index.html","permalink":"https://saigonoinorio.github.io/theme-sakura/index.html","excerpt":"","text":"Hexoä¸»é¢˜Sakuraä¿®æ”¹è‡ªWordPressä¸»é¢˜Sakuraï¼Œæ„Ÿè°¢åŸä½œè€…Mashiro","keywords":"Hexo ä¸»é¢˜ Sakura ğŸŒ¸"},{"title":"video","date":"2018-12-20T15:14:38.000Z","updated":"2021-11-09T14:13:18.000Z","comments":false,"path":"video/index.html","permalink":"https://saigonoinorio.github.io/video/index.html","excerpt":"","text":"var videos = [ { img: 'https://lain.bgm.tv/pic/cover/l/0e/1e/218971_2y351.jpg', title: 'æœèŠ±å¤•èª“â€”â€”äºç¦»åˆ«ä¹‹æœæŸèµ·çº¦å®šä¹‹èŠ±', status: 'å·²è¿½å®Œ', progress: 100, jp: 'ã•ã‚ˆãªã‚‰ã®æœã«ç´„æŸã®èŠ±ã‚’ã‹ã–ã‚ã†', time: 'æ”¾é€æ—¶é—´: 2018-02-24 SUN.', desc: ' ä½åœ¨è¿œç¦»å°˜åš£çš„åœŸåœ°ï¼Œä¸€è¾¹å°†æ¯å¤©çš„äº‹æƒ…ç¼–ç»‡æˆåä¸ºå¸Œæ¯”æ¬§çš„å¸ƒï¼Œä¸€è¾¹é™é™ç”Ÿæ´»çš„ä¼Šæ¬§å¤«äººæ°‘ã€‚åœ¨15å²å·¦å³å¤–è¡¨å°±åœæ­¢æˆé•¿ï¼Œæ‹¥æœ‰æ•°ç™¾å¹´å¯¿å‘½çš„ä»–ä»¬ï¼Œè¢«ç§°ä¸ºâ€œç¦»åˆ«çš„ä¸€æ—â€ï¼Œå¹¶è¢«è§†ä¸ºæ´»ç€çš„ä¼ è¯´ã€‚æ²¡æœ‰åŒäº²çš„ä¼Šæ¬§å¤«å°‘å¥³ç›å¥‡äºšï¼Œè¿‡ç€è¢«ä¼™ä¼´åŒ…å›´çš„å¹³ç¨³æ—¥å­ï¼Œå´æ€»æ„Ÿè§‰â€œå­¤èº«ä¸€äººâ€ã€‚ä»–ä»¬çš„è¿™ç§æ—¥å¸¸ï¼Œä¸€ç¬é—´å°±å´©æºƒæ¶ˆå¤±ã€‚è¿½æ±‚ä¼Šæ¬§å¤«çš„é•¿å¯¿ä¹‹è¡€ï¼Œæ¢…è¨è’‚å†›ä¹˜åç€åä¸ºé›·çº³ç‰¹çš„å¤ä»£å…½å‘åŠ¨äº†è¿›æ”»ã€‚åœ¨ç»æœ›ä¸æ··ä¹±ä¹‹ä¸­ï¼Œä¼Šæ¬§å¤«çš„ç¬¬ä¸€ç¾å¥³è•¾è‰äºšè¢«æ¢…è¨è’‚å¸¦èµ°ï¼Œè€Œç›å¥‡äºšæš—æ‹çš„å°‘å¹´å…‹é‡Œå§†ä¹Ÿå¤±è¸ªäº†ã€‚ç›å¥‡äºšè™½ç„¶æ€»ç®—é€ƒè„±äº†ï¼Œå´å¤±å»äº†ä¼™ä¼´å’Œå½’å»ä¹‹åœ°â€¦â€¦ã€‚' }, { img : 'https://lain.bgm.tv/pic/cover/l/0e/1e/218971_2y351.jpg', title: 'æœèŠ±å¤•èª“â€”â€”äºç¦»åˆ«ä¹‹æœæŸèµ·çº¦å®šä¹‹èŠ±', status: 'å·²è¿½å®Œ', progress: 100, jp: 'ã•ã‚ˆãªã‚‰ã®æœã«ç´„æŸã®èŠ±ã‚’ã‹ã–ã‚ã†', time: '2018-02-24 SUN.', desc: ' ä½åœ¨è¿œç¦»å°˜åš£çš„åœŸåœ°ï¼Œä¸€è¾¹å°†æ¯å¤©çš„äº‹æƒ…ç¼–ç»‡æˆåä¸ºå¸Œæ¯”æ¬§çš„å¸ƒï¼Œä¸€è¾¹é™é™ç”Ÿæ´»çš„ä¼Šæ¬§å¤«äººæ°‘ã€‚åœ¨15å²å·¦å³å¤–è¡¨å°±åœæ­¢æˆé•¿ï¼Œæ‹¥æœ‰æ•°ç™¾å¹´å¯¿å‘½çš„ä»–ä»¬ï¼Œè¢«ç§°ä¸ºâ€œç¦»åˆ«çš„ä¸€æ—â€ï¼Œå¹¶è¢«è§†ä¸ºæ´»ç€çš„ä¼ è¯´ã€‚æ²¡æœ‰åŒäº²çš„ä¼Šæ¬§å¤«å°‘å¥³ç›å¥‡äºšï¼Œè¿‡ç€è¢«ä¼™ä¼´åŒ…å›´çš„å¹³ç¨³æ—¥å­ï¼Œå´æ€»æ„Ÿè§‰â€œå­¤èº«ä¸€äººâ€ã€‚ä»–ä»¬çš„è¿™ç§æ—¥å¸¸ï¼Œä¸€ç¬é—´å°±å´©æºƒæ¶ˆå¤±ã€‚è¿½æ±‚ä¼Šæ¬§å¤«çš„é•¿å¯¿ä¹‹è¡€ï¼Œæ¢…è¨è’‚å†›ä¹˜åç€åä¸ºé›·çº³ç‰¹çš„å¤ä»£å…½å‘åŠ¨äº†è¿›æ”»ã€‚åœ¨ç»æœ›ä¸æ··ä¹±ä¹‹ä¸­ï¼Œä¼Šæ¬§å¤«çš„ç¬¬ä¸€ç¾å¥³è•¾è‰äºšè¢«æ¢…è¨è’‚å¸¦èµ°ï¼Œè€Œç›å¥‡äºšæš—æ‹çš„å°‘å¹´å…‹é‡Œå§†ä¹Ÿå¤±è¸ªäº†ã€‚ç›å¥‡äºšè™½ç„¶æ€»ç®—é€ƒè„±äº†ï¼Œå´å¤±å»äº†ä¼™ä¼´å’Œå½’å»ä¹‹åœ°â€¦â€¦ã€‚' } ] .should-ellipsis{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;width:95%;}.should-ellipsis-full{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;width:100%;}.should-ellipsis i{position:absolute;right:24px;}.grey-text{color:#9e9e9e !important}.grey-text.text-darken-4{color:#212121 !important}html{line-height:1.15;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}img{border-style:none}progress{display:inline-block;vertical-align:baseline}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{-webkit-box-sizing:border-box;box-sizing:border-box}*,*:before,*:after{-webkit-box-sizing:inherit;box-sizing:inherit}ul:not(.browser-default){padding-left:0;list-style-type:none}ul:not(.browser-default)>li{list-style-type:none}.card{-webkit-box-shadow:0 2px 2px 0 rgba(0,0,0,0.14),0 3px 1px -2px rgba(0,0,0,0.12),0 1px 5px 0 rgba(0,0,0,0.2);box-shadow:0 2px 2px 0 rgba(0,0,0,0.14),0 3px 1px -2px rgba(0,0,0,0.12),0 1px 5px 0 rgba(0,0,0,0.2)}.hoverable{-webkit-transition:-webkit-box-shadow .25s;transition:-webkit-box-shadow .25s;transition:box-shadow .25s;transition:box-shadow .25s,-webkit-box-shadow .25s}.hoverable:hover{-webkit-box-shadow:0 8px 17px 0 rgba(0,0,0,0.2),0 6px 20px 0 rgba(0,0,0,0.19);box-shadow:0 8px 17px 0 rgba(0,0,0,0.2),0 6px 20px 0 rgba(0,0,0,0.19)}i{line-height:inherit}i.right{float:right;margin-left:15px}.bangumi .right{float:right !important}.material-icons{text-rendering:optimizeLegibility;-webkit-font-feature-settings:'liga';-moz-font-feature-settings:'liga';font-feature-settings:'liga'}.row{margin-left:auto;margin-right:auto;margin-bottom:20px}.row:after{content:\"\";display:table;clear:both}.row .col{float:left;-webkit-box-sizing:border-box;box-sizing:border-box;padding:0 .75rem;min-height:1px}.row .col.s12{width:100%;margin-left:auto;left:auto;right:auto}@media only screen and (min-width:601px){.row .col.m6{width:50%;margin-left:auto;left:auto;right:auto}}html{line-height:1.5;font-family:-apple-system,BlinkMacSystemFont,\"Segoe UI\",Roboto,Oxygen-Sans,Ubuntu,Cantarell,\"Helvetica Neue\",sans-serif;font-weight:normal;color:rgba(0,0,0,0.87)}@media only screen and (min-width:0){html{font-size:14px}}@media only screen and (min-width:992px){html{font-size:14.5px}}@media only screen and (min-width:1200px){html{font-size:15px}}.card{position:relative;margin:.5rem 0 1rem 0;background-color:#fff;-webkit-transition:-webkit-box-shadow .25s;transition:-webkit-box-shadow .25s;transition:box-shadow .25s;transition:box-shadow .25s,-webkit-box-shadow .25s;border-radius:2px}.card .card-title{font-size:24px;font-weight:300}.card .card-title.activator{cursor:pointer}.card .card-image{position:relative}.card .card-image img{display:block;border-radius:2px 2px 0 0;position:relative;left:0;right:0;top:0;bottom:0;width:100%}.card .card-content{padding:24px;border-radius:0 0 2px 2px}.card .card-content p{margin:0}.card .card-content .card-title{display:block;line-height:32px;margin-bottom:8px}.card .card-content .card-title i{line-height:32px}.card .card-reveal{padding:24px;position:absolute;background-color:#fff;width:100%;overflow-y:auto;left:0;top:100%;height:100%;z-index:3;display:none}.card .card-reveal .card-title{cursor:pointer;display:block}.waves-effect{position:relative;cursor:pointer;display:inline-block;overflow:hidden;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-tap-highlight-color:transparent;vertical-align:middle;z-index:1;-webkit-transition:.3s ease-out;transition:.3s ease-out}.waves-effect img{position:relative;z-index:-1}.waves-block{display:block}::-webkit-input-placeholder{color:#d1d1d1}::-moz-placeholder{color:#d1d1d1}:-ms-input-placeholder{color:#d1d1d1}::-ms-input-placeholder{color:#d1d1d1}[type=\"radio\"]:not(:checked){position:absolute;opacity:0;pointer-events:none}[type=\"radio\"]:not(:checked)+span{position:relative;padding-left:35px;cursor:pointer;display:inline-block;height:25px;line-height:25px;font-size:1rem;-webkit-transition:.28s ease;transition:.28s ease;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}[type=\"radio\"]:not(:checked)+span:before,[type=\"radio\"]:not(:checked)+span:after{border-radius:50%}[type=\"radio\"]:not(:checked)+span:before,[type=\"radio\"]:not(:checked)+span:after{border:2px solid #5a5a5a}[type=\"radio\"]:not(:checked)+span:after{-webkit-transform:scale(0);transform:scale(0)}[type=\"checkbox\"]:not(:checked){position:absolute;opacity:0;pointer-events:none}[type=\"checkbox\"]:not(:checked):disabled+span:not(.lever):before{border:none;background-color:rgba(0,0,0,0.42)}[type=\"checkbox\"].filled-in:not(:checked)+span:not(.lever):before{width:0;height:0;border:3px solid transparent;left:6px;top:10px;-webkit-transform:rotateZ(37deg);transform:rotateZ(37deg);-webkit-transform-origin:100% 100%;transform-origin:100% 100%}[type=\"checkbox\"].filled-in:not(:checked)+span:not(.lever):after{height:20px;width:20px;background-color:transparent;border:2px solid #5a5a5a;top:0px;z-index:0}input[type=checkbox]:not(:disabled) ~ .lever:active:before,input[type=checkbox]:not(:disabled).tabbed:focus ~ .lever::before{-webkit-transform:scale(2.4);transform:scale(2.4);background-color:rgba(0,0,0,0.08)}input[type=range].focused:focus:not(.active)::-webkit-slider-thumb{-webkit-box-shadow:0 0 0 10px rgba(38,166,154,0.26);box-shadow:0 0 0 10px rgba(38,166,154,0.26)}input[type=range].focused:focus:not(.active)::-moz-range-thumb{box-shadow:0 0 0 10px rgba(38,166,154,0.26)}input[type=range].focused:focus:not(.active)::-ms-thumb{box-shadow:0 0 0 10px rgba(38,166,154,0.26)} ç•ªç»„è®¡åˆ’ è¿™é‡Œå°†æ˜¯æ°¸è¿œçš„å›å¿† window.onload = function(){ videos.forEach(function(video, i){ $('#rootRow').append(` ${video.title} ${video.jp} ${video.status} ${video.title} ${video.jp} æ”¾é€æ—¶é—´: ${video.time} ${video.desc} ${video.status} `) }) }","keywords":"Bç«™"}],"posts":[{"title":"å˜´å·´å¼€çœé€‰","slug":"å˜´å·´å¼€çœé€‰","date":"2023-03-04T16:05:46.000Z","updated":"2023-03-12T17:22:39.507Z","comments":false,"path":"2023/03/05/å˜´å·´å¼€çœé€‰/","link":"","permalink":"https://saigonoinorio.github.io/2023/03/05/å˜´å·´å¼€çœé€‰/","excerpt":"","text":"pbds namespace\\text{namespace}namespace æ˜¯ __gnu_pbdsï¼Œå¤´æ–‡ä»¶å¯ä»¥ç›´æ¥ #include&lt;bits/extc++.h&gt; ï¼Œä¸è¿‡ devcpp ç”¨ä¸äº†ï¼Œåªèƒ½ #include&lt;ext/pb_ds/assoc_container.hpp&gt; ä»¥åŠå¯¹åº”çš„å¤´æ–‡ä»¶ï¼Œè¿­ä»£å™¨éƒ½æ˜¯ point_iterator\\text{point\\_iterator}point_iteratorã€‚ å“ˆå¸Œè¡¨ æ ¹æ®åˆ«äººä»¥åŠè‡ªå·±çš„ benchmark\\text{benchmark}benchmark æ¥è¯´ hash_table\\text{hash\\_table}hash_table è¡¨ç°å¾ˆä¼˜ç§€ï¼Œéæ„é€ æ•°æ®å¡ç‚¹å¸¸è¿˜æ˜¯è¦å†™çš„ã€‚ å¤´æ–‡ä»¶ï¼š #include&lt;ext/pb_ds/hash_policy.h&gt; å£°æ˜ï¼šgp_hash_table&lt;int,int&gt;ï¼Œå½“ unordered_set\\text{unordered\\_set}unordered_set ç”¨çš„è¯æ˜¯ gp_hash_table&lt;int,nulltype&gt; ä½¿ç”¨ï¼šåŒ unordered_map\\text{unordered\\_map}unordered_map ï¼Œç›´æ¥éå†ä¹Ÿæ˜¯ O(n)O(n)O(n) ä¹±åºçš„ã€‚ å † ç”¨é…å¯¹å †ï¼Œæ”¯æŒ O(1) push joinO(1)\\ \\text{push join}O(1) push joinï¼ŒO(logâ¡) erase modifyO(\\log)\\ \\text{erase modify}O(log) erase modify ã€‚ å¤´æ–‡ä»¶ï¼š #include&lt;ext/pb_ds/priority_queue.h&gt; å£°æ˜ï¼š__gnu_pbds::priority_queue&lt;int,greater&lt;int&gt;,pairing_heap_tag&gt; ä½¿ç”¨ï¼špush\\text{push}push ä¼šè¿”å›è¿­ä»£å™¨ï¼Œjoin\\text{join}join ä¸º a.join(b)\\text{a.join(b)}a.join(b) ä¸”æ¸…ç©º b\\text bb ï¼Œerase\\text{erase}erase ä¸º q.erase(it)\\text{q.erase(it)}q.erase(it)ï¼Œmodify\\text{modify}modify ä¸º q.modify(it,x)\\text{q.modify(it,x)}q.modify(it,x) ï¼Œå½“ it\\text{it}it ä¸º NULL\\text{NULL}NULL æ—¶å°±ä¸åœ¨å †ä¸­ï¼Œè‡ªå®šä¹‰æ¯”è¾ƒåŒæ ‡å‡†åº“è¦ç”¨ struct\\text{struct}struct ã€‚ å¹³è¡¡æ ‘ ç”¨çº¢é»‘æ ‘ï¼Œç›¸æ¯” set\\text{set}set æ”¯æŒ kth rank join split\\text{kth rank join split}kth rank join split ï¼Œå’Œ fhq_treap\\text{fhq\\_treap}fhq_treap çš„å¸¸æ•°å·®ä¸å¤šï¼Œå¸¸æ•°è¾ƒå¤§ã€‚ å¤´æ–‡ä»¶ï¼š #include&lt;ext/pb_ds/tree_policy.h&gt; å£°æ˜ï¼štree&lt;int,null_type,less&lt;int&gt;,rb_tree_tag,tree_order_statistics_node_update&gt; ä½¿ç”¨ï¼šåŒ set\\text{set}set ï¼Œå®ç° multiset\\text{multiset}multiset è¦ç”¨ pair\\text{pair}pair é€šè¿‡ç¬¬äºŒå…³é”®å­—åŒºåˆ†ï¼Œä¸‹æ ‡ä» 000 å¼€å§‹ï¼Œkth\\text{kth}kth æ˜¯ *t.find_by_order(k-1)\\text{*t.find\\_by\\_order(k-1)}*t.find_by_order(k-1) ï¼Œæ±‚æ’åæ˜¯ t.order_of_key(x)+1\\text{t.order\\_of\\_key(x)+1}t.order_of_key(x)+1 ï¼Œåˆå¹¶æ˜¯ a.join(b)\\text{a.join(b)}a.join(b) ä¸”æ¸…ç©º b\\text bb ï¼Œè¦ä¿è¯ä¸¤æ ‘å€¼åŸŸä¸äº¤ï¼Œåˆ†è£‚æ˜¯ a.split(x,b)\\text{a.split(x,b)}a.split(x,b) æŠŠ b\\text bb æ¸…ç©ºå†æŠŠ &gt;x&gt;x&gt;x çš„å…ƒç´ åˆ†ç»™ b\\text bb ã€‚ æ‹‰æ ¼æœ—æ—¥æ’å€¼ æ¨æ³• 1 âˆµf(x)âˆ’f(y)=(a0âˆ’a0)+a1(xâˆ’y)+a2(x2âˆ’y2)+...+an(xnâˆ’yn)\\because f(x)-f(y)=(a_0-a_0)+a_1(x-y)+a_2(x^2-y^2)+...+a_n(x^n-y^n)âˆµf(x)âˆ’f(y)=(a0â€‹âˆ’a0â€‹)+a1â€‹(xâˆ’y)+a2â€‹(x2âˆ’y2)+...+anâ€‹(xnâˆ’yn) âˆ´f(x)â‰¡f(y)(modxâˆ’y)\\therefore f(x)\\equiv f(y)\\pmod {x-y}âˆ´f(x)â‰¡f(y)(modxâˆ’y) ç°åœ¨è¦å¯¹ nnn ä¸ªç‚¹å€¼ (xi,yi)(x_i,y_i)(xiâ€‹,yiâ€‹) è¿›è¡Œæ’å€¼ï¼Œæ ¹æ®å‰é¢çš„è¯æ˜å¯ä»¥è½¬åŒ–å¾—åˆ°çº¿æ€§åŒä½™æ–¹ç¨‹ç»„ {f(x)â‰¡y1(modxâˆ’x1))f(x)â‰¡y2(modxâˆ’x2))...\\left\\{\\begin{matrix}f(x)\\equiv y_1\\pmod {x-x_1})\\\\ f(x)\\equiv y_2\\pmod {x-x_2})\\\\ ...\\end{matrix}\\right.â©â¨â§â€‹f(x)â‰¡y1â€‹(modxâˆ’x1â€‹))f(x)â‰¡y2â€‹(modxâˆ’x2â€‹))...â€‹ ç”¨ CRT\\text{CRT}CRT åˆå¹¶ï¼šM=âˆ(xâˆ’xi),mi=Mxâˆ’xi,miâˆ’1=âˆjâ‰ ixiâˆ’xjM=\\prod (x-x_i),m_i=\\frac M {x-x_i},m_i^{-1}=\\prod_{j\\ne i}x_i-x_jM=âˆ(xâˆ’xiâ€‹),miâ€‹=xâˆ’xiâ€‹Mâ€‹,miâˆ’1â€‹=âˆjî€ =iâ€‹xiâ€‹âˆ’xjâ€‹ â‡’f(x)â‰¡âˆ‘yimimiâˆ’1â‰¡âˆ‘yiâˆjâ‰ ixâˆ’xjxiâˆ’xj(modM)\\Rightarrow f(x)\\equiv \\sum y_im_im_i^{-1}\\equiv \\sum y_i\\prod_{j\\ne i}\\frac {x-x_j} {x_i-x_j}\\pmod Mâ‡’f(x)â‰¡âˆ‘yiâ€‹miâ€‹miâˆ’1â€‹â‰¡âˆ‘yiâ€‹âˆjî€ =iâ€‹xiâ€‹âˆ’xjâ€‹xâˆ’xjâ€‹â€‹(modM) ç”±äº MMM çš„æ¬¡æ•°æ›´é«˜æ‰€ä»¥ç›´æ¥ç•¥å»ï¼Œå°±å¾—åˆ°äº†æ‹‰æ ¼æœ—æ—¥æ’å€¼çš„å¼å­ã€‚ æ¨æ³• 2 æœ‰ä»£æ•°åŸºæœ¬å®šç†ï¼šnnn ä¸ªä¸åŒç‚¹å€¼èƒ½åœ¨ nâˆ’1n-1nâˆ’1 æ¬¡ä»¥å†…ç¡®å®šå”¯ä¸€çš„ä¸€ä¸ªå¤šé¡¹å¼ã€‚æ‰€ä»¥æ„é€ å‡ºä¸€ä¸ªæ»¡è¶³è¿™ nnn ä¸ªç‚¹å€¼çš„ä¸è¶…è¿‡ nâˆ’1n-1nâˆ’1 çš„å¤šé¡¹å¼é‚£ä»–å°±æ˜¯å”¯ä¸€ç¡®å®šçš„ã€‚ è€ƒè™‘å¯¹äºæ¯ä¸€ä¸ªç‚¹å€¼æ„é€ ä¸€ä¸ªä¸è¶…è¿‡ nâˆ’1n-1nâˆ’1 æ¬¡çš„å¤šé¡¹å¼ fif_ifiâ€‹ æ»¡è¶³ fi(xi)=yi,fi(xj[jâ‰ i])=0f_i(x_i)=y_i,f_i(x_{j[j\\ne i]})=0fiâ€‹(xiâ€‹)=yiâ€‹,fiâ€‹(xj[jî€ =i]â€‹)=0 ï¼Œé‚£ä¹ˆ f(x)=âˆ‘fi(x)f(x)=\\sum f_i(x)f(x)=âˆ‘fiâ€‹(x)ã€‚ æ ¹æ® fi(xj[jâ‰ i])=0f_i(x_{j[j\\ne i]})=0fiâ€‹(xj[jî€ =i]â€‹)=0 å¾ˆå®¹æ˜“æ„é€ å‡º fi(x)=(?)âˆjâ‰ i(xâˆ’xi)f_i(x)=(?)\\prod_{j\\ne i}(x-x_i)fiâ€‹(x)=(?)âˆjî€ =iâ€‹(xâˆ’xiâ€‹) ï¼Œå†ä»£å…¥ fi(xi)=yif_i(x_i)=y_ifiâ€‹(xiâ€‹)=yiâ€‹ å°±å¯ä»¥è§£å¾— fi(x)=yiâˆjâ‰ ixâˆ’xjxiâˆ’xjf_i(x)=y_i\\prod_{j\\ne i}\\frac {x-x_j} {x_i-x_j}fiâ€‹(x)=yiâ€‹âˆjî€ =iâ€‹xiâ€‹âˆ’xjâ€‹xâˆ’xjâ€‹â€‹ï¼Œæ±‚å’Œå°±å¾—åˆ°äº†æ‹‰æ ¼æœ—æ—¥æ’å€¼çš„å¼å­ã€‚ åº”ç”¨ ç›´æ¥ä»£å…¥å¼å­å¯ä»¥ O(n2)O(n^2)O(n2) æ’å€¼ã€‚ int F(int x) { int sum=0; for(rint i=1;i&lt;=n;i++) { int res=Y[i],inv=1; for(rint j=1;j&lt;=n;j++) if(j!=i) res=res*(x-X[j]+p)%p,inv=inv*(X[i]-X[j]+p)%p; sum=(sum+res*qp(inv))%p; } return sum; } è‹¥æ’å€¼ä½¿ç”¨çš„æ˜¯è¿ç»­ä¸€æ®µæ•´æ•°çš„è¯ï¼Œâˆiâ‰ jxâˆ’jiâˆ’j=(xâˆ’1)nâ€¾(âˆ’1)nâˆ’i(xâˆ’i)(iâˆ’1)!(nâˆ’i)!\\prod_{i\\ne j}\\frac{x-j}{i-j}=\\frac {(x-1)^{\\underline n}(-1)^{n-i}} {(x-i)(i-1)!(n-i)!}âˆiî€ =jâ€‹iâˆ’jxâˆ’jâ€‹=(xâˆ’i)(iâˆ’1)!(nâˆ’i)!(xâˆ’1)nâ€‹(âˆ’1)nâˆ’iâ€‹ï¼Œé¿å…é™¤ 000 ç»´æŠ¤å‰åç¼€ç§¯å°±å¯ä»¥ O(n)O(n)O(n) æ±‚å€¼äº†ã€‚ int F(int x) { int sum=0;suf[n+1]=1; for(rint i=n;i;i--) suf[i]=suf[i+1]*(x-i+p)%p; for(rint i=1,pre=1;i&lt;=n;i++) { int mul=Y[i]*pre%p*suf[i+1]%p,inv=fac[i-1]*fac[n-i]%p*((n-i)&amp;1?p-1:1)%p; sum=(sum+mul*qp(inv))%p,pre=pre*(x-i+p)%p; } return sum; } å¼•ç†ï¼šè‹¥ä¸€ä¸ª kkk æ¬¡å¤šé¡¹å¼æ»¡è¶³ F(1,2,...,k)F(1,2,...,k)F(1,2,...,k) éƒ½æ˜¯æ•´æ•°ï¼Œé‚£ä¹ˆå¯¹äºä»»æ„æ•´æ•° xxx ï¼ŒF(x)F(x)F(x) éƒ½æ˜¯æ•´æ•°ã€‚ è¯æ˜è€ƒè™‘ä»£å…¥æ‹‰æ’å¼å­å³å¯ï¼Œæ‰€ä»¥å¦‚æœæ¨¡æ•°éå¤§è´¨æ•°çš„è¯æ˜¯å¯ä»¥é«˜ç²¾åº¦çš„ ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥å¯¹æ¨¡æ•°åˆ†è§£è´¨å› æ•°åˆ†åˆ«æ±‚è§£å CRT\\text{CRT}CRT åˆå¹¶ã€‚ åŸæ ¹ é˜¶ å®šä¹‰ï¼šæ»¡è¶³ anâ‰¡1(modp)a^n\\equiv 1\\pmod panâ‰¡1(modp) çš„æœ€å°æ­£æ•´æ•° nnn å³ä¸º aaa æ¨¡ ppp çš„é˜¶ï¼Œè®°ä¸º Î´p(a)\\delta_p(a)Î´pâ€‹(a)ã€‚ å­˜åœ¨ï¼šå½“ (a,p)=1(a,p)=1(a,p)=1 æ—¶æœ‰ aÏ†(p)â‰¡1(modp)a^{\\varphi(p)}\\equiv1 \\pmod paÏ†(p)â‰¡1(modp) ï¼Œæ‰€ä»¥ Î´p(a)â‰¤Ï†(p)\\delta_p(a)\\le \\varphi(p)Î´pâ€‹(a)â‰¤Ï†(p)ã€‚ æ€§è´¨ï¼š a,a2,...,aÎ´p(a)a,a^2,...,a^{\\delta_p(a)}a,a2,...,aÎ´pâ€‹(a) æ¨¡ ppp äº’ä¸åŒä½™ã€‚ è‹¥ anâ‰¡1(modp)a^n\\equiv1\\pmod panâ‰¡1(modp)ï¼Œåˆ™ Î´p(a)âˆ£n\\delta_p(a)|nÎ´pâ€‹(a)âˆ£nã€‚ è‹¥ (a,p)=(b,p)=1(a,p)=(b,p)=1(a,p)=(b,p)=1ï¼Œåˆ™æ­¤æ—¶ Î´p(ab)=Î´p(a)Î´p(b)â‡”(Î´p(a),Î´p(b))=1\\delta_p(ab)=\\delta_p(a)\\delta_p(b)\\Leftrightarrow (\\delta_p(a),\\delta_p(b))=1Î´pâ€‹(ab)=Î´pâ€‹(a)Î´pâ€‹(b)â‡”(Î´pâ€‹(a),Î´pâ€‹(b))=1ã€‚ è‹¥ (a,p)=1(a,p)=1(a,p)=1ï¼Œåˆ™ Î´p(ak)=Î´p(a)(Î´p(a),k)\\delta_p(a^k)=\\frac {\\delta_p(a)} {(\\delta_p(a),k)}Î´pâ€‹(ak)=(Î´pâ€‹(a),k)Î´pâ€‹(a)â€‹ã€‚ åŸæ ¹ å®šä¹‰ï¼šè‹¥ (a,p)=1(a,p)=1(a,p)=1 ä¸” Î´p(a)=Ï†(p)\\delta_p(a)=\\varphi(p)Î´pâ€‹(a)=Ï†(p)ï¼Œåˆ™ç§° aaa ä¸ºæ¨¡ ppp çš„åŸæ ¹ã€‚ åŸæ ¹åˆ¤å®šå®šç†ï¼šè‹¥ mâ‰¥3m\\ge3mâ‰¥3 ä¸” (a,p)=1(a,p)=1(a,p)=1ï¼Œåˆ™ [a ä¸ºåŸæ ¹]â‡”âˆ€ç´ å› å­ PâˆˆÏ†(p),aÏ†(p)Pâ‰¡Ì¸1(modp)[a\\text{ ä¸ºåŸæ ¹}]\\Leftrightarrow \\forall \\text{ç´ å› å­ }P\\in \\varphi(p),a^{\\frac {\\varphi(p)} P}\\not\\equiv1\\pmod p[a ä¸ºåŸæ ¹]â‡”âˆ€ç´ å› å­ PâˆˆÏ†(p),aPÏ†(p)â€‹î€ â‰¡1(modp)ã€‚ åŸæ ¹ä¸ªæ•°ï¼šè‹¥ ppp æœ‰åŸæ ¹ï¼Œåˆ™åŸæ ¹æ•°é‡ä¸º Ï†(Ï†(p))\\varphi(\\varphi(p))Ï†(Ï†(p))ï¼Œè¯æ˜è€ƒè™‘ä»»æ„åŸæ ¹ === æœ€å°åŸæ ¹k^kk ä¸” (k,Ï†(p))=1(k,\\varphi(p))=1(k,Ï†(p))=1ã€‚ åŸæ ¹å¤§å°ï¼šè‹¥ ppp æœ‰åŸæ ¹ï¼Œåˆ™æœ€å°åŸæ ¹ â‰¤p4\\le\\sqrt[4] pâ‰¤4pâ€‹ ï¼Œæ•…æš´åŠ›æ‰¾åŸæ ¹çš„å¤æ‚åº¦ä¸º O(p4logâ¡)O(\\sqrt[4] p\\log)O(4pâ€‹log)ã€‚ åŸæ ¹å­˜åœ¨å®šç†ï¼šppp æœ‰åŸæ ¹ â‡”\\Leftrightarrowâ‡” p=2,4,Pk,2Pkp=2,4,P^k,2P^kp=2,4,Pk,2Pkï¼ŒPPP ä¸ºå¥‡ç´ æ•°ã€‚ BSGS åº”ç”¨ O(p)O(\\sqrt p)O(pâ€‹) æ±‚è§£æ»¡è¶³ axâ‰¡b(modp)a^x\\equiv b\\pmod paxâ‰¡b(modp) æˆ– xaâ‰¡b(modp)x^a\\equiv b\\pmod pxaâ‰¡b(modp) çš„æœ€å° xxx ï¼Œå³æ±‚æ¨¡æ„ä¹‰ä¸‹çš„å¯¹æ•°æˆ–åº•æ•°ã€‚ ä¸€èˆ¬BSGS aâŠ¥pa\\perp paâŠ¥pï¼Œå³ a pa\\ pa p è¦äº’è´¨ï¼Œä¿è¯æœ‰é€†å…ƒã€‚ å°† xxx è¡¨ç¤ºä¸º AâŒŠpâŒ‹âˆ’B (A,B&lt;p)â‡’aAâŒŠpâŒ‹â‰¡baBA\\left \\lfloor \\sqrt p \\right \\rfloor -B\\ \\ (A,B&lt;\\sqrt p)\\Rightarrow a^{A\\left \\lfloor \\sqrt p \\right \\rfloor}\\equiv ba^BAâŒŠpâ€‹âŒ‹âˆ’B (A,B&lt;pâ€‹)â‡’aAâŒŠpâ€‹âŒ‹â‰¡baB ç”¨å“ˆå¸Œè¡¨æ˜ å°„ baBâ‡’Bba^B\\Rightarrow BbaBâ‡’Bï¼ŒO(p)O(\\sqrt p)O(pâ€‹) æšä¸¾ AAAï¼Œè‹¥èƒ½æŸ¥åˆ°å¯¹åº” BBB å³å¾—ç­”æ¡ˆã€‚ gp_hash_table&lt;int,int&gt; mp; int bsgs(int x,int y) { int sq=ceil(sqrt(p));mp.clear(); for(rint now=1,i=0;i&lt;=sq;i++,now=now*x%p) mp[y*now%p]=i; gp_hash_table&lt;int,int&gt;::point_iterator it; for(rint i=0,now=1,res=qp(x,sq);i&lt;=sq;i++,now=now*res%p) if((it=mp.find(now))!=mp.end()&amp;&amp;i*sq&gt;=it-&gt;second) return i*sq-it-&gt;second; return -1; } exBSGS ppp å¯ä¸ºä»»æ„æ¨¡æ•°ã€‚ å…ˆç‰¹åˆ¤ b=1b=1b=1 å’Œ p=1p=1p=1 çš„æƒ…å†µã€‚ åˆ©ç”¨æ¨¡çš„åˆ†é…ç‡â‡’akâˆkgiaxâˆ’kâ‰¡bâˆkgi(modpâˆkgi)\\Rightarrow \\frac {a^k} {\\prod^k g_i} a^{x-k}\\equiv \\frac b {\\prod^k g_i}\\pmod {\\frac p {\\prod^k g_i}}â‡’âˆkgiâ€‹akâ€‹axâˆ’kâ‰¡âˆkgiâ€‹bâ€‹(modâˆkgiâ€‹pâ€‹) æ»¡è¶³ (a,pâˆkgi)=1(a,\\frac p {\\prod^k g_i})=1(a,âˆkgiâ€‹pâ€‹)=1ï¼Œè‹¥ âˆkgiâˆ¤b\\prod^k g_i\\nmid bâˆkgiâ€‹âˆ¤b åˆ™æ— è§£ï¼Œè¯æ˜è€ƒè™‘ (ag)xgx+pgg=b(\\frac a g)^xg^x+\\frac p gg=b(gaâ€‹)xgx+gpâ€‹g=b ä¸­ bbb ä¸€å®šå«æœ‰å› å­ gggã€‚ â‡’axâˆ’kâ‰¡bakâˆkgiâˆkgi(modpâˆkgi)\\Rightarrow a^{x-k}\\equiv \\frac b {\\frac {a^k} {\\prod^k g_i}\\prod^k g_i}\\pmod {\\frac p {\\prod^kg_i}}â‡’axâˆ’kâ‰¡âˆkgiâ€‹akâ€‹âˆkgiâ€‹bâ€‹(modâˆkgiâ€‹pâ€‹) ï¼Œæ­¤æ—¶æ»¡è¶³äº’è´¨ï¼ŒBSGS\\text{BSGS}BSGS æ±‚å‡º xâˆ’kx-kxâˆ’k å³å¯ã€‚ int exbsgs(int x,int y) { if(p==1||y==1) return 0; int g=__gcd(x,p),k=0,sum=1; while(g!=1) { if(y%g) return -1; k++,y/=g,p/=g,sum=sum*(x/g)%p; if(sum==y) return k; //ç‰¹åˆ¤x==k g=__gcd(x,p); } int ans=bsgs(x,y*inv(sum)%p); if(~ans) return ans+k; return -1; } æ±‚åº•æ•° æ±‚ xaâ‰¡b(modp)x^a\\equiv b\\pmod pxaâ‰¡b(modp) è¦æ»¡è¶³ ppp ä¸ºè´¨æ•°ï¼Œä¿è¯ ppp æœ‰åŸæ ¹ä¸”èƒ½ä½¿ç”¨ BSGS\\text{BSGS}BSGSã€‚ è®¾ ggg ä¸º ppp çš„åŸæ ¹ï¼Œåˆ™ x=gyx=g^yx=gyï¼Œ(ga)yâ‰¡b(modp)(g^a)^y\\equiv b\\pmod p(ga)yâ‰¡b(modp)ï¼ŒBSGS\\text{BSGS}BSGS æ±‚è§£å³å¯ã€‚ ç§¯æ€§å‡½æ•° å®šä¹‰ æ•°è®ºå‡½æ•°ï¼šf:Z+â†’Cf:Z^+\\rightarrow Cf:Z+â†’Cï¼Œå³å®šä¹‰åŸŸä¸ºæ­£æ•´æ•°ï¼Œå€¼åŸŸä¸ºå¤æ•°çš„å‡½æ•°ã€‚ ç§¯æ€§å‡½æ•°ï¼šæ»¡è¶³ f(1)=1f(1)=1f(1)=1 ä¸” f(pÃ—q)=f(p)Ã—f(q) (p,q)=1f(p\\times q)=f(p)\\times f(q)\\ \\ (p,q)=1f(pÃ—q)=f(p)Ã—f(q) (p,q)=1 çš„å‡½æ•°ã€‚ å®Œå…¨ç§¯æ€§å‡½æ•°ï¼šæ»¡è¶³ f(1)=1f(1)=1f(1)=1 ä¸” f(pÃ—q)=f(p)Ã—f(q) p,qâˆˆZ+f(p\\times q)=f(p)\\times f(q)\\ \\ p,q\\in Z^+f(pÃ—q)=f(p)Ã—f(q) p,qâˆˆZ+ çš„å‡½æ•°ã€‚ å¸¸è§å®Œå…¨ç§¯æ€§å‡½æ•° å…ƒå‡½æ•°ï¼še(n)=[n=1]e(n)=[n=1]e(n)=[n=1] æ’ç­‰å‡½æ•°ï¼šI(n)=1I(n)=1I(n)=1 å•ä½å‡½æ•°ï¼šid(n)=nid(n)=nid(n)=n å¹‚å‡½æ•°ï¼šidk(n)=nkid^k(n)=n^kidk(n)=nk å¸¸è§ç§¯æ€§å‡½æ•° çº¦æ•°ä¸ªæ•°å‡½æ•°ï¼šÏ„(n)=d(n)=Ïƒ0(n)=âˆ‘dâˆ£n1\\tau(n)=d(n)=\\sigma_0(n)=\\sum_{d|n}1Ï„(n)=d(n)=Ïƒ0â€‹(n)=âˆ‘dâˆ£nâ€‹1 çº¦æ•°å’Œå‡½æ•°ï¼šÏƒ(n)=Ïƒ1(n)=âˆ‘dâˆ£nd\\sigma(n)=\\sigma_1(n)=\\sum_{d|n}dÏƒ(n)=Ïƒ1â€‹(n)=âˆ‘dâˆ£nâ€‹d é™¤æ•°å‡½æ•°ï¼šÏƒk(n)=âˆ‘dâˆ£ndk\\sigma_k(n)=\\sum_{d|n}d^kÏƒkâ€‹(n)=âˆ‘dâˆ£nâ€‹dkï¼Œå³çº¦æ•° kkk æ¬¡å¹‚å’Œã€‚ æ¬§æ‹‰å‡½æ•°ï¼šÏ†(n)=âˆ‘i=1n[(i,n)=1]\\varphi(n)=\\sum_{i=1}^n[(i,n)=1]Ï†(n)=âˆ‘i=1nâ€‹[(i,n)=1]ï¼Œå³ 1âˆ¼n1\\sim n1âˆ¼n ä¸ nnn äº’è´¨çš„ä¸ªæ•°ã€‚ Ï†(p)=pâˆ’1,pâˆˆprime\\varphi(p)=p-1,p\\in primeÏ†(p)=pâˆ’1,pâˆˆprimeã€‚ âˆ‘(i,n)=1ni=nÏ†(n)+[n=1]2\\sum^n_{(i,n)=1}i=\\frac {n\\varphi(n)+[n=1]} 2âˆ‘(i,n)=1nâ€‹i=2nÏ†(n)+[n=1]â€‹ã€‚ è‹¥ n&gt;2n&gt;2n&gt;2ï¼Œåˆ™ Ï†(n)\\varphi(n)Ï†(n) ä¸ºå¶æ•°ã€‚ è«æ¯”ä¹Œæ–¯å‡½æ•°ï¼šÎ¼(n)={0âˆƒ ci&gt;1(âˆ’1)kâˆ€ ci=1\\mu(n)=\\left\\{\\begin{matrix}0 &amp;\\exist \\ c_i&gt;1 \\\\(-1)^k &amp; \\forall \\ c_i=1\\end{matrix}\\right.Î¼(n)={0(âˆ’1)kâ€‹âˆƒ ciâ€‹&gt;1âˆ€ ciâ€‹=1â€‹ ï¼Œn=âˆkpicin=\\prod^kp_i^{c_i}n=âˆkpiciâ€‹â€‹ ç‹„åˆ©å…‹é›·å·ç§¯ å®šä¹‰ æ•°è®ºå‡½æ•° fff ä¸ ggg çš„ç‹„åˆ©å…‹é›·å·ç§¯ (fâˆ—g)(n)=âˆ‘dâˆ£nf(d)g(nd)(f*g)(n)=\\sum_{d|n}f(d)g(\\frac n d)(fâˆ—g)(n)=âˆ‘dâˆ£nâ€‹f(d)g(dnâ€‹)ã€‚ æ€§è´¨ æ»¡è¶³äº¤æ¢å¾‹ã€ç»“åˆå¾‹ã€åˆ†é…å¾‹ï¼Œè‹¥ f,gf,gf,g å‡ç§¯æ€§ï¼Œåˆ™ fâˆ—gf*gfâˆ—g ä¹Ÿä¸ºç§¯æ€§ã€‚ å¯¹äºå…ƒå‡½æ•°ï¼šfâˆ—e=ff*e=ffâˆ—e=fï¼Œeee å³ä¸ºå•ä½å…ƒã€‚ å¯¹äºç§¯æ€§å‡½æ•° fffï¼šfâˆ—I=âˆi=1kâˆ‘j=0cif(pij)f*I=\\prod^k_{i=1}\\sum_{j=0}^{c_i}f(p_i^j)fâˆ—I=âˆi=1kâ€‹âˆ‘j=0ciâ€‹â€‹f(pijâ€‹)ï¼Œè€ƒè™‘åˆ†è§£è´¨å› æ•°å¾—è¯ã€‚ å¯¹äºè«æ¯”ä¹Œæ–¯å‡½æ•°ï¼šÎ¼âˆ—I=âˆ‘dâˆ£nÎ¼(d)=âˆ‘i=0k(ki)(âˆ’1)i=(1âˆ’1)k=e\\mu*I=\\sum_{d|n}\\mu(d)=\\sum_{i=0}^k\\binom k i(-1)^i=(1-1)^k=eÎ¼âˆ—I=âˆ‘dâˆ£nâ€‹Î¼(d)=âˆ‘i=0kâ€‹(ikâ€‹)(âˆ’1)i=(1âˆ’1)k=eï¼Œè€ƒè™‘å®šä¹‰å¾—è¯ï¼Œå‘ç° fâˆ—Iâˆ—Î¼=ff*I*\\mu=ffâˆ—Iâˆ—Î¼=fï¼Œç§°ä¸ºè«æ¯”ä¹Œæ–¯åæ¼”ã€‚ å¯¹äºæ¬§æ‹‰å‡½æ•°ï¼šÏ†(n)=âˆ‘i=1ne((i,n))=âˆ‘i=1nÎ¼âˆ—I((i,n))=âˆ‘i=1nâˆ‘dâˆ£(i,n)Î¼(d)=\\varphi(n)=\\sum_{i=1}^ne((i,n))=\\sum_{i=1}^n\\mu*I((i,n))=\\sum_{i=1}^n\\sum_{d|(i,n)}\\mu(d)=Ï†(n)=âˆ‘i=1nâ€‹e((i,n))=âˆ‘i=1nâ€‹Î¼âˆ—I((i,n))=âˆ‘i=1nâ€‹âˆ‘dâˆ£(i,n)â€‹Î¼(d)=âˆ‘d=1nÎ¼(d)âˆ‘i[dâˆ£(i,n)]=âˆ‘d=1nÎ¼(d)âŒŠndâŒ‹=Î¼âˆ—id\\sum_{d=1}^n\\mu(d)\\sum_i[d|(i,n)]=\\sum_{d=1}^n\\mu(d)\\left \\lfloor \\frac n d \\right \\rfloor=\\mu*idâˆ‘d=1nâ€‹Î¼(d)âˆ‘iâ€‹[dâˆ£(i,n)]=âˆ‘d=1nâ€‹Î¼(d)âŒŠdnâ€‹âŒ‹=Î¼âˆ—idï¼ŒÏ†=Î¼âˆ—idâ‡”Ï†âˆ—I=id\\varphi=\\mu*id\\Leftrightarrow\\varphi*I=idÏ†=Î¼âˆ—idâ‡”Ï†âˆ—I=idï¼Œç§°ä¸ºæ¬§æ‹‰åæ¼”ï¼Œæœ¬è´¨åŒè«åã€‚ å¯¹äºçº¦æ•°å‡½æ•°ï¼šÏ„=Iâˆ—I\\tau=I*IÏ„=Iâˆ—Iï¼ŒÏƒ=Iâˆ—id\\sigma=I*idÏƒ=Iâˆ—idï¼ŒÏƒk=Iâˆ—idk\\sigma_k=I*id^kÏƒkâ€‹=Iâˆ—idkï¼Œè€ƒè™‘å®šä¹‰å¾—è¯ã€‚ å¦å¤– Ï„(ij)=âˆ‘xâˆ£iâˆ‘yâˆ£j[(x,y)=1]\\tau(ij)=\\sum_{x|i}\\sum_{y|j}[(x,y)=1]Ï„(ij)=âˆ‘xâˆ£iâ€‹âˆ‘yâˆ£jâ€‹[(x,y)=1]ï¼Œè¯æ˜è€ƒè™‘æ‹†ä½ï¼Œæ¯ç§è´¨å› æ•°çš„æ–¹æ¡ˆè´¡çŒ®ä¸€å®šæ˜¯ a+b+1a+b+1a+b+1ï¼Œä¿è¯ gcdâ¡=1\\gcd=1gcd=1 æ—¶çš„æ–¹æ¡ˆè´¡çŒ®ä¹Ÿä¸º a+b+1a+b+1a+b+1ï¼Œæ‰€ä»¥æ˜¯ç­‰ä»·çš„ã€‚ è¿˜æœ‰å…¶æ‰©å±•ï¼ŒÏ„(ABC)=âˆ‘xâˆ£Aâˆ‘yâˆ£Bâˆ‘zâˆ£C[(x,y)=1][(x,z)=1][(y,z)=1]\\tau(ABC)=\\sum_{x|A}\\sum_{y|B}\\sum_{z|C}[(x,y)=1][(x,z)=1][(y,z)=1]Ï„(ABC)=âˆ‘xâˆ£Aâ€‹âˆ‘yâˆ£Bâ€‹âˆ‘zâˆ£Câ€‹[(x,y)=1][(x,z)=1][(y,z)=1] Ïƒk(AB)=âˆ‘xâˆ£Aâˆ‘yâˆ£B[(x,By)=1](xy)k\\sigma_k(AB)=\\sum_{x|A}\\sum_{y|B}[(x,\\frac B y)=1](xy)^kÏƒkâ€‹(AB)=âˆ‘xâˆ£Aâ€‹âˆ‘yâˆ£Bâ€‹[(x,yBâ€‹)=1](xy)k Ïƒk(ABC)=âˆ‘xâˆ£Aâˆ‘yâˆ£Bâˆ‘zâˆ£C[(x,By)=1][(y,Cz)=1][(x,Cz)=1](xyz)k\\sigma_k(ABC)=\\sum_{x|A}\\sum_{y|B}\\sum_{z|C}[(x,\\frac B y)=1][(y,\\frac C z)=1][(x,\\frac C z)=1](xyz)^kÏƒkâ€‹(ABC)=âˆ‘xâˆ£Aâ€‹âˆ‘yâˆ£Bâ€‹âˆ‘zâˆ£Câ€‹[(x,yBâ€‹)=1][(y,zCâ€‹)=1][(x,zCâ€‹)=1](xyz)k è¯æ˜æ€è·¯åŸºæœ¬ç›¸åŒã€‚ å¯¹äºçº¦æ•°å’Œå‡½æ•°ï¼šÏƒ=idâˆ—Iâˆ—e=idâˆ—Iâˆ—Iâˆ—Î¼=Ï„âˆ—Ï†\\sigma=id*I*e=id*I*I*\\mu=\\tau*\\varphiÏƒ=idâˆ—Iâˆ—e=idâˆ—Iâˆ—Iâˆ—Î¼=Ï„âˆ—Ï† ã€‚ å¯¹äº gcdâ¡\\gcdgcd ï¼šâˆ‘inâˆ‘jngcdâ¡(i,j)=âˆ‘d=1ndâˆ‘inâˆ‘jn[(i,j)=d]=âˆ‘d=1ndâˆ‘in/dâˆ‘jn/de((i,j))=\\sum_i^n\\sum_j^n\\gcd(i,j)=\\sum^n_{d=1}d\\sum_i^n\\sum_j^n[(i,j)=d]=\\sum^n_{d=1}d\\sum_i^{n/d}\\sum_j^{n/d}e((i,j))=âˆ‘inâ€‹âˆ‘jnâ€‹gcd(i,j)=âˆ‘d=1nâ€‹dâˆ‘inâ€‹âˆ‘jnâ€‹[(i,j)=d]=âˆ‘d=1nâ€‹dâˆ‘in/dâ€‹âˆ‘jn/dâ€‹e((i,j))=âˆ‘d=1ndâˆ‘in/dâˆ‘jn/dâˆ‘qâˆ£(i,j)Î¼(q)=âˆ‘d=1ndâˆ‘q=1n/dÎ¼(q)âŒŠndqâŒ‹2=âˆ‘t=1nâŒŠntâŒ‹2âˆ‘dâˆ£tdÃ—Î¼(td)\\sum^n_{d=1}d\\sum_i^{n/d}\\sum_j^{n/d}\\sum_{q|(i,j)}\\mu(q)=\\sum^n_{d=1}d\\sum_{q=1}^{n/d}\\mu(q)\\left \\lfloor \\frac n {dq} \\right \\rfloor^2=\\sum^n_{t=1}\\left \\lfloor \\frac n t \\right \\rfloor^2\\sum_{d|t}d\\times\\mu(\\frac t d)âˆ‘d=1nâ€‹dâˆ‘in/dâ€‹âˆ‘jn/dâ€‹âˆ‘qâˆ£(i,j)â€‹Î¼(q)=âˆ‘d=1nâ€‹dâˆ‘q=1n/dâ€‹Î¼(q)âŒŠdqnâ€‹âŒ‹2=âˆ‘t=1nâ€‹âŒŠtnâ€‹âŒ‹2âˆ‘dâˆ£tâ€‹dÃ—Î¼(dtâ€‹) å¯¹äºå®Œå…¨ç§¯æ€§å‡½æ•° hhhï¼šf(n)=âˆ‘i=1nh(i)g(âŒŠniâŒ‹)â‡”g(n)=âˆ‘i=1nÎ¼(i)h(i)f(âŒŠniâŒ‹)f(n)=\\sum_{i=1}^nh(i)g(\\lfloor\\frac n i \\rfloor)\\Leftrightarrow g(n)=\\sum_{i=1}^n\\mu(i)h(i)f(\\lfloor \\frac n i \\rfloor)f(n)=âˆ‘i=1nâ€‹h(i)g(âŒŠinâ€‹âŒ‹)â‡”g(n)=âˆ‘i=1nâ€‹Î¼(i)h(i)f(âŒŠinâ€‹âŒ‹)ï¼Œf,gf,gf,g ä¸ºæ•°è®ºå‡½æ•°ï¼Œä¸ä¼šè¯ã€‚ æ–¹æ³• valâ‡’boolÃ—valval\\Rightarrow bool\\times valvalâ‡’boolÃ—valï¼Œboolâ‡’ebool\\Rightarrow eboolâ‡’eï¼Œeâ‡’Î¼e\\Rightarrow \\mueâ‡’Î¼ äº¤æ¢æ±‚å’Œé¡ºåºã€‚ åˆ©ç”¨æ•´é™¤åˆ†å—ã€ç§¯æ€§ç­›æ³•æ±‚è§£ã€‚ æœæ•™ç­› å®šä¹‰ åœ¨äºšçº¿æ€§æ—¶é—´å¤æ‚åº¦æ±‚è§£éƒ¨åˆ†æ•°è®ºå‡½æ•°å‰ç¼€å’Œï¼Œä¸€èˆ¬ä¸º O(n23)O(n^{\\frac 2 3})O(n32â€‹)ï¼Œå¸¸è§çš„åˆ¤å®šæ³•æ˜¯è‹¥ Aâˆ—B=CA*B=CAâˆ—B=C ä¸­ AAA å¯çº¿ç­› B CB\\ CB C å¯æœæ•™ç­›ï¼Œåˆ™ AAA å¯æœæ•™ç­›ã€‚ è¦è®¡ç®— s(n)=âˆ‘i=1nf(i)s(n)=\\sum_{i=1}^nf(i)s(n)=âˆ‘i=1nâ€‹f(i)ï¼Œè€ƒè™‘ä»»æ„æ•°è®ºå‡½æ•° ggg æ»¡è¶³ âˆ‘i=1n(fâˆ—g)(i)=âˆ‘i=1nâˆ‘dâˆ£if(d)g(id)=âˆ‘i=1ng(i)s(âŒŠniâŒ‹)\\sum_{i=1}^n(f*g)(i)=\\sum_{i=1}^n\\sum_{d|i}f(d)g(\\frac i d)=\\sum_{i=1}^ng(i)s(\\lfloor \\frac n i \\rfloor)âˆ‘i=1nâ€‹(fâˆ—g)(i)=âˆ‘i=1nâ€‹âˆ‘dâˆ£iâ€‹f(d)g(diâ€‹)=âˆ‘i=1nâ€‹g(i)s(âŒŠinâ€‹âŒ‹)ï¼Œå¯ä»¥å¾—åˆ° s(n)=âˆ‘i=1n(fâˆ—g)(i)âˆ’âˆ‘i=2ng(i)s(âŒŠniâŒ‹)s(n)=\\sum_{i=1}^n(f*g)(i)-\\sum_{i=2}^ng(i)s(\\lfloor \\frac n i\\rfloor)s(n)=âˆ‘i=1nâ€‹(fâˆ—g)(i)âˆ’âˆ‘i=2nâ€‹g(i)s(âŒŠinâ€‹âŒ‹)ï¼Œæ‰¾åˆ°åˆé€‚çš„ ggg èƒ½å¿«é€Ÿè®°å¿†åŒ–é€’å½’è®¡ç®—å³å¯ã€‚ å®ä¾‹ s(n)=âˆ‘i=1nÎ¼(i)s(n)=\\sum_{i=1}^n\\mu(i)s(n)=âˆ‘i=1nâ€‹Î¼(i)ï¼šå– g=Ig=Ig=Iï¼Œè¿™æ · Î¼âˆ—I=e\\mu*I=eÎ¼âˆ—I=eï¼Œs(n)=1âˆ’âˆ‘i=2ns(âŒŠniâŒ‹)s(n)=1-\\sum_{i=2}^ns(\\lfloor \\frac n i\\rfloor)s(n)=1âˆ’âˆ‘i=2nâ€‹s(âŒŠinâ€‹âŒ‹)ï¼Œç›´æ¥è®°å¿†åŒ–é€’å½’æ˜¯ O(âˆ‘i=1nni)=O(n34)O(\\sum_{i=1}^{\\sqrt n}\\sqrt{\\frac n i})=O(n^{\\frac 3 4})O(âˆ‘i=1nâ€‹â€‹inâ€‹â€‹)=O(n43â€‹)ï¼Œçº¿æ€§ç­›é¢„å¤„ç†å³ä¸º O(n23)O(n^{\\frac 2 3})O(n32â€‹)ï¼Œæ³¨æ„è®°å¿†åŒ–ä¸ç”¨ mapmapmapï¼Œå› ä¸º âŒŠâŒŠnd1âŒ‹d2âŒ‹=âŒŠnd1d2âŒ‹\\lfloor \\frac {\\lfloor \\frac n {d_1} \\rfloor} {d_2} \\rfloor=\\lfloor \\frac n {d_1d_2}\\rfloorâŒŠd2â€‹âŒŠd1â€‹nâ€‹âŒ‹â€‹âŒ‹=âŒŠd1â€‹d2â€‹nâ€‹âŒ‹ï¼Œæ‰€ä»¥ n13n^{\\frac 1 3}n31â€‹ é•¿çš„æ•°ç»„ä¸‹æ ‡ç›´æ¥è®°å½• ddd å³å¯ã€‚ s(n)=âˆ‘i=1nÏ†(i)s(n)=\\sum_{i=1}^n\\varphi(i)s(n)=âˆ‘i=1nâ€‹Ï†(i)ï¼šå– g=Ig=Ig=Iï¼Œè¿™æ · Ï†âˆ—I=id\\varphi*I=idÏ†âˆ—I=idï¼Œs(n)=iâˆ—(i+1)2âˆ’âˆ‘i=2ns(âŒŠniâŒ‹)s(n)=\\frac {i*(i+1)} 2-\\sum_{i=2}^ns(\\lfloor \\frac n i\\rfloor)s(n)=2iâˆ—(i+1)â€‹âˆ’âˆ‘i=2nâ€‹s(âŒŠinâ€‹âŒ‹)ï¼Œ O(n23)O(n^{\\frac 2 3})O(n32â€‹) ã€‚ s(n)=âˆ‘i=1nÏ†(i)âˆ—i2s(n)=\\sum_{i=1}^n\\varphi(i)*i^2s(n)=âˆ‘i=1nâ€‹Ï†(i)âˆ—i2ï¼šå– g=id2g=id^2g=id2ï¼Œè¿™æ · (Ï† id2)âˆ—(id2)=id3(\\varphi\\ id^2)*(id^2)=id^3(Ï† id2)âˆ—(id2)=id3ï¼Œs(n)=(n(n+1)2)2âˆ’âˆ‘i=2ni2s(âŒŠniâŒ‹)s(n)=(\\frac {n(n+1)} 2)^2-\\sum_{i=2}^ni^2s(\\lfloor \\frac n i\\rfloor)s(n)=(2n(n+1)â€‹)2âˆ’âˆ‘i=2nâ€‹i2s(âŒŠinâ€‹âŒ‹)ï¼ŒO(n23)O(n^{\\frac 2 3})O(n32â€‹) ã€‚ s(n)=âˆ‘i=1nÏƒk(i)s(n)=\\sum_{i=1}^n\\sigma_k(i)s(n)=âˆ‘i=1nâ€‹Ïƒkâ€‹(i)ï¼šå› ä¸º Ïƒk=Iâˆ—idkâ‡’Ïƒkâˆ—Î¼=idk\\sigma_k=I*id^k\\Rightarrow \\sigma_k*\\mu=id^kÏƒkâ€‹=Iâˆ—idkâ‡’Ïƒkâ€‹âˆ—Î¼=idkï¼Œèƒ½åˆ¤å®šå¯æœæ•™ç­›ï¼Œä¸è¿‡è¿™é‡Œç›´æ¥ä»å®šä¹‰è§£æ›´ç®€å•ä¹Ÿæ›´ä¼˜ï¼Œâˆ‘i=1nÏƒk(i)=âˆ‘i=1nâˆ‘dâˆ£idk=âˆ‘d=1ndkâŒŠndâŒ‹\\sum_{i=1}^n\\sigma_k(i)=\\sum_{i=1}^n\\sum_{d|i}d^k=\\sum_{d=1}^nd^k\\lfloor \\frac n d\\rfloorâˆ‘i=1nâ€‹Ïƒkâ€‹(i)=âˆ‘i=1nâ€‹âˆ‘dâˆ£iâ€‹dk=âˆ‘d=1nâ€‹dkâŒŠdnâ€‹âŒ‹ï¼Œæ±‚è‡ªç„¶æ•°å¹‚å’Œå³å¯ O(kn)O(k\\sqrt n)O(knâ€‹)ã€‚ s(n)=âˆ‘i=1n(Î¼2âˆ—Î¼id)(i)s(n)=\\sum_{i=1}^n(\\mu^2*\\mu id)(i)s(n)=âˆ‘i=1nâ€‹(Î¼2âˆ—Î¼id)(i)ï¼Œå– g=idg=idg=idï¼Œè¿™æ · Î¼2âˆ—Î¼idâˆ—id=Î¼2\\mu^2*\\mu id*id=\\mu^2Î¼2âˆ—Î¼idâˆ—id=Î¼2ï¼Œè½¬åŒ–ä¸ºäº†ç­› Î¼2\\mu^2Î¼2ã€‚ ä»å®šä¹‰å…¥æ‰‹å‘ç°æ˜¯æ±‚ 1âˆ¼n1\\sim n1âˆ¼n ä¸å«å¹³æ–¹å› å­çš„æ•°ï¼Œè€ƒè™‘å®¹æ–¥æšä¸¾å³å¾— âˆ‘i=1nÎ¼(i)âŒŠni2âŒ‹\\sum_{i=1}^{\\sqrt n}\\mu(i)\\lfloor\\frac n {i^2}\\rfloorâˆ‘i=1nâ€‹â€‹Î¼(i)âŒŠi2nâ€‹âŒ‹ ã€‚ ä¹Ÿå¯ä»¥æ„é€ å‡½æ•° f(n)=[nä¸ºå®Œå…¨å¹³æ–¹æ•°]f(n)=[nä¸ºå®Œå…¨å¹³æ–¹æ•°]f(n)=[nä¸ºå®Œå…¨å¹³æ–¹æ•°]ï¼Œå¯å¾— fâˆ—Î¼2=If*\\mu^2=Ifâˆ—Î¼2=Iï¼ŒæŒ‰æœæ•™ç­›å¯æ¨å¾— s(n)=nâˆ’âˆ‘i=2nf(i)s(âŒŠniâŒ‹)=nâˆ’âˆ‘i=2ns(âŒŠni2âŒ‹)s(n)=n-\\sum_{i=2}^nf(i)s(\\lfloor\\frac n i\\rfloor)=n-\\sum_{i=2}^{\\sqrt n}s(\\lfloor\\frac n {i^2}\\rfloor)s(n)=nâˆ’âˆ‘i=2nâ€‹f(i)s(âŒŠinâ€‹âŒ‹)=nâˆ’âˆ‘i=2nâ€‹â€‹s(âŒŠi2nâ€‹âŒ‹)ã€‚ è¿˜å¯ä»¥æ„é€ å‡½æ•° f(n)=næœ€å¤§å¹³æ–¹å› å­f(n)=\\sqrt{næœ€å¤§å¹³æ–¹å› å­}f(n)=næœ€å¤§å¹³æ–¹å› å­â€‹ï¼Œå¯å¾— s(n)=âˆ‘i=1n[f(i)=1]=âˆ‘i=1nâˆ‘dâˆ£f(i)Î¼(d)s(n)=\\sum_{i=1}^n[f(i)=1]=\\sum^n_{i=1}\\sum_{d|f(i)}\\mu(d)s(n)=âˆ‘i=1nâ€‹[f(i)=1]=âˆ‘i=1nâ€‹âˆ‘dâˆ£f(i)â€‹Î¼(d)ï¼Œè€Œ dâˆ£f(i)â‡”d2âˆ£id|f(i)\\Leftrightarrow d^2|idâˆ£f(i)â‡”d2âˆ£iï¼Œæ‰€ä»¥ s(n)=âˆ‘d=1nÎ¼(d)âŒŠnd2âŒ‹s(n)=\\sum_{d=1}^{\\sqrt n}\\mu(d)\\lfloor \\frac n {d^2}\\rfloors(n)=âˆ‘d=1nâ€‹â€‹Î¼(d)âŒŠd2nâ€‹âŒ‹ï¼Œç”±æ­¤è¿˜å¯å‘ç° Î¼2(n)=âˆ‘d2âˆ£nÎ¼(d)\\mu^2(n)=\\sum_{d^2|n}\\mu(d)Î¼2(n)=âˆ‘d2âˆ£nâ€‹Î¼(d)ã€‚ Powerful Number ç­› Powerful Number å®šä¹‰ï¼šå³ä¸å«å¹‚æ¬¡ä¸º 111 çš„ç´ å› é¡¹çš„æ•°ã€‚ æ€§è´¨ï¼š ä¸€å®šå¯ä»¥è¡¨ç¤ºä¸º a2b3a^2b^3a2b3ï¼Œåˆ†è§£è´¨å› æ•°å¯è¯ã€‚ æ•°é‡çº§ä¸º O(âˆ‘ni23)=O(n)O(\\sum \\sqrt[3]{\\frac {n} {i^2}})=O(\\sqrt n)O(âˆ‘3i2nâ€‹â€‹)=O(nâ€‹)ï¼Œæ‰€ä»¥ç›´æ¥ dfs\\text{dfs}dfs ç´ å› å­æŒ‡æ•°æ±‚æ‰€æœ‰ PN\\text{PN}PN å¤æ‚åº¦ä¸º O(n)O(\\sqrt n)O(nâ€‹)ã€‚ PN ç­› å®šä¹‰ï¼šå¤§è‡´ä¸ºæœæ•™ç­›æ‰©å±•ï¼Œæ‰¾åˆ°ä¸€ä¸ªèƒ½æ±‚å‰ç¼€å’Œçš„ç§¯æ€§å‡½æ•° ggg æ»¡è¶³ g(p)=f(p)g(p)=f(p)g(p)=f(p) å°±èƒ½æ±‚ fff çš„å‰ç¼€å’Œï¼Œç“¶é¢ˆåœ¨æœæ•™ç­›ã€‚ è®¾ h=f/gh=f/gh=f/gï¼Œå³é€†ç‹„åˆ©å…‹é›·å·ç§¯ï¼ˆä»…ä½œè¡¨ç¤ºï¼‰ï¼Œæ»¡è¶³ç§¯æ€§å‡½æ•°åˆ™ hhh å¿…å®šå”¯ä¸€å­˜åœ¨ä¸”ä¹Ÿä¸ºç§¯æ€§å‡½æ•°ï¼Œç”±äº g(p)=f(p)g(p)=f(p)g(p)=f(p)ï¼Œæ‰€ä»¥ h(p)=0h(p)=0h(p)=0ï¼Œå‘ç° hhh ä»…åœ¨ PNPNPN å¤„æœ‰å€¼ã€‚ âˆ‘i=1nf(i)=âˆ‘i=1nâˆ‘dâˆ£ih(d)g(id)=âˆ‘d=1nh(d)Sg(âŒŠndâŒ‹)=âˆ‘dâˆˆPNh(d)Sg(âŒŠndâŒ‹)\\sum^n_{i=1} f(i)=\\sum_{i=1}^n \\sum_{d|i} h(d)g(\\frac i d)=\\sum_{d=1}^nh(d)S_g(\\lfloor \\frac n d\\rfloor)=\\sum_{d\\in PN}h(d)S_g(\\lfloor \\frac n d\\rfloor)âˆ‘i=1nâ€‹f(i)=âˆ‘i=1nâ€‹âˆ‘dâˆ£iâ€‹h(d)g(diâ€‹)=âˆ‘d=1nâ€‹h(d)Sgâ€‹(âŒŠdnâ€‹âŒ‹)=âˆ‘dâˆˆPNâ€‹h(d)Sgâ€‹(âŒŠdnâ€‹âŒ‹)ï¼Œæœæ•™ç­›ç­›å‡º ggg å†æš´åŠ›æ±‚å‡º hhh åœ¨ PN\\text{PN}PN å‡ºçš„æ‰€æœ‰å€¼å³å¯ã€‚ å…·ä½“åœ°ï¼Œè€ƒè™‘ hhh æ˜¯ç§¯æ€§å‡½æ•°ä»…éœ€è€ƒè™‘ h(pk)h(p^k)h(pk) çš„å€¼ï¼Œf(pk)=âˆ‘i=0kh(pi)g(pkâˆ’i)â‡”h(pk)=f(pk)âˆ’âˆ‘i=0kâˆ’1h(pi)g(pkâˆ’i)f(p^k)=\\sum_{i=0}^k h(p^i)g(p^{k-i})\\Leftrightarrow h(p^k)=f(p^k)-\\sum_{i=0}^{k-1}h(p^i)g(p^{k-i})f(pk)=âˆ‘i=0kâ€‹h(pi)g(pkâˆ’i)â‡”h(pk)=f(pk)âˆ’âˆ‘i=0kâˆ’1â€‹h(pi)g(pkâˆ’i)ï¼Œæš´åŠ›ç®—å°±è¡Œï¼Œèƒ½ O(1)O(1)O(1)æ±‚å€¼çš„è¯å¤æ‚åº¦ä¸è¶…è¿‡ O(n)O(\\sqrt n)O(nâ€‹)ã€‚ ç½‘ç»œæµ å®šä¹‰ æµç½‘ç»œï¼šå¸¦æƒæœ‰å‘å›¾ G(V,E)\\text{G(V,E)}G(V,E)ï¼Œå«æºç‚¹ s\\text ss æ±‡ç‚¹ t\\text ttï¼Œè¾¹æœ‰å®¹é‡ c(u,v)\\text{c(u,v)}c(u,v)ã€‚ å¯è¡Œæµ f\\text ff ï¼š{â‘  å®¹é‡é™åˆ¶ï¼š0â‰¤f(u,v)â‰¤c(u,v) æµé‡ä¸è¶…è¿‡å®¹é‡â‘¡ åå¯¹ç§°æ€§ï¼šf(u,v)=âˆ’f(v,u) æ­£ç€æµå‡ºç­‰äºåç€æµè¿›â‘¢ æµé‡å®ˆæ’ï¼šâˆ€xâˆˆV/{s,t}âˆ‘f(u,x)=âˆ‘f(x,v) é™¤æºæ±‡ç‚¹å¤–æµå…¥é‡=æµå‡ºé‡\\begin{cases} \\text{â‘  å®¹é‡é™åˆ¶ï¼š} 0\\le f(u,v)\\le c(u,v) \\text{ æµé‡ä¸è¶…è¿‡å®¹é‡} \\\\ \\text{â‘¡ åå¯¹ç§°æ€§ï¼š} f(u,v)=-f(v,u)\\ æ­£ç€æµå‡ºç­‰äºåç€æµè¿› \\\\ \\text{â‘¢ æµé‡å®ˆæ’ï¼š}\\forall_{x\\in V/\\{s,t\\}} \\sum f(u,x)=\\sum f(x,v) \\text{ é™¤æºæ±‡ç‚¹å¤–æµå…¥é‡=æµå‡ºé‡}\\end{cases}â©â¨â§â€‹â‘  å®¹é‡é™åˆ¶ï¼š0â‰¤f(u,v)â‰¤c(u,v) æµé‡ä¸è¶…è¿‡å®¹é‡â‘¡ åå¯¹ç§°æ€§ï¼šf(u,v)=âˆ’f(v,u) æ­£ç€æµå‡ºç­‰äºåç€æµè¿›â‘¢ æµé‡å®ˆæ’ï¼šâˆ€xâˆˆV/{s,t}â€‹âˆ‘f(u,x)=âˆ‘f(x,v) é™¤æºæ±‡ç‚¹å¤–æµå…¥é‡=æµå‡ºé‡â€‹ æµé‡ï¼šâˆ£fâˆ£=âˆ‘f(s,v)âˆ’âˆ‘f(u,s)|f|=\\sum f(s,v)-\\sum f(u,s)âˆ£fâˆ£=âˆ‘f(s,v)âˆ’âˆ‘f(u,s) æºç‚¹æµå‡ºé‡ï¼ˆå‡æºç‚¹æµå…¥é‡ï¼‰ï¼Œæœ€å¤§æµå³æœ€å¤§æµé‡å¯è¡Œæµã€‚ æ®‹é‡ç½‘ç»œ Gf\\text{G}_{\\text f}Gfâ€‹ ï¼šç”±å¯è¡Œæµ fff å†³å®šï¼Œå…¶ä¸­ Vf=V,Ef=E+Eâ€¾,câ€²(u,v)={c(u,v)âˆ’f(u,v)(u,v)âˆˆEf(u,v)(u,v)âˆˆEâ€¾V_f=V,E_f=E+\\overline E,c&#x27;(u,v)=\\begin{cases} c(u,v)-f(u,v) &amp; (u,v)\\in E \\\\ f(u,v) &amp; (u,v)\\in \\overline E\\end{cases}Vfâ€‹=V,Efâ€‹=E+E,câ€²(u,v)={c(u,v)âˆ’f(u,v)f(u,v)â€‹(u,v)âˆˆE(u,v)âˆˆEâ€‹ ï¼Œfâ€²f&#x27;fâ€² è¡¨ç¤º GfG_fGfâ€‹ çš„å¯è¡Œæµï¼Œåˆ™ f+fâ€²f+f&#x27;f+fâ€² ä¹Ÿæ˜¯ GGG çš„å¯è¡Œæµï¼Œâˆ£f+fâ€²âˆ£=âˆ£fâˆ£+âˆ£fâ€²âˆ£|f+f&#x27;|=|f|+|f&#x27;|âˆ£f+fâ€²âˆ£=âˆ£fâˆ£+âˆ£fâ€²âˆ£ï¼Œfff ä¸ºæœ€å¤§æµ â‡”\\Leftrightarrowâ‡” âˆ€âˆ£fâ€²âˆ£=0\\forall |f&#x27;|=0âˆ€âˆ£fâ€²âˆ£=0ã€‚ å¢å¹¿è·¯å¾„ï¼šGfG_fGfâ€‹ ä¸­ä» s\\text ss åˆ° t\\text tt çš„ä¸€æ¡ç®€å•è·¯å¾„ï¼Œæ˜¯ä¸€æ¡å¯è¡Œæµã€‚ å‰²ï¼šå°† VVV åˆ†ä¸ºä¸¤ä¸ªç‚¹é›† sâˆˆS,tâˆˆTs\\in S,t\\in TsâˆˆS,tâˆˆTã€‚ å‰²çš„å®¹é‡ï¼šc(S,T)=âˆ‘uâˆˆSâˆ‘vâˆˆTc(u,v)c(S,T)=\\sum_{u\\in S}\\sum_{v\\in T}c(u,v)c(S,T)=âˆ‘uâˆˆSâ€‹âˆ‘vâˆˆTâ€‹c(u,v) å‰²çš„æµé‡ï¼šf(S,T)=âˆ‘uâˆˆSâˆ‘vâˆˆTf(u,v)âˆ’f(v,u)f(S,T)=\\sum_{u\\in S}\\sum_{v\\in T}f(u,v)-f(v,u)f(S,T)=âˆ‘uâˆˆSâ€‹âˆ‘vâˆˆTâ€‹f(u,v)âˆ’f(v,u) f(S,T)â‰¤c(S,T)f(S,T)\\le c(S,T)f(S,T)â‰¤c(S,T)ï¼Œä¸” f(S,T)=âˆ£fâˆ£f(S,T)=|f|f(S,T)=âˆ£fâˆ£ã€‚ æœ€å¤§æµæœ€å°å‰²å®šç†ï¼šfff æ˜¯æœ€å¤§æµ â‡”\\Leftrightarrowâ‡” GfG_fGfâ€‹ æ— å¢å¹¿è·¯å¾„ â‡”\\Leftrightarrowâ‡” âˆƒ[S,T] âˆ£fâˆ£=c(S,T)\\exist_{[S,T]}\\ |f|=c(S,T)âˆƒ[S,T]â€‹ âˆ£fâˆ£=c(S,T)ï¼Œå³æœ€å¤§æµ === æœ€å°å‰²ã€‚ è¯æ˜ä¸€ä¸‹ï¼Œé¦–å…ˆæœ€å¤§æµ â‰¤\\leâ‰¤ æœ€å°å‰²è¿™ä¸ªæ˜¾ç„¶ï¼Œç„¶åè€ƒè™‘æœ€å¤§æµä¸Šçš„ç“¶é¢ˆè¾¹ä¸€å®šæ˜¯ä¸€ä¸ªå‰²å¦åˆ™ä»æœ‰å¢å¹¿è·¯å¾„ï¼Œæ‰€ä»¥æœ€å¤§æµ â‰¥\\geâ‰¥ æœ€å°å‰²ï¼Œå¾—åˆ°æœ€å¤§æµ === æœ€å°å‰²ã€‚ æœ€å¤§æµ EK\\text{EK}EK æ±‚æœ€å¤§æµï¼šä¸æ–­ bfs\\text{bfs}bfs æ‰¾åˆ°ä¸€æ¡å¢å¹¿è·¯å¾„ç´¯åŠ è¿›å½“å‰æµå¹¶æ›´æ–°æ²¿é€”çš„æµé‡ï¼Œæ‰¾ä¸åˆ°å¢å¹¿è·¯å¾„æ—¶å³ä¸ºæœ€å¤§æµï¼Œå¤æ‚åº¦ O(nm2)O(nm^2)O(nm2)ï¼Œå¾ˆæ¾ã€‚ int hh,tt,q[N]; int pre[N],d[N]; bool use[N]; bool bfs() { hh=tt=0,memset(use,0,sizeof use); q[0]=s,use[s]=1,d[s]=p; while(hh&lt;=tt) { int x=q[hh++]; for(rint i=head[x];~i;i=nxt[i]) { int y=to[i]; if(!use[y]&amp;&amp;w[i]) { pre[y]=i,d[y]=min(d[x],w[i]); if(y==t) return 1; q[++tt]=y,use[y]=1; } } } return 0; } int ek() { int ans=0; while(bfs()) { ans+=d[t]; for(rint i=t;i!=s;i=to[pre[i]^1]) w[pre[i]]-=d[t],w[pre[i]^1]+=d[t]; } return ans; } Dinic\\text{Dinic}Dinic æ±‚æœ€å¤§æµï¼šä¸æ–­ bfs\\text{bfs}bfs æ ‡è®°å±‚æ•°ï¼Œå† dfs\\text{dfs}dfs å±‚é—´å¤šè·¯å¢å¹¿è·¯å¾„ï¼Œæœ‰å‰ªæä¼˜åŒ–ï¼Œå¤æ‚åº¦ O(n2m)O(n^2m)O(n2m)ï¼Œå¾ˆæ¾ã€‚ int cur[N],d[N]; int q[N],hh,tt; bool bfs() { for(rint i=1;i&lt;=n;i++) cur[i]=head[i],d[i]=0; q[hh=tt=0]=s,d[s]=1; while(hh&lt;=tt) { int x=q[hh++]; for(rint i=head[x];~i;i=nxt[i]) { int y=to[i]; if(!d[y]&amp;&amp;w[i]) { d[y]=d[x]+1; if(y==t) return 1; q[++tt]=y; } } } return 0; } int find(int x,int lim) { if(x==t) return lim; int sum=0; for(rint i=cur[x];~i&amp;&amp;sum&lt;lim;i=nxt[i]) { int y=to[i];cur[x]=i; if(d[y]==d[x]+1&amp;&amp;w[i]) { int flow=find(y,min(w[i],lim-sum)); if(!flow) d[y]=0; w[i]-=flow,w[i^1]+=flow,sum+=flow; } } return sum; } int dinic() { int ans=0,res; while(bfs()) while(res=find(s,p)) ans+=res; return ans; } äºŒåˆ†å›¾æœ€å¤§åŒ¹é…ï¼šsss å‘é›†åˆ AAA è¿å®¹é‡ä¸º 111 çš„è¾¹ï¼Œé›†åˆ BBB å‘ ttt è¿å®¹é‡ä¸º 111 çš„è¾¹ï¼Œå¯è¡ŒåŒ¹é…ä¸ºå¯¹åº”çš„ AAA å‘ BBB è¿å®¹é‡ä¸º 111 æˆ– inf\\text{inf}inf çš„è¾¹ï¼Œæœ€å¤§æµä¸ºæœ€å¤§åŒ¹é…ï¼ŒDinicDinicDinic å¤æ‚åº¦ O(mn)O(m\\sqrt n)O(mnâ€‹)ï¼Œå¯ä»¥æ‰©å±•åˆ°é™åˆ¶æ¯ä¸ªå…ƒç´ æœ€å¤šåŒ¹é…å‡ æ¬¡ã€‚ æœ€å°å‰²æ–¹æ¡ˆï¼šæ®‹é‡ç½‘ç»œä¸Šæ‰¾å‡ºè¿é€šå— SSSï¼Œå‰©ä¸‹çš„å³ä¸º TTTï¼ŒSâ†’TS\\rightarrow TSâ†’T çš„è¾¹å³ä¸ºæœ€å°å‰²æ–¹æ¡ˆã€‚ å¯è¡Œè¾¹ä¸å¿…é¡»è¾¹ï¼šå³æ‰€æœ‰æœ€å°å‰²æ–¹æ¡ˆçš„å¹¶é›†å’Œäº¤é›†ã€‚è€ƒè™‘æ®‹é‡ç½‘ç»œæ˜¯è‹¥å¹²è¿é€šå—ï¼Œå¿…é¡»è¾¹å³ä¸ºç›´æ¥è¿æ¥ S,TS,TS,T çš„è¾¹ï¼Œå¯è¡Œè¾¹å³ä¸ºè¿æ¥ä¸åŒè¿é€šå—çš„è¾¹ï¼Œå½“ç„¶è¦ä¿è¯æœ€åˆçš„æµç½‘ç»œè¿é€šã€‚ æ— æºæ±‡ä¸Šä¸‹ç•Œå¯è¡Œæµï¼šå°† c1(u,v)â‰¤f(u,v)â‰¤c2(u,v)c_1(u,v)\\le f(u,v)\\le c_2(u,v)c1â€‹(u,v)â‰¤f(u,v)â‰¤c2â€‹(u,v) è½¬åŒ–ä¸º 0â‰¤f(u,v)âˆ’c1(u,v)â‰¤c2(u,v)âˆ’c1(u,v)0\\le f(u,v)-c_1(u,v)\\le c_2(u,v)-c_1(u,v)0â‰¤f(u,v)âˆ’c1â€‹(u,v)â‰¤c2â€‹(u,v)âˆ’c1â€‹(u,v)ï¼Œå¯¹äºæ¯ä¸ªç‚¹ä»¥ âˆ‘c1(u,x)âˆ’âˆ‘c1(x,v)\\sum c_1(u,x)-\\sum c_1(x,v)âˆ‘c1â€‹(u,x)âˆ’âˆ‘c1â€‹(x,v) æ­£è´Ÿæ¥åˆ¤æ–­æ˜¯å¦æ”¾æµæˆ–éœ€æµï¼Œå»ºè™šæºæ±‡ç‚¹æ ¹æ®éœ€æ”¾æµè¿æ¥æ¯ä¸ªç‚¹ï¼Œè·‘æœ€å¤§æµå½“æµé‡æµæ»¡æ—¶å³æœ‰è§£ï¼Œæ¯æ¡è¾¹åŠ ä¸ŠåŸæ¥çš„ c1c_1c1â€‹ å³å¾—æ–¹æ¡ˆã€‚è´¹ç”¨æµå’Œè¿™ä¸ªæ˜¯ä¸€æ ·çš„ã€‚ ä¸Šä¸‹ç•Œæœ€å¤§æµï¼šç”± ttt å‘ sss è¿ä¸€æ¡å®¹é‡ infinfinf çš„è¾¹è½¬ä¸ºæ— æºæ±‡ï¼Œæ±‚å‡ºæ— æºæ±‡ä¸Šä¸‹ç•Œå¯è¡Œæµï¼Œè€Œç”±äºç°åœ¨è™šæºæ±‡ç‚¹å¿…å®šæ»¡æµæ‰€ä»¥åœ¨æ®‹é‡ç½‘ç»œä¸Šä¸ s,ts,ts,t æ— å…³ï¼Œè®°ä¸‹ tâ†’st\\rightarrow stâ†’s çš„æµé‡å†åŠ ä¸Šåˆ å»è¯¥è¾¹åæ®‹é‡ç½‘ç»œçš„æœ€å¤§æµå³ä¸ºç­”æ¡ˆã€‚ è´¹ç”¨æµå’Œè¿™ä¸ªæ˜¯ä¸€æ ·çš„ã€‚ ä¸Šä¸‹ç•Œæœ€å°æµï¼šåŒä¸Šä¸‹ç•Œæœ€å¤§æµï¼Œæœ€åè·‘æ®‹é‡ç½‘ç»œçš„æœ€å¤§æµæ—¶äº¤æ¢æºæ±‡ç‚¹ï¼Œç”¨å¯è¡Œæµå‡å»é€†æœ€å¤§æµå³å¯ã€‚ æœ€å¤§æƒé—­åˆå­å›¾ï¼š å®šä¹‰ï¼šå¸¦ç‚¹æƒæœ‰å‘å›¾çš„ä¸€ä¸ªç‚¹é›†ï¼Œæ»¡è¶³æ— å‡ºè¾¹æŒ‡å‘ç‚¹é›†å¤–çš„ç‚¹ã€‚ ç®€å•å‰²ï¼šåªå‰² sss é‚»è¾¹å’Œ ttt é‚»è¾¹çš„å‰²ã€‚ è€ƒè™‘å»ºç«‹ç½‘ç»œæµæ¨¡å‹ä½¿å¾—é—­åˆå­å›¾æ–¹æ¡ˆä¸å‰²å¯¹åº”ï¼Œé€šè¿‡æœ€å°å‰²æ±‚è§£æ–¹æ¡ˆæœ€å€¼é—®é¢˜ã€‚ å»ºç«‹æºæ±‡ç‚¹ï¼ŒåŸè¾¹å®¹é‡ä¸º inf\\text{inf}infâ€‹ï¼Œæ–°è¿è¾¹ {sâ†’âˆ€ç‚¹æƒ&gt;0âˆ€ç‚¹æƒ&lt;0â†’t\\begin{cases} s\\rightarrow \\forall ç‚¹æƒ&gt;0 \\\\ \\forall ç‚¹æƒ&lt;0 \\rightarrow t\\end{cases}{sâ†’âˆ€ç‚¹æƒ&gt;0âˆ€ç‚¹æƒ&lt;0â†’tâ€‹ï¼Œå®¹é‡ä¸ºç‚¹æƒç»å¯¹å€¼ã€‚ åŸè¾¹ä¸º infâ‡’\\text{inf} \\Rightarrowinfâ‡’ æœ€å°å‰²ä¸ºç®€å•å‰²ï¼Œæ®‹é‡ç½‘ç»œä¸­çš„ SSS ç‚¹é›†ä¸ºé—­åˆå­å›¾ã€‚ è€ƒè™‘å‰²å»äº†æ­£æƒç‚¹çš„è¾¹ä»–ä¸€å®šä¼šå±äº TTT ç‚¹é›†ï¼Œå‰²å»è´Ÿæƒç‚¹çš„è¾¹ä»–ä¸€å®šä¼šå±äº SSS ç‚¹é›†ï¼Œæ‰€ä»¥ SSS ç‚¹é›†çš„æƒå€¼å’Œ === æ­£æƒç‚¹å’Œ âˆ’-âˆ’ æœ€å°å‰²ã€‚ æ•…æœ€å¤§æƒé—­åˆå­å›¾ === æ­£æƒç‚¹å’Œ âˆ’-âˆ’ æœ€å°å‰²ã€‚ æœ€å¤§å¯†åº¦å­å›¾ï¼š å®šä¹‰ï¼šæ— å‘å›¾çš„ä¸€ä¸ªç‚¹é›†ï¼Œæ»¡è¶³å…¶ å†…éƒ¨è¾¹æ•°ç‚¹æ•°\\frac {\\text{å†…éƒ¨è¾¹æ•°}} {\\text{ç‚¹æ•°}}ç‚¹æ•°å†…éƒ¨è¾¹æ•°â€‹ æœ€å¤§ã€‚ è€ƒè™‘äºŒåˆ†ï¼Œè¾¹è½¬ä¸ºå‘ä¸¤è¾¹è¿å‡ºæœ‰å‘è¾¹çš„ç‚¹ï¼Œç‚¹æƒä¸º 111 ï¼ŒåŸç‚¹ç‚¹æƒä¸º âˆ’mid-midâˆ’midï¼Œç”¨æœ€å¤§æƒé—­åˆå­å›¾åˆ¤å®šå³å¯ï¼Œå¯ä»¥æ‰©å±•åˆ°ç‚¹è¾¹å¸¦æƒã€‚ æœ€å°å‰²æ ‘ï¼š ç”¨äºæ±‚è§£å¤šç»„ç‚¹å¯¹é—´æœ€å°å‰²ã€‚ä¸ä¼šè¯ã€‚ è€ƒè™‘å…ˆæ±‚è§£ä»»æ„ä¸€ä¸ª cut(u,v)cut(u,v)cut(u,v) ï¼Œç„¶åè¿è¾¹ [u,v,cut(u,v)][u,v,cut(u,v)][u,v,cut(u,v)]ï¼Œæ¥ç€æ ¹æ® cut(u,v)cut(u,v)cut(u,v) åˆ†æˆçš„ä¸¤ä¸ªç‚¹é›†å¾€ä¸‹é€’å½’å»ºæ ‘ï¼Œä¸¤ç‚¹æœ€å°å‰²å³ä¸¤ç‚¹ç“¶é¢ˆè·¯ï¼Œå¤æ‚åº¦ O(n3m+q)O(n^3m+q)O(n3m+q)ï¼Œå¯ä»¥ä¸ç”¨æ˜¾å¼å»ºæ ‘ç›´æ¥ O(n2)O(n^2)O(n2) æš´åŠ›å­˜ disdisdis æ•°ç»„ï¼Œæ³¨æ„æ±‚æœ€å°å‰²æ—¶è¦ç”¨åˆ°æ‰€æœ‰ç‚¹è¾¹ã€‚ ç½‘ç»œæµæŠ€å·§ï¼š æ‰¾å‡ºæºæ±‡ç‚¹ï¼Œä»¥æµæˆ–å‰²å¯¹åº”é¢˜ç›®çš„å†³ç­–ã€‚ è¯æ˜åŸé¢˜å¯è¡Œè§£ä¸å¯è¡Œæµå¯¹åº”ï¼Œå¯ä»¥æ’é™¤ä¸€å®šä¸ä¼˜çš„è§£ã€‚ ç”¨ inf\\text{inf}inf å®¹é‡æ’é™¤ä¸å‚ä¸å‰²å†³ç­–çš„è¾¹ã€‚ å°†ç‚¹æƒè½¬ç§»åˆ°æºæ±‡è¾¹æƒä¸Šï¼Œåˆ©ç”¨ç®€å•æœ€å°å‰²ä½œæœ€ä¼˜åŒ–å·¥å…·æ¥å†³ç­–ç‚¹çš„å–èˆã€‚ è´¹ç”¨æµ å®šä¹‰ï¼šè¾¹é™¤äº†å®¹é‡è¿˜å¸¦å•ä½è´¹ç”¨ï¼Œæµçš„è´¹ç”¨å°±æ˜¯æ‰€æœ‰è¾¹çš„å•ä½è´¹ç”¨ Ã—\\timesÃ— ç»è¿‡çš„æµé‡ï¼Œè´¹ç”¨æµæŒ‡æœ€å°è´¹ç”¨æœ€å¤§æµï¼Œå³æµé‡æœ€å¤§æ—¶çš„æœ€å°è´¹ç”¨ã€‚ EK\\text{EK}EK æ±‚è´¹ç”¨æµï¼šä¸æ–­ SPFA\\text{SPFA}SPFA æ‰¾è´¹ç”¨æœ€çŸ­è·¯å¢å¹¿æ›´æ–°æµé‡ï¼Œå¤æ‚åº¦èƒ½å¡åˆ° O(Fnm)O(Fnm)O(Fnm)ï¼Œä¸€èˆ¬å‹‰å¼ºçœ‹ä½œ O(nm2)O(nm^2)O(nm2)ã€‚ int d[N],pre[N],flow[N]; bool use[N]; queue&lt;int&gt; q; bool spfa() { for(rint i=1;i&lt;=n;i++) d[i]=p,flow[i]=0; q.push(s),d[s]=0,flow[s]=p; while(!q.empty()) { int x=q.front();q.pop(); use[x]=0; for(rint i=head[x];~i;i=nxt[i]) { int y=to[i]; if(w[i]&amp;&amp;d[y]&gt;d[x]+f[i]) { d[y]=d[x]+f[i]; pre[y]=i,flow[y]=min(flow[x],w[i]); if(!use[y]) q.push(y),use[y]=1; } } } return flow[t]; } void ek() { int ans=0,cost=0; while(spfa()) { ans+=flow[t],cost+=flow[t]*d[t]; for(rint i=t;i!=s;i=to[pre[i]^1]) w[pre[i]]-=flow[t],w[pre[i]^1]+=flow[t]; } cout&lt;&lt;ans&lt;&lt;&quot; &quot;&lt;&lt;cost&lt;&lt;endl; } è´Ÿç¯ï¼šç”±äºåè¾¹ç­‰æƒ…å†µï¼Œåœ¨ç¬¬ä¸€æ­¥æœ€çŸ­è·¯ä¸­å¯èƒ½ä¼šå‡ºç°è´Ÿç¯ï¼Œè¦ç”¨åˆ°æ¶ˆåœˆç®—æ³•ï¼Œä½†æ˜¯æˆ‘ä¸ä¼šï¼Œè€ƒè™‘ä¸ç®¡ã€‚ è´¹ç”¨ä¼˜å…ˆæµï¼š æœ€å¤§è´¹ç”¨ä»»æ„æµï¼šè€ƒè™‘è´¹ç”¨ä¸€ç›´åœ¨å‡å°‘ï¼Œå•æ¬¡è´¹ç”¨å³å°†ä¸ºè´Ÿæ—¶åœæ­¢å³å¯ã€‚ è´¹ç”¨ä¸ºæ­£çš„æœ€å¤§æµï¼šè€ƒè™‘è´¹ç”¨ä¸€ç›´åœ¨å‡å°‘ï¼Œæ€»è´¹ç”¨å³å°†ä¸ºè´Ÿæ—¶åœæ­¢å³å¯ã€‚ äºŒåˆ†å›¾ç›¸å…³ äºŒåˆ†å›¾åˆ¤å®š å›¾ä¸ºäºŒåˆ†å›¾ â‡”\\Leftrightarrowâ‡” æ²¡æœ‰å¥‡ç¯ï¼Œdfs\\text{dfs}dfs æŸ“è‰²åˆ¤å®šå³å¯ ã€‚ äºŒåˆ†å›¾æœ€å¤§åŒ¹é… åŒˆç‰™åˆ©ç®—æ³•ï¼š ä¸€ä¸ªåŒ¹é…ä¸ºæœ€å¤§åŒ¹é… â‡”\\Leftrightarrowâ‡” æ²¡æœ‰å¢å¹¿è·¯ã€‚å¢å¹¿è·¯å°±æ˜¯äº¤æ›¿èµ°éåŒ¹é…è¾¹å’ŒåŒ¹é…è¾¹å¥‡æ•°æ­¥çš„è·¯å¾„ã€‚è¯æ˜è€ƒè™‘é¦–å…ˆæœ€å¤§åŒ¹é…æ˜¾ç„¶æ²¡æœ‰å¢å¹¿è·¯ï¼Œç„¶åä¸æ˜¯æœ€å¤§åŒ¹é…çš„ä¸€å®šå­˜åœ¨ä¸¤ä¸ªç‚¹æ˜¯æ–°åŠ å…¥çš„ï¼Œä»¥å…¶ä½œä¸ºå¢å¹¿è·¯çš„ä¸¤ç«¯æ˜¯ä¸€å®šå¯è¡Œçš„ï¼Œæ‰€ä»¥ä¸€å®šæœ‰å¢å¹¿è·¯ã€‚ åŒˆç‰™åˆ©ç®—æ³•å°±æ˜¯éå†å·¦ä¾§çš„æ‰€æœ‰ç‚¹è¿›è¡Œ dfs\\text{dfs}dfs å°è¯•ä¸ºå…¶å¯»æ‰¾å¢å¹¿è·¯ï¼Œå¤æ‚åº¦ O(nm)O(nm)O(nm)ã€‚ bool dfs(int x,int now) { if(use[x]==now) return 0; use[x]=now; for(auto &amp;it:e[x]) if(!mch[it]||dfs(mch[it],now)) return mch[it]=x,1; return 0; } å…·ä½“æ¥è¯´å³è¾¹çš„ç‚¹åªç”¨åˆ°äº† mch\\text{mch}mchï¼Œæ˜¯å¯ä»¥ä¸æ˜¾å¼å­˜åœ¨çš„ï¼Œåœ¨ä¸€äº›æ‹†ç‚¹åœºæ™¯å¯ä»¥å‡å°‘ç é‡ã€‚ ç½‘ç»œæµ Dinic\\text{Dinic}Dinic ï¼šO(mn)O(m\\sqrt n)O(mnâ€‹)ã€‚ Hall å®šç† äºŒåˆ†å›¾å®Œç¾åŒ¹é…ï¼šé’¦å®š âˆ£Aâˆ£â‰¤âˆ£Bâˆ£|A|\\le|B|âˆ£Aâˆ£â‰¤âˆ£Bâˆ£ï¼ŒåŒ¹é…æ•° === âˆ£Aâˆ£|A|âˆ£Aâˆ£ çš„ä¸€ç»„åŒ¹é…ã€‚ Hall\\text{Hall}Hall å®šç†ï¼šäºŒåˆ†å›¾å­˜åœ¨å®Œç¾åŒ¹é… â‡”\\Leftrightarrowâ‡” âˆ€aâŠ†A\\forall a\\sube Aâˆ€aâŠ†Aï¼Œè®¾ bbb ä¸º aaa èƒ½åˆ°è¾¾çš„å³éƒ¨ç‚¹é›†çš„å¹¶ï¼Œæ»¡è¶³ âˆ£aâˆ£â‰¤âˆ£bâˆ£|a|\\le|b|âˆ£aâˆ£â‰¤âˆ£bâˆ£ã€‚ exHall\\text{exHall}exHall å®šç†ï¼šäºŒåˆ†å›¾æœ€å¤§åŒ¹é… === âˆ£Aâˆ£âˆ’maxâ¡(âˆ£aâˆ£âˆ’âˆ£bâˆ£)|A|-\\max (|a|-|b|)âˆ£Aâˆ£âˆ’max(âˆ£aâˆ£âˆ’âˆ£bâˆ£)ã€‚ äºŒåˆ†å›¾åšå¼ˆ å³äºŒåˆ†å›¾ä¸Šäº¤æ›¿è¡Œèµ°è°ä¸èƒ½èµ°è°è¾“ï¼Œé—®é¢˜ç­‰ä»·äºèµ·ç‚¹æ˜¯å¦ä¸ºæœ€å¤§åŒ¹é…å¿…ç»ç‚¹ï¼Œè¯æ˜è€ƒè™‘å¿…ç»ç‚¹èµ°ä¸¤æ­¥ä¸€å®šä¼šåˆ°å¿…ç»ç‚¹ã€‚ åˆ¤æ–­äºŒåˆ†å›¾å¿…ç»ç‚¹å¯ä»¥ç”¨æœ€å°å‰²å¿…é¡»è¾¹æ¥åˆ¤æ–­ã€‚ ä¹Ÿå¯ä»¥ç”¨åŒˆç‰™åˆ©åˆ¤æ–­ã€‚å…·ä½“åœ°ï¼Œè€ƒè™‘åˆ¤æ–­éå¿…ç»ç‚¹ï¼Œåœ¨æ¯æ¬¡å¢å¹¿æ–°ç‚¹å¢å¹¿è·¯å¤±è´¥çš„æ—¶å€™ï¼Œé‚£ä»–ä¸€å®šæ˜¯éå¿…ç»ç‚¹ï¼ŒåŒæ—¶ä¸ä¹‹ç›¸é‚»çš„åŒ¹é…ä¹Ÿéƒ½å¯ä»¥è¢«æ›¿æ¢æ‰ï¼Œä¹Ÿä¸ºéå¿…ç»ç‚¹é€’å½’æ ‡è®°ä¸‹å»å°±è¡Œã€‚ bool dfs(int x,int now) { if(use[x]==now) return 0; use[x]=now; for(auto &amp;it:e[x]) if(!mch[it]||dfs(mch[it],now)) return mch[it]=x,1; return 0; } void dfs2(int x,int now) { if(use[x]==now) return; use[x]=now,ans[x]=1; for(auto &amp;it:e[x]) if(mch[it]) dfs2(mch[it],now); } for(rint i=1;i&lt;=n;i++) if(!dfs(i,i)) dfs2(i,n+i); äºŒåˆ†å›¾æœ€å°ç‚¹è¦†ç›– äºŒåˆ†å›¾æœ€å°ç‚¹è¦†ç›– === æœ€å¤§åŒ¹é…æ•°ï¼Œä¸€èˆ¬å›¾æ˜¯ NPC\\text{NPC}NPCã€‚ è¯æ˜è€ƒè™‘ç½‘ç»œæµï¼Œä¸­é—´å®¹é‡ä¸º inf\\text{inf}infï¼Œå‘ç°æœ€å°å‰²ç­‰ä»·äºæœ€å°ç‚¹è¦†ç›–ã€‚æ®æ­¤ä¹Ÿå¯ä»¥æ‹“å±•åˆ°ç‚¹å¸¦æƒã€‚ æ„é€ æ–¹æ¡ˆè€ƒè™‘æˆ‘ä»¬å¾—åˆ°äº†æ‰€æœ‰æœ€å¤§åŒ¹é…çš„ç›¸å…³ç‚¹ï¼Œæœ€å°ç‚¹è¦†ç›–ä¸€å®šåœ¨é‡Œé¢ï¼Œæšä¸¾æ‰€æœ‰ä¸ç›¸å…³ç‚¹çš„ç›¸é‚»ç‚¹æ˜¯å¿…é€‰çš„ï¼Œè‹¥å‰©ä¸‹çš„éƒ½æ˜¯ç›¸å…³ç‚¹å°±ä»»é€‰ä¸€ä¸ªç»§ç»­åšã€‚ æœ€å°è¾¹è¦†ç›–ï¼šè€ƒè™‘æ¯ä¸€æ¬¡é€‰è¾¹åªèƒ½æ–°è¦†ç›– 111 æˆ– 222 ä¸ªç‚¹ï¼Œè¦†ç›– 222 ä¸ªç‚¹æ˜¯ä¸€ä¸ªåŒ¹é…ï¼Œæ•…æœ€å°è¾¹è¦†ç›– === ç‚¹æ•° âˆ’-âˆ’ æœ€å°ç‚¹è¦†ç›–ã€‚ æœ€å¤§ç‹¬ç«‹é›† ç‹¬ç«‹é›†ï¼šä¸€ç»„ç‚¹é›†å…¶ä¸¤ä¸¤ä¹‹é—´æ— è¾¹ã€‚ å›¢ï¼šä¸€ç»„ç‚¹é›†å…¶ä¸¤ä¸¤ä¹‹é—´æœ‰è¾¹ã€‚æœ€å¤§ç‹¬ç«‹é›† === è¡¥å›¾æœ€å°å›¢ã€‚ æœ€å¤§ç‹¬ç«‹é›†çš„è¡¥é›†ä¸€å®šä¼šå°†æ‰€æœ‰è¾¹è¦†ç›–ï¼Œæ•…æœ€å¤§ç‹¬ç«‹é›† === æœ€å°ç‚¹è¦†ç›–ï¼Œæœ€å¤§æƒç‹¬ç«‹é›† === æœ€å°æƒç‚¹è¦†ç›–ã€‚ æœ€å°è·¯å¾„è¦†ç›– è·¯å¾„è¦†ç›–ï¼šDAG\\text{DAG}DAG ä¸Šä¸€ç»„è¦†ç›–æ‰€æœ‰ç‚¹çš„ç‚¹ä¸äº¤è·¯å¾„ã€‚ä¹Ÿç§°é“¾è¦†ç›–ã€‚ è€ƒè™‘æ‹†ç‚¹ï¼Œå‡ºç‚¹å’Œå…¥ç‚¹å½¢æˆäºŒåˆ†å›¾ï¼Œå‘ç°ä¸€ç»„è·¯å¾„è¦†ç›–å¯¹åº”åˆ°äºŒåˆ†å›¾çš„ä¸€ç»„åŒ¹é…ï¼Œè€Œè·¯å¾„æ•° === ç‚¹æ•° âˆ’-âˆ’ åŒ¹é…æ•°ï¼Œè½¬åŒ–ä¸ºæ±‚æœ€å¤§åŒ¹é…ã€‚ æœ€å°å¯é‡è·¯å¾„è¦†ç›–ï¼šåœ¨ä¼ é€’é—­åŒ…åçš„ DAG\\text{DAG}DAG ä¸Šåšæœ€å°è·¯å¾„ç‚¹è¦†ç›–å³å¯ï¼Œè¿™é‡Œçš„ä¼ é€’é—­åŒ…å³ä¸¤ç‚¹è¿é€š â‡’\\Rightarrowâ‡’ ä¸¤ç‚¹è¿è¾¹ï¼Œæœç´¢ O(nm)O(nm)O(nm) ä¸è¿‡ Floyd\\text{Floyd}Floyd æ›´å¥½å†™ã€‚ Dilworth å®šç† å®šä¹‰ï¼šå¯¹äºä»»æ„æœ‰é™ååºé›†ï¼Œå…¶æœ€é•¿åé“¾ä¸­å…ƒç´ çš„æ•°ç›®å¿…ç­‰äºæœ€å°é“¾è¦†ç›–ä¸­é“¾çš„æ•°ç›®ã€‚ ååºé›†å½¢æˆçš„å›¾æ˜¯ DAG\\text{DAG}DAGï¼Œæ”¾åˆ° DAG\\text{DAG}DAG ä¸Šæ¥è¯´çš„è¯å…¶å®å°±æ˜¯æœ€å°å¯é‡è·¯å¾„è¦†ç›– === æœ€å¤§ä¸äº’è¾¾ç‚¹é›†ã€‚ è¯æ˜çš„è¯è€ƒè™‘æ”¾åˆ° DAG\\text{DAG}DAG ä¸Šï¼Œè®°ä¸€ä¸ªæœ€å°å¯é‡è·¯å¾„è¦†ç›–æ–¹æ¡ˆçš„è·¯å¾„ç»“å°¾ç‚¹é›† E\\text EEï¼ŒE\\text EE æ¯ä¸ªç‚¹èƒ½èµ°åˆ°ä¸å«è‡ªèº«çš„ç‚¹é›†å¹¶ä¸º Eâ€²\\text E&#x27;Eâ€²ï¼Œè‹¥ Eâ€²\\text E&#x27;Eâ€² æ»¡è¶³ \\text E\\and\\text E'=\\empty å³ä¸äº’è¾¾åˆ™æˆç«‹ï¼Œå¦åˆ™å¯¹äº \\text E\\and\\text E' ä¸­çš„æ¯ä¸ªç‚¹å¾€æ²¿ç€è·¯å¾„è¿”å›ç›´åˆ°ä¸å±äº Eâ€²\\text E&#x27;Eâ€² å¾—åˆ°æ–¹æ¡ˆï¼Œè€ƒè™‘è·¯å¾„ä¸Šä¸€å®šä¸ä¼šå…¨éƒ¨å±äº Eâ€²\\text E&#x27;Eâ€² å¦åˆ™ä¸€å®šèƒ½è¢«è¿™æ¡å¯é‡è·¯å¾„å»¶ä¼¸åŒ…å«æ‰€ä»¥ä¸€å®šèƒ½å¾—åˆ°æ–¹æ¡ˆã€‚ æè¶…çº¿æ®µæ ‘ ç”¨é€”ï¼šæ”¯æŒ O(logâ¡2)O(\\log^2)O(log2) æ’å…¥çº¿æ®µ O(logâ¡)O(\\log)O(log) æŸ¥è¯¢å•ç‚¹æœ€å€¼ã€‚è‹¥å…¨ä¸ºç›´çº¿åˆ™æ’å…¥ä¸º O(logâ¡)O(\\log)O(log)ï¼Œæ”¯æŒåŠ¨æ€å¼€ç‚¹ã€æŒä¹…åŒ–ã€‚ å®ç°ï¼šæ ‡è®°æ°¸ä¹…åŒ–çº¿æ®µæ ‘ï¼Œå¤§å€¼åŸŸéœ€è¦ç¦»æ•£åŒ–æˆ–åŠ¨æ€å¼€ç‚¹ï¼Œå®æ•°éœ€è¦ç¦»æ•£åŒ–ã€‚ v[N&lt;&lt;2] ç»´æŠ¤è¦†ç›–åŒºé—´ [l,r] ä¸”æ˜¯ mid å¤„æœ€å€¼çš„çº¿æ®µç¼–å·ã€‚ æ’å…¥ï¼šé€’å½’åˆ°å­åŒºé—´ï¼Œä¸ºç©ºç›´æ¥èµ‹å€¼è¿”å›ï¼Œè‹¥ä¸­ç‚¹å€¼ä¼˜äº v[now] åˆ™ä¸ä¹‹äº¤æ¢ï¼Œå†è€ƒè™‘å½“å‰çš„çº¿æ®µæ˜¯å¦æ¯” v[now] çš„å·¦å³ç«¯ç‚¹ä¼˜å†å¾€å·¦å³é€’å½’ã€‚ç”±äºä¸¤çº¿æ®µæœ€å¤šæœ‰ä¸€ä¸ªäº¤ç‚¹ï¼Œæ‰€ä»¥ä¸€æ¬¡æ’å…¥æœ€å¤šäº§ç”Ÿ O(logâ¡)O(\\log)O(log) ä¸ªäº¤ç‚¹æ“ä½œï¼Œæ¯æ¬¡æ“ä½œåˆæ˜¯ O(logâ¡)O(\\log)O(log) çš„ï¼Œæ•…ä¸º O(logâ¡2)O(\\log^2)O(log2)ã€‚ æŸ¥è¯¢ï¼šè®¡ç®—é€’å½’åˆ°å­åŒºé—´æ²¿é€”çš„æ‰€æœ‰çº¿æ®µå–å€¼æœ€å€¼å³å¯ã€‚ struct tree{ //çº¿æ®µ #define cal(i,x) (k[i]*x+b[i]) int v[M&lt;&lt;2]; void insert(int l,int r,int x,int nowl=1,int nowr=m,int now=1) { int mid=(nowl+nowr)&gt;&gt;1; if(l&lt;=nowl&amp;&amp;nowr&lt;=r) { bool lp=cal(x,nowl)&gt;cal(v[now],nowl), rp=cal(x,nowr)&gt;cal(v[now],nowr), mp=cal(x,mid)&gt;cal(v[now],mid); if(!v[now]) lp=rp=mp=1; if(mp) swap(x,v[now]),lp^=1,rp^=1; if(nowl==nowr) return; if(lp) insert(l,r,x,nowl,mid,now&lt;&lt;1); if(rp) insert(l,r,x,mid+1,nowr,now&lt;&lt;1|1); return; } if(l&lt;=mid) insert(l,r,x,nowl,mid,now&lt;&lt;1); if(r&gt;mid) insert(l,r,x,mid+1,nowr,now&lt;&lt;1|1); } int ask(int x,int l=1,int r=m,int now=1) { if(l==r) return v[now]; int mid=(l+r)&gt;&gt;1; int res=(x&lt;=mid)?ask(x,l,mid,now&lt;&lt;1):ask(x,mid+1,r,now&lt;&lt;1|1); if(!v[now]||!res) return v[now]|res; double ll=cal(v[now],x),rr=cal(res,x); if(abs(ll-rr)&lt;eps) return min(res,v[now]); return ll&gt;rr?v[now]:res; } }t; struct tree{ //ç›´çº¿ int v[N&lt;&lt;2]; #define cal(i,x) (k[i]*x+b[i]) void insert(int x,int l=1,int r=m,int now) { if(!v[now]) return v[now]=x,void(); int mid=(l+r)&gt;&gt;1; if(cal(x,mid)&lt;cal(v[now],mid)) swap(v[now],x); if(l==r) return; if(cal(x,l)&lt;cal(v[now],l)) insert(x,l,mid,now&lt;&lt;1); if(cal(x,r)&lt;cal(v[now],r)) insert(x,mid+1,r,now&lt;&lt;1|1); } int ask(int x,int l=1,int r=m,int now) { if(l==r) return v[now]; int mid=(l+r)&gt;&gt;1, res=(x&lt;=mid)?ask(x,l,mid,now&lt;&lt;1):ask(x,mid+1,r,now&lt;&lt;1|1); if(!res||!v[now]) return res|v[now]; return cal(res,x)&lt;cal(v[now],x)?res:v[now]; } }t; ODT é¢œè‰²æ®µå‡æ‘Š ç”¨é€”ï¼šç»´æŠ¤å•çº¯åŒºé—´èµ‹å€¼æˆ–çº¯éšæœºæ•°æ®ä¸‹æ”¯æŒéå†ï¼Œå¤æ‚åº¦ O(nlogâ¡logâ¡n)O(n\\log\\log n)O(nloglogn)ã€‚ å®ç°ï¼šæŠŠå€¼ç›¸åŒçš„åŒºé—´åˆå¹¶æˆä¸€ä¸ªèŠ‚ç‚¹ï¼Œç”¨ set\\text{set}set ç»´æŠ¤ã€‚ å¯¹äº set\\text{set}set ä¸­ä¸å‚ä¸æ¯”è¾ƒçš„å˜é‡å‚æ•°ç”¨ mutable ä¿®é¥°å¯ä»¥æ”¯æŒä¿®æ”¹ï¼Œè¿™é‡Œçš„åŒºé—´å€¼éœ€è¦ mutableã€‚ æ ¸å¿ƒæ“ä½œï¼šauto split(int x) å°† [x\\text{[x}[x å¤„åˆ‡æ–­å¹¶è¿”å› x\\text xx å¤„è¿­ä»£å™¨ï¼Œæ³¨æ„å®ç°ç»†èŠ‚ï¼ŒåŒºé—´æ“ä½œéƒ½é€šè¿‡ split æ¥å–å‡ºåŒºé—´æš´åŠ›æ‰§è¡Œã€‚ struct node{ int l,r; mutable int v; bool operator &lt;(const node&amp; x)const{return l&lt;x.l;} }; set&lt;node&gt; odt; auto split(int x) { auto it=odt.lower_bound({x,0,0}); if(it!=odt.end()&amp;&amp;it-&gt;l==x) return it; it--; int l=it-&gt;l,r=it-&gt;r,v=it-&gt;v; odt.erase(it),odt.insert({l,x-1,v}); return odt.insert({x,r,v}).first; } void assign(int l,int r,int v) { auto itr=split(r+1),itl=split(l); odt.erase(itl,itr),odt.insert({l,r,v}); } void add(int l,int r,int v) //éšæœºæ“ä½œå’ŒèŒƒå›´æ—¶æ”¯æŒéå†,ä¸éšæœºåªèƒ½éª—åˆ† { auto itr=split(r+1),itl=split(l); for(auto it=itl;it!=itr;it++) it-&gt;v+=v; } K-D Tree ç”¨é€”ï¼šç»´æŠ¤é«˜ç»´ç©ºé—´ç‚¹é›†çš„æ£€ç´¢ï¼Œç©ºé—´å¤æ‚åº¦ O(n)O(n)O(n)ã€‚ å»ºæ ‘ï¼šç±»ä¼¼äºçº¿æ®µæ ‘çš„ Leafy\\text{Leafy}Leafy ç»“æ„ï¼Œæ¯ä¸ªèŠ‚ç‚¹ç»´æŠ¤ä¸€ä¸ªåŒ…å«åŒºé—´å†…æ‰€æœ‰ç‚¹çš„è¶…çŸ©å½¢ï¼Œå»ºæ ‘æ—¶äº¤æ›¿ç»´åº¦é€‰å½“å‰ç»´åº¦çš„ä¸­ä½æ•°ä¸º mid\\text{mid}mid åˆ†æ²»å°±èƒ½ä¿è¯æ ‘é«˜ä¸º O(logâ¡)O(\\log)O(log)ï¼Œå¤æ‚åº¦ O(nlogâ¡)O(n\\log)O(nlog)ã€‚ æŸ¥è¯¢ï¼šå¯¹ä¸€ä¸ªè¶…çŸ©å½¢è¿›è¡Œè¯¢é—®ï¼Œåœ¨ KDT\\text{KDT}KDT ä¸Šæœ€å¤šæ¶‰åŠ O(n1âˆ’1k)O(n^{1-\\frac 1 k})O(n1âˆ’k1â€‹) ä¸ªèŠ‚ç‚¹ï¼Œç±»ä¼¼çº¿æ®µæ ‘å¾€å·¦å³å„¿å­é€’å½’è¯¢é—®å³å¯ï¼Œå¤æ‚åº¦ O(n1âˆ’1k)O(n^{1-\\frac 1 k})O(n1âˆ’k1â€‹)ã€‚ æ’å…¥ï¼šè®¾é˜ˆå€¼ B\\text BBï¼Œæ’å…¥çš„ç‚¹æ•°å°äº B\\text BB åˆ™åœ¨ KDT\\text{KDT}KDT å¤–æš´åŠ›ç»Ÿè®¡ï¼Œå¤§äºé˜ˆå€¼åˆ™é‡æ„ KDT\\text{KDT}KDTï¼Œå¤æ‚åº¦ O(nBnlogâ¡+n(n1âˆ’1k+B))O(\\frac n B n\\log+n(n^{1-\\frac 1 k}+B))O(Bnâ€‹nlog+n(n1âˆ’k1â€‹+B))ï¼Œå– B=nlogâ¡B=\\sqrt{n\\log}B=nlogâ€‹ å¾—åˆ° O(nnlogâ¡+n2âˆ’1k)O(n\\sqrt{n\\log}+n^{2-\\frac 1 k})O(nnlogâ€‹+n2âˆ’k1â€‹)ã€‚ åˆ é™¤ï¼šèƒ½é¢å¤–æ’é™¤çš„è¯å¯ä»¥ç±»ä¼¼æ’å…¥ä¸€æ ·è®¾é˜ˆå€¼é‡æ„ï¼Œå¦åˆ™åªèƒ½é€’å½’åˆ°å¶å­æ¶ˆå»è´¡çŒ®å†ç±»ä¼¼æ›¿ç½ªç¾Šæ ‘åšå­æ ‘é˜ˆå€¼é‡æ„ï¼Œæ²¡æœ‰å®ç°è¿‡ã€‚ é‚»åŸŸæŸ¥è¯¢ï¼šä¿¡æ¯ä¸èƒ½åœ¨è¶…çŸ©å½¢ä¸Šå®Œå…¨ç»´æŠ¤å¯èƒ½è¦å¾€ä¸‹é€’å½’æŸ¥è¯¢æ—¶ï¼Œå¤æ‚åº¦ O(n)O(n)O(n)ï¼Œå¯èƒ½èƒ½åœ¨ KDT\\text{KDT}KDT ä¸Šç»´æŠ¤ä¿¡æ¯åšå¯å‘å¼æœç´¢ä¹±æã€‚ struct node{ int x,y,val; }a[N]; bool cmpx(const node &amp;A,const node &amp;B){return A.x&lt;B.x;} bool cmpy(const node &amp;A,const node &amp;B){return A.y&lt;B.y;} struct data{ int xl,xr,yl,yr,val; bool Apart(const data &amp;A)const{return xl&gt;A.xr||xr&lt;A.xl||yl&gt;A.yr||yr&lt;A.yl;} bool inclu(const data &amp;A)const {return xl&lt;=A.xl&amp;&amp;A.xr&lt;=xr &amp;&amp; yl&lt;=A.yl&amp;&amp;A.yr&lt;=yr;} bool inclu(const node &amp;A)const {return xl&lt;=A.x&amp;&amp;A.x&lt;=xr &amp;&amp; yl&lt;=A.y&amp;&amp;A.y&lt;=yr;} }; struct kdtree{ data v[N&lt;&lt;2]; void build(int l,int r,int now=1,bool how=0) { if(l==r) return v[now]={a[l].x,a[l].x,a[l].y,a[l].y,a[l].val},void(); int mid=(l+r)&gt;&gt;1; nth_element(a+l,a+mid,a+r+1,how?cmpx:cmpy); build(l,mid,now&lt;&lt;1,!how),build(mid+1,r,now&lt;&lt;1|1,!how); int ls=now&lt;&lt;1,rs=now&lt;&lt;1|1; v[now]={min(v[ls].xl,v[rs].xl),max(v[ls].xr,v[rs].xr), min(v[ls].yl,v[rs].yl),max(v[ls].yr,v[rs].yr), v[ls].val+v[rs].val}; } data aks; void ask(int l,int r,int now=1) { if(aks.Apart(v[now])) return; if(aks.inclu(v[now])) return aks.val+=v[now].val,void(); int mid=(l+r)&gt;&gt;1; ask(l,mid,now&lt;&lt;1),ask(mid+1,r,now&lt;&lt;1|1); } void dfs(int l,int r,int now=1) //ä¹±æ { double d=aks.dis(v[now]); if(d&gt;ans&amp;&amp;!aks.in(v[now])) return; if(l==r) { if(d==p) { if(!same) same=1; else ans=0; }else ans=d; return; } int mid=(l+r)&gt;&gt;1; if(aks.dis(v[now&lt;&lt;1])&lt;aks.dis(v[now&lt;&lt;1|1])) dfs(l,mid,now&lt;&lt;1),dfs(mid+1,r,now&lt;&lt;1|1); else dfs(mid+1,r,now&lt;&lt;1|1),dfs(l,mid,now&lt;&lt;1); } }t; int nowl,nowr; void insert() { a[++nowr]={read(),read(),read()}; if((nowr-nowl)*(nowr-nowl)&gt;nowr*40) t.build(1,nowl=nowr); break; } è«é˜Ÿ æ™®é€šè«é˜Ÿ å®šä¹‰ï¼šå¯¹äºåºåˆ—ä¸Šçš„åŒºé—´è¯¢é—®é—®é¢˜ï¼Œè€ƒè™‘æ¯ä¸€ä¸ªè¯¢é—®ä»ä¸Šä¸€ä¸ªè¯¢é—®é€æ­¥æ‹“å±•ç¼©å‡åŒºé—´å¾—åˆ°ç­”æ¡ˆï¼Œæ³¨æ„å¯èƒ½æœ‰ nowl&gt;nowr è¦å…ˆæ‹“å±•ï¼Œç¦»çº¿è¯¢é—®æ’åºèƒ½åšåˆ° O(mn)O(m\\sqrt n)O(mnâ€‹)ã€‚ å®ç°ï¼šè€ƒè™‘åˆ†å—ï¼Œå°†è¯¢é—®æŒ‰ &lt;å·¦ç«¯ç‚¹å—ç¼–å·,å³ç«¯ç‚¹&gt; æ’åºï¼Œè®¾å—é•¿ä¸º B\\text BBï¼Œé‚£ä¹ˆå¯¹äºæ¯ä¸ªå—ä¸­çš„è¯¢é—®ï¼Œæ¯ä¸ªä¼šå°†å·¦ç«¯ç‚¹ç§»åŠ¨ O(B)O(B)O(B) æ¬¡ï¼Œæ€»ä½“ä¼šå°†å³ç«¯ç‚¹ç§»åŠ¨ O(n)O(n)O(n) æ¬¡ï¼Œæ‰€ä»¥æ€»å…±æ˜¯ O(mB+n2B)O(mB+\\frac {n^2} B)O(mB+Bn2â€‹) æ¬¡æ‹“å±•ç¼©å‡ï¼ŒO(m)O(m)O(m) æ¬¡æŸ¥è¯¢ï¼Œå‡è®¾æ“ä½œ O(1)O(1)O(1) çš„è¯ B\\text BB å– nm\\frac n {\\sqrt m}mâ€‹nâ€‹ å¾—åˆ° O(nm)O(n\\sqrt m)O(nmâ€‹)ï¼Œå®é™…ä¸Š B\\text BB å–å®šå€¼æ›´ç®€å•æœ‰æ•ˆã€‚ å¥‡å¶æ’åºï¼šä¸Šè¿°æ’åºåœ¨ç›¸é‚»å—é—´è½¬ç§»æ—¶å³ç«¯ç‚¹ä¼šå…ˆç§»å›å·¦ç«¯å†åˆ°å³ç«¯ï¼Œè€ƒè™‘åœ¨å·¦ç«¯ç‚¹ä¸ºå¶å—æ—¶å³ç«¯ç‚¹é™åºæ’åºå°±èƒ½æœ‰æ•ˆå‡å°‘å†—ä½™ã€‚ å¸¦ä¿®è«é˜Ÿ ä¿®æ”¹ç›¸å½“äºå¤šäº†ä¸€ç»´æ—¶é—´ç»´åº¦ï¼Œä¿®æ”¹æ“ä½œå¯ä»¥çœ‹ä½œæ˜¯ä¸å½“å‰çš„åºåˆ— swap\\text{swap}swapï¼Œè‹¥åœ¨å½“å‰åŒºé—´ä¸­åˆ™è¦è¿›è¡Œç»´æŠ¤ï¼Œæ’åºæŒ‰ &lt;å·¦ç«¯ç‚¹å—ç¼–å·,å³ç«¯ç‚¹å—ç¼–å·,æ—¶é—´&gt; æ’åºï¼Œç”¨ç±»ä¼¼çš„åˆ†ææ–¹æ³• B\\text BB å– O(n2tm3)O(\\sqrt[3]{\\frac {n^2t} m})O(3mn2tâ€‹â€‹) å¾—åˆ° O(n2m2t3)O(\\sqrt[3]{n^2m^2t})O(3n2m2tâ€‹)ï¼ŒåŒé˜¶å³ä¸º O(n53)O(n^{\\frac 5 3})O(n35â€‹)ã€‚ struct data{ int l,r,id,t; bool operator &lt;(const data &amp;A)const { if(l/kuai!=A.l/kuai) return l&lt;A.l; if(r/kuai!=A.r/kuai) return r&lt;A.r; return t&lt;A.t; } }q[N]; struct change{int k,x;}ch[N]; int nowans,c[M]; void add(int x){if(!c[a[x]]++) nowans++;} void del(int x){if(!--c[a[x]]) nowans--;} void change(int x,int l,int r) { int pos=ch[x].k; if(l&lt;=pos&amp;&amp;pos&lt;=r) del(pos),swap(ch[x].x,a[pos]),add(pos); else swap(ch[x].x,a[pos]); } void modui() { sort(q+1,q+nq+1); int nowl=q[1].l,nowr=q[1].r,nowt=q[1].t; for(rint i=nowl;i&lt;=nowr;i++) add(i); for(rint i=1;i&lt;=nowt;i++) change(i,nowl,nowr); ans[q[1].id]=nowans; for(rint i=2;i&lt;=nq;i++) { int l=q[i].l,r=q[i].r,t=q[i].t; while(nowl&gt;l) add(--nowl); while(nowr&lt;r) add(++nowr); while(nowl&lt;l) del(nowl++); while(nowr&gt;r) del(nowr--); while(nowt&lt;t) change(++nowt,nowl,nowr); while(nowt&gt;t) change(nowt--,nowl,nowr); ans[q[i].id]=nowans; } } å›æ»šè«é˜Ÿ å®šä¹‰ï¼šå³åªæœ‰æ‹“å±•æ“ä½œæˆ–åªæœ‰ç¼©å‡æ“ä½œçš„è«é˜Ÿï¼Œå¤æ‚åº¦ O(nm)O(n\\sqrt m)O(nmâ€‹)ã€‚ å®ç°ï¼šè€ƒè™‘åªæœ‰æ‹“å±•æ“ä½œï¼Œè¯¢é—®æŒ‰ &lt;å·¦ç«¯ç‚¹å—ç¼–å·,å³ç«¯ç‚¹&gt; æ’åºï¼Œå¦‚æœå½“å‰è¯¢é—®æ¢å—äº†å°±æ¨å€’ä»å—çš„å³ç«¯ç‚¹ç©ºåŒºé—´å¼€å§‹ï¼Œå¦‚æœå³ç«¯ç‚¹åœ¨å·¦ç«¯ç‚¹å—ä¸­å°±å•ç‹¬æš´åŠ›æ‰«ï¼Œç°åœ¨å½“å‰åŒºé—´ä¸€å®šåŒ…å«äºè¯¢é—®åŒºé—´ï¼Œè€ƒè™‘å…ˆæ‹“å±•å³ç«¯ç‚¹ï¼Œç„¶åå¤‡ä»½ï¼Œå†æ‹“å±•å·¦ç«¯ç‚¹å›ç­”è¯¢é—®ï¼Œæœ€åå›é€€è‡³å¤‡ä»½ï¼Œè¿™æ ·å¤æ‚åº¦åŒæ ·æ˜¯ O(nm)O(n\\sqrt m)O(nmâ€‹)ï¼Œå…±æœ‰ O(m)O(m)O(m) æ¬¡å¤‡ä»½æ“ä½œï¼Œåªç¼©å‡æ“ä½œå¯ä»¥ç±»ä¼¼è§£å†³ã€‚ void add(int x){ cnt[a[x]]++,nowans=max(nowans,cnt[a[x]]*b[a[x]]); } void modui() { sort(q+1,q+1+m); for(rint i=1;i&lt;=m;) { int nowkuai=q[i].l/kuai; while(i&lt;=m&amp;&amp;q[i].r/kuai==nowkuai) { nowans=0; for(rint j=q[i].l;j&lt;=q[i].r;j++) add(j); ans[q[i].id]=nowans; for(rint j=q[i].l;j&lt;=q[i].r;j++) cnt[a[j]]--; i++; } nowans=0; int edge=min(n+1,(nowkuai+1)*kuai),l=edge,r=edge-1; while(i&lt;=m&amp;&amp;q[i].l/kuai==nowkuai) { while(r&lt;q[i].r) add(++r); int backup=nowans; while(l&gt;q[i].l) add(--l); ans[q[i].id]=nowans; while(l&lt;edge) cnt[a[l++]]--; nowans=backup; i++; } for(rint j=edge;j&lt;=r;j++) cnt[a[j]]--; } } æ ‘ä¸Šè«é˜Ÿ å®šä¹‰ï¼šå¤„ç†æ ‘ä¸Šçš„è·¯å¾„è¯¢é—®é—®é¢˜ï¼Œè½¬åŒ–æˆ dfs\\text{dfs}dfs åºä¸Šçš„æ™®é€šè«é˜Ÿï¼Œå¤æ‚åº¦ O(nm)O(n\\sqrt m)O(nmâ€‹)ã€‚ å®ç°ï¼šdfs\\text{dfs}dfs åºåˆ—å°±æ˜¯è®°å½•èŠ‚ç‚¹åœ¨ dfs\\text{dfs}dfs è¿›å…¥å’Œç¦»å¼€æ—¶çš„é•¿ä¸º 2n\\text{2n}2n çš„åºåˆ—ï¼Œè€ƒè™‘è·¯å¾„ (x,y)(x,y)(x,y)ï¼Œå…ˆé’¦å®š first[x]&lt;first[y] ï¼Œè¿™æ ·å½“ lca=xlca=xlca=x æ—¶è·¯å¾„ä¸Šçš„ç‚¹å°±ä¸º [first[x],first[y]][first[x],first[y]][first[x],first[y]] ä¸Šå‡ºç°ä¸€æ¬¡çš„ç‚¹ï¼Œå¦åˆ™ä¸º [last[x],first[y]][last[x],first[y]][last[x],first[y]] ä¸Šå‡ºç°ä¸€æ¬¡çš„ç‚¹åŠ ä¸Š lcalcalcaï¼Œå®¹æ˜“ç”¨ bool\\text{bool}bool è®°å½•å‡ºç°æ¬¡æ•°å®ç°å†³å®šç‚¹æ·»åŠ åˆ é™¤ã€‚ void add(int x) { use[x]^=1; if(use[x]) nowans+=a[c[x]]*b[++cnt[c[x]]]; else nowans-=a[c[x]]*b[cnt[c[x]]--]; } void change(int x) { if(use[ch[x].x]) add(ch[x].x),swap(ch[x].v,c[ch[x].x]),add(ch[x].x); else swap(ch[x].v,c[ch[x].x]); } void modui() { sort(q+1,q+1+cntq); int nowl=q[1].l,nowr=nowl-1,nowt=0; for(rint i=1;i&lt;=cntq;i++) { int l=q[i].l,r=q[i].r,t=q[i].t; while(nowl&gt;l) add(o[--nowl]); while(nowr&lt;r) add(o[++nowr]); while(nowl&lt;l) add(o[nowl++]); while(nowr&gt;r) add(o[nowr--]); if(q[i].fa) add(q[i].fa); while(nowt&lt;t) change(++nowt); while(nowt&gt;t) change(nowt--); ans[q[i].id]=nowans; if(q[i].fa) add(q[i].fa); } } signed main() { for(rint i=1;i&lt;=m;i++) if(read()) { int x=read(),y=read(),fa=lca(x,y); if(first[x]&gt;first[y]) swap(x,y); if(x==fa) q[++cntq]={first[x],first[y],0,cntc,cntq}; else q[++cntq]={last[x],first[y],fa,cntc,cntq}; }else ch[++cntc]={read(),read()}; modui(); } æ‚é¡¹ äºŒç»´å“ˆå¸Œ è®°ä¸€ä¸ªçŸ©é˜µ aaa çš„å“ˆå¸Œå€¼ä¸º âˆ‘i=1nâˆ‘j=1mai,jp1nâˆ’ip2mâˆ’j\\sum_{i=1}^n\\sum_{j=1}^ma_{i,j}p_1^{n-i}p_2^{m-j} i=1âˆ‘nâ€‹j=1âˆ‘mâ€‹ai,jâ€‹p1nâˆ’iâ€‹p2mâˆ’jâ€‹ ç±»ä¼¼å‰ç¼€å’Œå¯ä»¥ O(1)O(1)O(1) æ±‚å­çŸ©é˜µå“ˆå¸Œå€¼ï¼ŒH(x2,y2)âˆ’H(x1âˆ’1,y2)p1x2âˆ’x1+1âˆ’H(x2,y1âˆ’1)p2y2âˆ’y1+1+H(x1âˆ’1,y1âˆ’1)p1x2âˆ’x1+1p2y2âˆ’y1+1H(x_2,y_2)-H(x_1-1,y_2)p_1^{x_2-x_1+1}-H(x_2,y_1-1)p_2^{y_2-y_1+1}+H(x_1-1,y_1-1)p_1^{x_2-x_1+1}p_2^{y_2-y_1+1}H(x2â€‹,y2â€‹)âˆ’H(x1â€‹âˆ’1,y2â€‹)p1x2â€‹âˆ’x1â€‹+1â€‹âˆ’H(x2â€‹,y1â€‹âˆ’1)p2y2â€‹âˆ’y1â€‹+1â€‹+H(x1â€‹âˆ’1,y1â€‹âˆ’1)p1x2â€‹âˆ’x1â€‹+1â€‹p2y2â€‹âˆ’y1â€‹+1â€‹ã€‚ æšä¸¾å­çŸ©å½¢ æš´åŠ›æšä¸¾ç«¯ç‚¹æ˜¯ O(n2m2)O(n^2m^2)O(n2m2) çš„ï¼Œè€ƒè™‘å…ˆå¤§åŠ›æšä¸¾è¡Œçš„ä¸¤ä¸ªç«¯ç‚¹ï¼Œç„¶åå†åˆ©ç”¨å‰ç¼€å’Œçš„æ€æƒ³ç»Ÿè®¡åˆ—ï¼Œå°±æ˜¯æŠŠå·¦ç«¯è´¡çŒ®è®°åœ¨æ¡¶é‡Œï¼Œä¸æ–­ç§»å³ç«¯æŸ¥è¯¢å¹¶æ›´æ–°æ¡¶å³å¯ï¼Œå¯ä»¥åšåˆ° O(n2m)=O(SS)O(n^2m)=O(S\\sqrt S)O(n2m)=O(SSâ€‹)ã€‚ å›¾ä¸‰å››å…ƒç¯è®¡æ•° æ— å‘å›¾ä¸‰å…ƒç¯è®¡æ•°ï¼šè€ƒè™‘å°†è¾¹å®šå‘ï¼Œç”±åº¦æ•°å°çš„è¿å‘åº¦æ•°å¤§çš„ï¼Œç›¸åŒåˆ™æŒ‰ç¼–å·ï¼Œè€ƒè™‘åœ¨å½¢æˆçš„ DAG ç›´æ¥æšä¸¾ä¸‰å…ƒç¯çš„å¤æ‚åº¦ä¸º âˆ‘iniÃ—outi\\sum in_i\\times out_iâˆ‘iniâ€‹Ã—outiâ€‹ ï¼Œå› ä¸º outiâ‰¤duiout_i\\leq du_ioutiâ€‹â‰¤duiâ€‹ ä¸” duson of iâ‰¥duidu_{son\\ of \\ i}\\geq du_iduson of iâ€‹â‰¥duiâ€‹ ï¼Œè€ƒè™‘ outiâˆ—outiâ‰¤âˆ‘outiduson of iâ‰¤2mout_i*out_i \\leq \\sum^{out_i}du_{son\\ of \\ i}\\leq 2moutiâ€‹âˆ—outiâ€‹â‰¤âˆ‘outiâ€‹duson of iâ€‹â‰¤2m ï¼Œæ‰€ä»¥ outiâ‰¤2mout_i\\leq \\sqrt {2m}outiâ€‹â‰¤2mâ€‹ ï¼Œå¤æ‚åº¦ä¸º O(mm)O(m\\sqrt m)O(mmâ€‹)ã€‚ for(rint i=1;i&lt;=n;i++) { for(auto &amp;it:e[i]) use[it]=1; for(auto &amp;it:e[i]) for(auto &amp;jt:e[it]) if(use[jt]) ans++; for(auto &amp;it:e[i]) use[it]=0; } æ— å‘å›¾å››å…ƒç¯è®¡æ•°ï¼šåŒæ ·å®šå‘å¹¶æšä¸¾ï¼Œæœ‰å‘å››å…ƒç¯æœ‰ 2+22+22+2 å’Œ 3+13+13+1 ä¸¤ç§å½¢å¼ï¼Œå‘ç°éƒ½å¯ä»¥è¢«å”¯ä¸€è¡¨ç¤ºä¸ºä¸¤ä¾§æ— å‘è¾¹+æœ‰å‘è¾¹çš„å½¢å¼ï¼Œæšä¸¾å››å…ƒç¯çš„ä¸€ä¾§è®¡æ•°å³å¯ï¼Œå¤æ‚åº¦ä¸º âˆ‘duiÃ—outi\\sum du_i\\times out_iâˆ‘duiâ€‹Ã—outiâ€‹ åŒç†å¯å¾— O(mm)O(m\\sqrt m)O(mmâ€‹)ã€‚ for(rint i=1;i&lt;=n;i++) { for(auto it:ee[u]) for(auto jt:e[it]) if(rk[jt]&gt;rk[i]) ans+=cnt[jt]++; for(auto it:ee[u]) for(auto jt:e[it]) cnt[jt]=0; } æœ‰å‘å›¾ä¸‰å››å…ƒç¯è®¡æ•°ï¼šè½¬æ— å‘å›¾æŒ‰æ— å‘å›¾çš„åšï¼Œåœ¨æ‰¾åˆ°ç¯çš„æ—¶å€™ check ä¸€ä¸‹æ˜¯å¦åˆæ³•å³å¯ã€‚ æ ‘å“ˆå¸Œ O(n)O(n)O(n)ï¼Œæœ‰æ ¹æ ‘ h[u]=âˆ‘hash(h[v])h[u]=\\sum hash(h[v])h[u]=âˆ‘hash(h[v])ï¼Œæ— æ ¹æ ‘ä»¥é‡å¿ƒä¸ºæ ¹å³å¯ï¼ŒåŒé‡å¿ƒå°±åšä¸¤æ¬¡ã€‚ mt19937_64 rd(19260817); unordered_map&lt;uint,uint&gt; mp; uint hsh(const uint x){return mp.find(x)==mp.end()?mp[x]=rd():mp[x];} uint dfs(int x=1,int fa=1) { uint ha=0; for(auto &amp;it:e[x]) if(it!=fa) ha+=hsh(dfs(it,x)); return ha; } è™šæ ‘ å°†å…³é”®ç‚¹æŒ‰ dfn\\text{dfn}dfn æ’åºï¼Œå°†ç›¸é‚»ä¸¤ç‚¹çš„ LCA\\text{LCA}LCA åŠ å…¥åå†æ¬¡æ’åºï¼Œå•è°ƒæ ˆæ±‚å‡ºè¿è¾¹å…³ç³»ã€‚ void build() { sort(a+1,a+num+1,cmp); for(rint i=2,nn=num;i&lt;=nn;i++) a[++num]=lca(a[i-1],a[i]); sort(a+1,a+num+1,cmp),num=unique(a+1,a+num+1,Equal)-a-1; for(rint i=1;i&lt;=num;i++) e[a[i]].clear(); int top=0; for(rint i=1;i&lt;=num;i++) { while(top&amp;&amp;dfn[stk[top]]+sz[stk[top]]-1&lt;dfn[a[i]]) top--; if(top) e[stk[top]].push_back(a[i]),e[a[i]].push_back(stk[top]); stk[++top]=a[i]; } } äºŒé¡¹å¼åæ¼” æ°å¥½å’Œè‡³å°‘çš„è½¬æ¢ï¼šè®¾ fff è¡¨ç¤ºæ°å¥½çš„æ–¹æ¡ˆæ•°ï¼Œggg è¡¨ç¤ºè‡³å°‘çš„æ–¹æ¡ˆæ•°ï¼Œåˆ™æœ‰ï¼š g(i)=âˆ‘j=in(ji)f(j)â‡”f(i)=âˆ‘j=in(âˆ’1)jâˆ’i(ji)g(j)g(i)=\\sum_{j=i}^n\\binom j i f(j)\\Leftrightarrow f(i)=\\sum_{j=i}^n(-1)^{j-i}\\binom j i g(j) g(i)=j=iâˆ‘nâ€‹(ijâ€‹)f(j)â‡”f(i)=j=iâˆ‘nâ€‹(âˆ’1)jâˆ’i(ijâ€‹)g(j) æ°å¥½å’Œè‡³å¤šçš„è½¬æ¢ï¼šè®¾ fff è¡¨ç¤ºæ°å¥½çš„æ–¹æ¡ˆæ•°ï¼Œggg è¡¨ç¤ºè‡³å¤šçš„æ–¹æ¡ˆæ•°ï¼Œåˆ™æœ‰ï¼š g(i)=âˆ‘j=0i(ij)f(j)â‡”f(i)=âˆ‘j=0i(âˆ’1)iâˆ’j(ij)g(j)g(i)=\\sum_{j=0}^i\\binom i j f(j)\\Leftrightarrow f(i)=\\sum_{j=0}^i(-1)^{i-j}\\binom i j g(j) g(i)=j=0âˆ‘iâ€‹(jiâ€‹)f(j)â‡”f(i)=j=0âˆ‘iâ€‹(âˆ’1)iâˆ’j(jiâ€‹)g(j) é«˜ç»´å‰ç¼€å’Œ sumi=âˆ‘jâŠ†iajsum_i=\\sum_{j \\subseteq i} a_jsumiâ€‹=âˆ‘jâŠ†iâ€‹ajâ€‹ï¼Œæš´åŠ›æ±‚æ˜¯ O(3n)O(3^n)O(3n) çš„ï¼Œè€ƒè™‘å¯¹äºæ¯ä¸€ç»´åˆ†åˆ«åšå‰ç¼€å’Œå°±å¯ä»¥åšåˆ° O(n2n)O(n2^n)O(n2n)ï¼Œåç¼€å’ŒåŒç†ã€‚ for(rint i=0;i&lt;n;i++) for(rint j=0;j&lt;1&lt;&lt;n;j++) if(j&gt;&gt;i&amp;1) a[j]+=a[j^(1&lt;&lt;i)]; for(rint i=0;i&lt;n;i++) //åç¼€å’Œ for(rint j=0;j&lt;1&lt;&lt;n;j++) if(!(j&gt;&gt;i&amp;1)) a[j]+=a[j^(1&lt;&lt;i)]; çº¿æ®µæ ‘åˆå¹¶ è€ƒè™‘æ ‘ä¸Šæ¯ä¸ªèŠ‚ç‚¹å»ºä¸€æ£µæƒå€¼çº¿æ®µæ ‘ç»´æŠ¤å­æ ‘ä¿¡æ¯ï¼Œè¿›è¡Œçº¿æ®µæ ‘åˆå¹¶æ—¶ç©ºå¤æ‚åº¦éƒ½æ˜¯ O(nlogâ¡)O(n\\log)O(nlog) çš„ï¼Œä¸€èˆ¬ç¦»çº¿è¯¢é—®ç›´æ¥åœ¨åŸæ ‘ä¸Šåˆå¹¶ï¼Œéœ€è¦åœ¨çº¿è¯¢é—®åˆ™åˆå¹¶éœ€è¦æ–°å¼€èŠ‚ç‚¹ï¼Œç©ºé—´å¸¦äºŒå€å¸¸æ•°ï¼Œå®é™…éƒ½æ˜¯èƒ½å¼€å¤šå¤§å¼€å¤šå¤§ã€‚ int root[N],idx; struct node{ int ls,rs;data x; }v[N*50]; int merge(int x,int y,int l=1,int r=n) { if(!x||!y) return x|y; if(l==r) return v[x].x+=v[y].x,x; int mid=(l+r)&gt;&gt;1; v[x].ls=merge(v[x].ls,v[y].ls,l,mid), v[x].rs=merge(v[x].rs,v[y].rs,mid+1,r); v[x].x=v[x.ls].x+v[x.rs].x; return x; } void sel(int x=1,int fa=1) { for(auto &amp;it:e[x]) if(it!=fa) sel(it,x),root[x]=merge(root[x],root[it]); ans[x]=ask(root[x]); } dsu on tree ä¹Ÿå«æ ‘ä¸Šå¯å‘å¼åˆå¹¶æˆ–é™æ€é“¾åˆ†æ²»ï¼Œå¯¹äºç»Ÿè®¡å­æ ‘ä¿¡æ¯ï¼Œè€ƒè™‘é€’å½’è½»å„¿å­å¹¶æ¶ˆé™¤å½±å“ï¼Œå†é€’å½’é‡å„¿å­ä¸æ¶ˆé™¤å½±å“ï¼Œæœ€åæš´åŠ›åŠ å…¥æ‰€æœ‰è½»å„¿å­ä¸­çš„ç‚¹çš„å½±å“ï¼Œè¿™æ ·å¯å‘å¼å¤æ‚åº¦æ˜¯ O(nlogâ¡)O(n\\log)O(nlog) ä¸”ç©ºé—´ä¸ºçº¿æ€§ã€‚ int sta[N],top,res,ans[N]; int f[1&lt;&lt;22]; void init(){ res=0; while(top) f[sta[top--]]=-p; } void sel(int k,int x){ res=max(res,f[k]+x); for(rint i=0;i&lt;22;i++) res=max(res,f[k^1&lt;&lt;i]+x); } void add(int k,int x){ sta[++top]=k,f[k]=max(f[k],x); } void selt(int x,int dep,int sum){ sel(sum,dep); for(auto &amp;it:e[x]) selt(it.to,dep+1,sum^1&lt;&lt;it.v); } void addt(int x,int dep,int sum){ add(sum,dep); for(auto &amp;it:e[x]) addt(it.to,dep+1,sum^1&lt;&lt;it.v); } void dfs(int x=1,int dep=1,int sum=0) { for(auto &amp;it:e[x]) if(it.to!=son[x]) dfs(it.to,dep+1,sum^1&lt;&lt;it.v),init(),ans[x]=max(ans[x],ans[it.to]);; if(son[x]) dfs(son[x],dep+1,sum^1&lt;&lt;sone[x]),ans[x]=max(ans[x],ans[son[x]]),res=0; for(auto &amp;it:e[x]) if(it.to!=son[x]) selt(it.to,dep+1,sum^1&lt;&lt;it.v),addt(it.to,dep+1,sum^1&lt;&lt;it.v); add(sum,dep),sel(sum,dep),ans[x]=max(ans[x],res-2*dep); } çŒ«æ ‘ çŒ«æ ‘ï¼šè€ƒè™‘å¯¹äºçº¿æ®µæ ‘ä¸Šçš„æ¯ä¸ªèŠ‚ç‚¹æš´åŠ›è®°ä¸­ç‚¹åˆ°å·¦å³ç«¯ç‚¹çš„å‰ç¼€å’Œï¼Œé‚£ä¹ˆå¯¹äºä¸€æ¬¡è¯¢é—®åªéœ€è¦æ‰¾åˆ°çº¿æ®µæ ‘ä¸Šçš„ LCA\\text{LCA}LCA è¿›è¡Œä¸€æ¬¡åˆå¹¶ï¼Œè¿™æ ·æ—¶é—´å¤æ‚åº¦ä¸º O(nlogâ¡+q)O(n\\log+q)O(nlog+q)ï¼Œç©ºé—´å¤æ‚åº¦ä¸º O(nlogâ¡)O(n\\log)O(nlog)ï¼Œæ‰¾ LCA\\text{LCA}LCA éœ€è¦å°†åºåˆ—è¡¥ä¸º 2n2^n2nï¼ŒLCA\\text{LCA}LCA å³ä¸º l,r\\text l,\\text rl,r ç¼–å·çš„ LCP\\text{LCP}LCPï¼Œåœ¨çŒ«æ ‘å› ä¸ºå¼€ç©ºé—´çš„å…³ç³»æ˜¯æ¯å±‚èŠ‚ç‚¹å…±ç”¨ä¸€ç»´ç©ºé—´ï¼Œæ‰¾åˆ°æ·±åº¦å°±è¡Œã€‚ struct tree{ int pos[N],v[21][N],suf[21][N]; void build(int l=1,int r=1&lt;&lt;(__lg(n)+1),int now=1,int d=1) { if(l==r) return pos[l]=now,void(); int mid=(l+r)&gt;&gt;1,sum,mxsum; v[d][mid]=suf[d][mid]=mxsum=sum=a[mid]; for(rint i=mid-1;i&gt;=l;i--) { sum+=a[i],mxsum=max(a[i],mxsum+a[i]); v[d][i]=max(v[d][i+1],mxsum); suf[d][i]=max(suf[d][i+1],sum); } v[d][mid+1]=suf[d][mid+1]=mxsum=sum=a[mid+1]; for(rint i=mid+2;i&lt;=r;i++) { sum+=a[i],mxsum=max(a[i],mxsum+a[i]); v[d][i]=max(v[d][i-1],mxsum); suf[d][i]=max(suf[d][i-1],sum); } build(l,mid,now&lt;&lt;1,d+1),build(mid+1,r,now&lt;&lt;1|1,d+1); } int ask(int l,int r) { if(l==r) return a[l]; int d=__lg(pos[l])-__lg(pos[l]^pos[r]); return max({v[d][l],v[d][r],suf[d][l]+suf[d][r]}); } }t; çŒ«æ ‘åˆ†æ²»ï¼šç©ºé—´å¼€ä¸ä¸‹æ—¶ï¼Œå¯ä»¥ç¦»çº¿è¯¢é—®ç„¶ååˆ†æ²»è§£å†³ï¼Œæ—¶é—´å¤æ‚åº¦ä¸å˜ã€‚ struct tree{ int f[N][210]; void init(int l=1,int r=1&lt;&lt;(__lg(n)+1),int now=1) { if(l==r) return pos[l]=now,void(); int mid=(l+r)&gt;&gt;1; init(l,mid,now&lt;&lt;1),init(mid+1,r,now&lt;&lt;1|1); } void work(int l=1,int r=1&lt;&lt;(__lg(n)+1),int now=1) { if(l==r) return; int mid=(l+r)&gt;&gt;1,rr=min(r,n); for(rint i=0;i&lt;=200;i++) f[mid][i]=f[mid+1][i]=0; for(rint i=200;i&gt;=w[mid];i--) f[mid][i]=v[mid]; for(rint i=mid-1;i&gt;=l;i--) { for(rint j=0;j&lt;=200;j++) f[i][j]=f[i+1][j]; for(rint j=200;j&gt;=w[i];j--) f[i][j]=max(f[i][j],f[i][j-w[i]]+v[i]); } for(rint i=200;i&gt;=w[mid+1];i--) f[mid+1][i]=v[mid+1]; for(rint i=mid+2;i&lt;=rr;i++) { for(rint j=0;j&lt;=200;j++) f[i][j]=f[i-1][j]; for(rint j=200;j&gt;=w[i];j--) f[i][j]=max(f[i][j],f[i][j-w[i]]+v[i]); } for(auto &amp;it:q[now]) for(rint i=0;i&lt;=it.x;i++) ans[it.id]=max(ans[it.id],f[it.l][i]+f[it.r][it.x-i]); work(l,mid,now&lt;&lt;1),work(mid+1,r,now&lt;&lt;1|1); } void ask(int l,int r,int x,int i) { if(l==r) ans[i]=(w[l]&lt;=x?v[l]:0); else q[pos[l]&gt;&gt;(__lg(pos[l]^pos[r])+1)].push_back({l,r,x,i}); } }t; å¸¦çŠ¶é«˜æ¶ˆ ä¸€ä¸ªçŸ©é˜µæ‰€æœ‰æœ‰å€¼çš„ä½ç½®è·ç¦»ä¸»å¯¹è§’çº¿ â‰¤d\\le dâ‰¤d ç§°ä¸ºå¸¦çŠ¶çŸ©é˜µï¼Œæ¶ˆå…ƒå¯ä»¥åšåˆ° O(nd2)O(nd^2)O(nd2) çš„å¤æ‚åº¦ã€‚å…·ä½“åœ°ï¼Œè€ƒè™‘é«˜æ–¯æ¶ˆå…ƒæ—¶å†…å±‚æ¶ˆå…ƒæ—¶åªè€ƒè™‘å‘¨å›´ d2d^2d2 çš„æœ‰å€¼çš„åŒºåŸŸï¼Œåœ¨æ‰¾ä¸»å…ƒç³»æ•°ä¸º 000 æ—¶äº¤æ¢åˆ—ä»ç„¶ä¸ä¼šç ´åå¸¦çŠ¶çš„æ€§è´¨ï¼Œä¹Ÿå¯ä»¥äº¤æ¢è¡Œå‘é‡ï¼Œè¿™æ ·æ¨ªå‘çš„ ddd å¯èƒ½å˜ä¸º 2d2d2dï¼Œå¸¦ 222 å€å¸¸æ•°ã€‚ void gauss() { const int d=3; for(rint i=1;i&lt;=m;i++) { if(!a[i][i]) for(rint j=i+1;j&lt;=min(i+d,m);j++) if(a[j][i]) { for(rint k=i;k&lt;=min(i+2*d,m);k++) swap(a[i][k],a[j][k]); swap(a[i][m+1],a[j][m+1]); break; } if(!a[i][i]) continue; for(rint j=i+1;j&lt;=min(i+d,m);j++) { int res=a[j][i]*qp(a[i][i])%p; for(rint k=i;k&lt;=min(i+2*d,m);k++) a[j][k]=(a[j][k]-a[i][k]*res%p+p)%p; a[j][m+1]=(a[j][m+1]-a[i][m+1]*res%p+p)%p; } } for(rint i=m;i;i--) { for(rint j=i+1;j&lt;=min(i+2*d,m);j++) a[i][m+1]=(a[i][m+1]-a[i][j]*a[j][m+1]%p+p)%p,a[i][j]=0; a[i][m+1]=a[i][m+1]*qp(a[i][i])%p,a[i][i]=1; } } å¦‚æœæ˜¯ä¸€ä¸ªå¸¦çŠ¶çŸ©é˜µåŠ ä¸Šä¸€ä¸ªä¸‰è§’çŸ©é˜µï¼Œå¯ä»¥ç”¨ç±»ä¼¼çš„æ–¹æ³•åšåˆ° O(n2d)O(n^2d)O(n2d)ï¼Œæ­¤æ—¶å°±åªèƒ½äº¤æ¢åˆ—ä¸ç„¶ä¼šç ´åæ€§è´¨ã€‚ void gauss() { const int d=3; for(rint i=1;i&lt;=n;i++) fr[i]=i; for(rint i=1;i&lt;=n;i++) { if(!a[i][i]) for(rint j=i+1;j&lt;=min(n,i+d);j++) if(a[j][i]) { for(rint k=1;k&lt;=n;k++) swap(a[k][i],a[k][j]); swap(fr[i],fr[j]); break; } if(!a[i][i]) continue; int inv=qp(a[i][i]); for(rint j=i+1;j&lt;=n;j++) { int res=inv*a[j][i]%p; for(rint k=i;k&lt;=min(n,i+d);k++) a[j][k]=(a[j][k]-a[i][k]*res%p+p)%p; a[j][n+1]=(a[j][n+1]-a[i][n+1]*res%p+p)%p; } } for(rint i=n;i;i--) { for(rint j=i+1;j&lt;=min(n,i+d);j++) a[i][n+1]=(a[i][n+1]-a[j][n+1]*a[i][j]%p+p)%p,a[i][j]=0; a[i][n+1]=a[i][n+1]*qp(a[i][i])%p,a[i][i]=1; ans[fr[i]]=a[i][n+1]; } }","categories":[],"tags":[{"name":"çœé€‰","slug":"çœé€‰","permalink":"https://saigonoinorio.github.io/tags/çœé€‰/"}],"keywords":[]},{"title":"å˜´å·´å¼€è®¡ç®—å‡ ä½•","slug":"å˜´å·´å¼€è®¡ç®—å‡ ä½•","date":"2022-12-05T02:40:48.000Z","updated":"2023-03-04T15:57:25.813Z","comments":false,"path":"2022/12/05/å˜´å·´å¼€è®¡ç®—å‡ ä½•/","link":"","permalink":"https://saigonoinorio.github.io/2022/12/05/å˜´å·´å¼€è®¡ç®—å‡ ä½•/","excerpt":"","text":"åŸºç¡€ ç‚¹ï¼ˆå‘é‡ï¼‰ï¼šçœ‹ä½œ 1Ã—21\\times21Ã—2 çš„çŸ©é˜µï¼Œç‚¹ç§¯æ„ä¸ºæŠ•å½±ï¼Œå‰ç§¯æ„ä¸ºé¢ç§¯ï¼Œæ­£è´ŸæŒ‰å³æ‰‹å®šåˆ™ã€‚ ç‚¹æ’åºï¼šæŒ‰ pair æ’ï¼›çº¿æ’åºï¼šæŒ‰æè§’ atan2(y,x)atan2(y,x)atan2(y,x) æ’ï¼Œå¹³è¡Œåˆ™ä¸Šé¢æ’å‰é¢ã€‚ bool operator &lt;(Line &amp;a) { double x=angle(),y=a.angle(); if(abs(x-y)&lt;eps) return (v^(a.P-P))&lt;0; return x&lt;y; } ä¸¤çº¿äº¤ç‚¹ï¼šå¹³è¡Œåˆ™ä¸äº¤ï¼Œç«¯ç‚¹å‡ºå‘æŒ‰æ¯”ä¾‹ç§»åŠ¨åˆ°äº¤ç‚¹ï¼Œæ¯”ä¾‹æŒ‰å‰ç§¯ç®—é¢ç§¯æ¯”ä¾‹æ¥ç®—ã€‚ Point inter(const Line &amp;a,const Line &amp;b) { if(abs(a.v^b.v)&lt;eps) return {7-p,p+9}; //not_inter return a.P+a.v*(((b.P-a.P)^b.v)/(a.v^b.v)); } ä¸¤çº¿å¤¹è§’ï¼šç‚¹ç§¯å®šä¹‰å³å¯ï¼šaâ‹…b=âˆ£aâˆ£âˆ£bâˆ£cosâ¡Î¸aÂ·b=|a||b|\\cos\\thetaaâ‹…b=âˆ£aâˆ£âˆ£bâˆ£cosÎ¸ ç‚¹/å‘é‡é¡ºæ—¶é’ˆæ—‹è½¬ï¼š[xy]Ã—[cosâ¡Î¸âˆ’sinâ¡Î¸sinâ¡Î¸cosâ¡Î¸]\\begin{bmatrix} x &amp; y \\end{bmatrix}\\times\\begin{bmatrix} \\cos\\theta &amp; -\\sin\\theta\\\\ \\sin\\theta &amp; \\cos\\theta \\end{bmatrix}[xâ€‹yâ€‹]Ã—[cosÎ¸sinÎ¸â€‹âˆ’sinÎ¸cosÎ¸â€‹] ç‚¹åˆ°ç›´çº¿çš„è·ç¦»ï¼šå‰ç§¯ç®—é¢ç§¯é™¤ä»¥åº•ï¼›ç‚¹åˆ°çº¿æ®µçš„è·ç¦»ï¼šç‰¹åˆ¤ç‚¹ï¼Œç‚¹ç§¯çœ‹æ˜¯å¦åœ¨ä¸¤ç«¯ç‚¹å¤–ï¼Œè§„çº¦åˆ°ç›´çº¿ã€‚ double point_to_seg(const Point &amp;x,const Point &amp;a,const Point &amp;b) { if(a==b) return (x-a).mo(); Vector v1=b-a,v2=x-a,v3=x-b; if(v1*v2&lt;0) return v2.mo(); if(v1*v3&gt;0) return v3.mo(); return point_to_line(x, a, b); } ç‚¹åœ¨ç›´çº¿ä¸Šï¼šä¸ä¸¤ç«¯ç‚¹è¿çº¿å‰ç§¯ä¸º 000 ï¼›ç‚¹åœ¨çº¿æ®µä¸Šï¼šä¸”å†…å‘è¿çº¿ç‚¹ç§¯ â‰¤0\\leq0â‰¤0 . å‡¸åŒ… æ±‚å‡¸åŒ…ï¼šå°†ç‚¹æ’åºï¼Œä¾æ¬¡å¾€é‡ŒåŠ ç‚¹åŒæ—¶ç»´æŠ¤å‡¸æ€§å³å¯ï¼Œæ­£ååšä¸€éï¼Œå‡¸æ€§ç”¨å‰ç§¯åˆ¤å³å¯ï¼Œå¹³çš„å°±çœ‹æ˜¯å¦æ–°çš„æ›´çŸ­å³å¯ï¼Œå¾—åˆ°å‡¸åŒ…é€†æ—¶é’ˆåºç‚¹é›†ã€‚ bool tu(const Point &amp;a,const Point &amp;b,const Point &amp;c) { double pos=(a-c)^(b-c); if(abs(pos)&gt;eps) return pos&lt;0; return (a-c).mo()&lt;(b-c).mo()+eps; } int n;Point P[N],h[N&lt;&lt;1];int tail; void hull() { sort(P+1,P+n+1); h[++tail]=P[1],h[++tail]=P[2]; for(rint i=3;i&lt;=n;h[++tail]=P[i],i++) while(tail&gt;1&amp;&amp;!tu(P[i],h[tail],h[tail-1])) tail--; h[++tail]=P[n-1]; for(rint i=n-2;i;h[++tail]=P[i],i--) while(tail&gt;1&amp;&amp;!tu(P[i],h[tail],h[tail-1])) tail--; //h[tail]==h[1] } æ—‹è½¬å¡å£³ï¼šæ±‚å‡¸åŒ…ç›´å¾„ï¼Œå‘ç°å…·æœ‰å•è°ƒæ€§å’Œå•å³°æ€§ï¼Œæšä¸¾è¾¹åŒæ—¶å•æŒ‡é’ˆè·Ÿç€èµ°å³å¯ï¼Œç”¨å‰ç§¯åˆ¤è·ç¦»å³å¯ã€‚ double hull_len() { if(tail&lt;=3) return (h[1]-h[tail-1]).mo(); double ans=0; for(rint i=1,j=3;i&lt;tail;i++) { while(((h[i+1]-h[i])^(h[j]-h[i]))&lt;((h[i+1]-h[i])^(h[j+1]-h[i]))) j=(j==tail-1?1:j+1); ans=max(ans,max((h[j]-h[i]).mo(),(h[j]-h[i+1]).mo())); } return ans; } é—µå¯å¤«æ–¯åŸºå’Œï¼šæ±‚ä¸¤å‡¸åŒ…ç‚¹é›†ä¹‹å’Œå½¢æˆçš„å‡¸åŒ…ï¼Œå®¹æ˜“å‘ç°æ–°å‡¸åŒ…çš„è¾¹ç”±åŸä¸¤å‡¸åŒ…è¾¹ç»„æˆï¼Œæ‰¾åˆ°å·¦ä¸‹ç‚¹ç„¶åä¸€æ­¥æ­¥è´ªå¿ƒåŠ è¾¹å³å¯ã€‚ int n,m,q,num1,num2; Point h1[N&lt;&lt;1],h2[N&lt;&lt;1],H[N&lt;&lt;2];int cnt; void minkfusji() { H[cnt=1]=h1[1]+h2[1]; int now1=1,now2=1; while(now1&lt;num1&amp;&amp;now2&lt;num2) { if(((h1[now1+1]-h1[now1])^(h2[now2+1]-h2[now2]))&gt;0) H[cnt+1]=H[cnt]+h1[now1+1]-h1[now1],now1++,cnt++; else H[cnt+1]=H[cnt]+h2[now2+1]-h2[now2],now2++,cnt++; } while(now1&lt;num1) H[cnt+1]=H[cnt]+h1[now1+1]-h1[now1],now1++,cnt++; while(now2&lt;num2) H[cnt+1]=H[cnt]+h2[now2+1]-h2[now2],now2++,cnt++; } åŠ¨æ€å‡¸åŒ…ï¼šå¢é‡æ³•ï¼Œset ç»´æŠ¤ä¸Šä¸‹å‡¸å£³ç‚¹é›†ï¼ŒåŠ¿èƒ½åˆ†æå¤æ‚åº¦æ˜¯ O(nlogâ¡)O(n\\log)O(nlog) ï¼ŒäºŒåˆ†æ‰¾æ¨å¹³çš„åŒºé—´ç«¯ç‚¹å³å¯ã€‚ ä¸‰ç»´å‡¸åŒ…ï¼šè€ƒè™‘ O(n2)O(n^2)O(n2) å¢é‡æ³•ï¼Œæ¯æ¬¡åŠ ç‚¹æš´åŠ›æšä¸¾æ‰€æœ‰é¢çœ‹æœ‰æ²¡æœ‰è¢«çœ‹åˆ°å³å¯ï¼Œè¦æ‰°åŠ¨ç‚¹é¿å…å››ç‚¹å…±é¢ã€‚ mt19937 rd(time(0)); struct Point{ double x,y,z; Point operator-(const Point &amp;a)const{return {x-a.x,y-a.y,z-a.z};} double operator*(const Point &amp;a)const{return x*a.x+y*a.y+z*a.z;} Point operator^(const Point &amp;a)const{return {y*a.z-z*a.y,z*a.x-x*a.z,x*a.y-y*a.x};} double mo(){return sqrt(x*x+y*y+z*z);} void shake(){x+=rd(),y+=rd(),z+=rd();} }P[N]; struct Plane{ int e[3]; Vector fa(){return (P[e[1]]-P[e[0]])^(P[e[2]]-P[e[0]]);} double area(){return fa().mo()/2;} bool above(const Point &amp;a){return (a-P[e[0]])*fa()&gt;=0;} }pl[N&lt;&lt;1],res[N&lt;&lt;1]; int n,m; bool use[N][N]; void hull() { pl[++m]={1,2,3},pl[++m]={3,2,1}; for(rint i=4;i&lt;=n;i++) { int cnt=0; for(rint j=1;j&lt;=m;j++) { bool in=pl[j].above(P[i]); if(!in) res[++cnt]=pl[j]; for(rint k=0;k&lt;3;k++) use[pl[j].e[k]][pl[j].e[(k+1)%3]]=in; } for(rint j=1;j&lt;=m;j++) for(rint k=0;k&lt;3;k++) { int x=pl[j].e[k],y=pl[j].e[(k+1)%3]; if(use[x][y]&amp;&amp;!use[y][x]) res[++cnt]={x,y,i}; } m=cnt; for(rint j=1;j&lt;=m;j++) pl[j]=res[j]; } } double hull_area() { hull(); double ans=0; for(rint i=1;i&lt;=m;i++) ans+=pl[i].area(); return ans; } åŠå¹³é¢äº¤ æ±‚åŠå¹³é¢äº¤ï¼šå°†çº¿æ’åºï¼Œç»´æŠ¤æœ‰æ•ˆçº¿çš„åŒç«¯é˜Ÿåˆ—ï¼Œä¾æ¬¡å¾€é‡ŒåŠ çº¿ï¼Œå¯¹äºå°¾é¦–ç»´æŠ¤äº¤ç‚¹åœ¨å³ï¼ŒåŠ å®Œäº†å†å°†å°¾é¦–å¯¹èµ·æ¥ç»´æŠ¤ï¼Œå¾—åˆ°å·¦åŠå¹³é¢äº¤ï¼Œå‡¸åŒ…ç‚¹å³ä¸ºç›¸é‚»ä¸¤çº¿äº¤ç‚¹ï¼Œä¸å°é—­å¯ä»¥åœ¨å¤–é¢æ¡†ä¸€å±‚è¾¹ç•Œã€‚ Line line[N];int n; int q[N],hh=1,tt; Point cut[N];int num; bool isright(const Line &amp;a,const Line &amp;b,const Line &amp;c) { Point P=inter(b,c); return (a.v^(P-a.P))&lt;-eps; } void halfcut() { sort(line+1,line+n+1); for(rint i=1;i&lt;=n;i++) { while(hh&lt;tt&amp;&amp;isright(line[i],line[q[tt]],line[q[tt-1]])) tt--; while(hh&lt;tt&amp;&amp;isright(line[i],line[q[hh]],line[q[hh+1]])) hh++; q[++tt]=i; } while(hh&lt;tt&amp;&amp;isright(line[q[hh]],line[q[tt]],line[q[tt-1]])) tt--; while(hh&lt;tt&amp;&amp;isright(line[q[tt]],line[q[hh]],line[q[hh+1]])) hh++; q[++tt]=q[hh]; for(rint i=hh;i&lt;tt;i++) cut[++num]=inter(line[q[i]],line[q[i+1]]); } åœ† ä¸‰ç‚¹å®šåœ†ï¼šå³æ±‚å¤–å¿ƒï¼Œæ±‚ä¸¤è§’å¹³åˆ†çº¿äº¤ç‚¹å³å¯ã€‚ Circle get_circle(const Point &amp;a,const Point &amp;b,const Point &amp;c) { Line ab={(a+b)*0.5,rotate(b-a,Pi/2)}, bc={(b+c)*0.5,rotate(c-b,Pi/2)}; Point P=inter(ab,bc); return {P,dis(P,a)}; } æœ€å°åœ†è¦†ç›–ï¼šéšæœºå¢é‡æ³•ï¼Œæ¯æ¬¡åŠ å…¥çš„ç‚¹è‹¥ä¸åœ¨åœ†å†…åˆ™æ–°åœ†å¿…è¿‡è¯¥ç‚¹ï¼Œå¾ªç¯ä¸‰å±‚å³å¯ï¼Œå°†ç‚¹é›†æ‰“ä¹±åæ¯æ¬¡æš´åŠ›é‡æ¥å¤æ‚åº¦æ˜¯ O(n)O(n)O(n) . int n;Point P[N]; Circle min_circle() { mt19937 rd(time(0)); shuffle(P+1,P+n+1,rd); Circle c={P[1],0}; for(rint i=2;i&lt;=n;i++) if(dis(c.P,P[i])-c.r&gt;eps) { c={P[i],0}; for(rint j=1;j&lt;i;j++) if(dis(c.P,P[j])-c.r&gt;eps) { c={(P[i]+P[j])*0.5,dis(P[i],P[j])/2}; for(rint k=1;k&lt;j;k++) if(dis(c.P,P[k])-c.r&gt;eps) c=get_circle(P[i],P[j],P[k]); } } return c; } åœ†åæ¼”ï¼š åœ†å†…å¤–çš„ç‚¹ä¸€ä¸€æ˜ å°„ï¼ŒPPP ä¸ Pâ€²P&#x27;Pâ€² äº’ä¸ºåæ¼”å…³ç³» â‡”\\Leftrightarrowâ‡” âˆ£OPâˆ£â‹…âˆ£OPâ€²âˆ£=R2|OP|Â·|OP&#x27;|=R^2âˆ£OPâˆ£â‹…âˆ£OPâ€²âˆ£=R2 ä¸” OPPâ€²OPP&#x27;OPPâ€² å…±çº¿ã€‚ ä¸è¿‡åæ¼”åœ†å¿ƒçš„åœ†åæ¼”åä»ä¸ºåœ†ï¼Œrâ€²=12(1âˆ£OAâˆ£âˆ’râˆ’1âˆ£OAâˆ£+r)R2r&#x27;=\\frac 1 2 (\\frac 1 {|OA|-r}-\\frac 1 {|OA|+r})R^2râ€²=21â€‹(âˆ£OAâˆ£âˆ’r1â€‹âˆ’âˆ£OAâˆ£+r1â€‹)R2ï¼Œè¿‡åæ¼”åœ†å¿ƒçš„ç‚¹åæ¼”åä¸ºä¸¤äº¤ç‚¹è¿æˆçš„ç›´çº¿ã€‚ ä¸¤å›¾å½¢ç›¸åˆ‡å…¶å¯¹åº”çš„åæ¼”å›¾å½¢ä¹Ÿç›¸åˆ‡ã€‚ åº”ç”¨ï¼šæ±‚è¿‡ä¸¤åœ†å¤–ä¸€ç‚¹ä¸”ä¸ä¸¤åœ†ç›¸åˆ‡çš„æ‰€æœ‰çš„åœ†ã€‚è€ƒè™‘ä»¥è¯¥ç‚¹ä¸ºåæ¼”åœ†å¿ƒåšåœ†åæ¼”ï¼ŒåŠå¾„ä»»æ„ï¼Œé‚£ä¹ˆç¬¦åˆæ¡ä»¶çš„åœ†çš„åæ¼”ä¸ºä¸ä¸¤åœ†åæ¼”åçš„ä¸¤åœ†çš„å…¬åˆ‡çº¿ï¼ŒåŠ¨æ‰‹åšç‚¹è¾…åŠ©çº¿å°±å¯ä»¥æ¨å‡ºæ¥äº†ã€‚ å¤æ‚å›¾å½¢é¢ç§¯å¹¶ è¾›æ™®æ£®ç§¯åˆ†æ³•ï¼šå¤§è‡´å¯¹äºå›¾å½¢åˆ’åˆ†è¾¹ç•Œï¼Œå¯¹äºæ¯ä¸ªè¾¹ç•Œå†…éƒ¨ç”¨è¾›æ™®æ£®ç§¯åˆ†æ³•è®¡ç®—ï¼Œä¸æ–­å¾€ä¸‹é€’å½’ç›´åˆ°å·¦åŠå³åŠä¼°ç®—ä¹‹å’Œä¸æ€»ä½“ä¼°ç®—è¯¯å·®å¾ˆå°ï¼Œä¼°ç®—å…¬å¼ä¸º lenÃ—(f(l)+4f(mid)+f(r))/6len\\times(f(l)+4f(mid)+f(r))/6lenÃ—(f(l)+4f(mid)+f(r))/6 ï¼Œå¯ä»¥è¦æ±‚é€’å½’å±‚æ•°ã€‚ double f(double x) { //æš´åŠ›è®¡ç®—æ¨ªåæ ‡xè¢«è¦†ç›–çš„é•¿åº¦å’Œ } double cal(double l,double r) { return (r-l)*(f(l)+4*f((r+l)/2)+f(r))/6; } double sim(double l,double r,double ans,double Eps=eps,int dep=1) { double mid=(l+r)/2,lans=cal(l,mid),rans=cal(mid,r); if(abs(lans+rans-ans)&lt;=15*Eps&amp;&amp;dep&lt;0) return lans+rans+(lans+rans-ans)/15; return sim(l,mid,lans,Eps/2,dep-1)+sim(mid,r,rans,Eps/2,dep-1); } double work() { double ans=0; for(rint i=1;i&lt;n;i++) ans+=sim(step[i],step[i+1],cal(step[i],step[i+1])); return ans; } ä¸‰è§’å‰–åˆ† å‡¸åŒ…ï¼šéšä¾¿é€‰ä¸€ä¸ªç‚¹ä½œä¸ºä¸­å¿ƒï¼ŒæŠŠæ‰€æœ‰è¾¹ä½œä¸ºåº•ä¸è¯¥ç‚¹è¿è¾¹å°±å¯ä»¥äº†ã€‚ ä»»æ„å¤šè¾¹å½¢ï¼šè‹¥å¯ä»¥è´Ÿé¢ç§¯åˆ™æŒ‰å‡¸åŒ…çš„åšå°±å¯ä»¥äº†ï¼Œå¦åˆ™ O(n2)O(n^2)O(n2) æ¯æ¬¡æš´åŠ›æ‰¾ä¸€ä¸ªå‡¸è§’å‰–åˆ†é€’å½’ä¸‹å»ï¼Œä¸ä¼šæ›´ä¼˜å¤æ‚åº¦çš„åšæ³•ã€‚","categories":[],"tags":[{"name":"çœé€‰","slug":"çœé€‰","permalink":"https://saigonoinorio.github.io/tags/çœé€‰/"}],"keywords":[]},{"title":"å»ºç«™å°è®°","slug":"å»ºç«™å°è®°","date":"2022-12-04T18:19:43.000Z","updated":"2023-03-07T14:38:43.003Z","comments":false,"path":"2022/12/05/å»ºç«™å°è®°/","link":"","permalink":"https://saigonoinorio.github.io/2022/12/05/å»ºç«™å°è®°/","excerpt":"","text":"æœ€å¾Œã®ç¥ˆã‚Šã‚’çš„åšå®¢ï¼Œä»Šå¤©ï¼Œæˆç«‹äº†ï¼ \\é¼“æŒ/\\æ¬¢å‘¼/ æ­åšå®¢æƒ³æ³•å…¶å®åœ¨åˆšå­¦ OI æ²¡å¤šä¹…å°±æœ‰äº†ï¼Œå½“æ—¶çœ‹åˆ°è¾°æ˜Ÿå‡Œå­¦å§æ­å¾—å¤šä¹ˆå¥½ï¼Œä¸è¿‡å¤§æ¦‚æ˜¯æœ‰ç€å®Œç¾ä¸»ä¹‰çš„åä¹ æƒ¯çš„ç¼˜æ•…ï¼Œé€€å½¹äº†ä¹Ÿæ²¡æå‡ºæ¥ã€‚ï¼ˆå¤§å˜˜ï¼‰ æ€»ä¹‹åšå®¢è·Œè·Œæ’æ’åœ°æ˜¯æ­å¥½äº†ï¼Œä¸»é¢˜æ˜¯ç”¨çš„å°å­¦æ—¶å¼„ pixiv ç›´ç¿»åˆ«äººåšå®¢æ—¶ç›¸ä¸­çš„ sakura ä¸»é¢˜ï¼Œç©·å“¥ä»¬æ²¡æœ‰æœåŠ¡å™¨æ‰€ä»¥æ¢æˆäº†é™æ€çš„ hexo ç‰ˆæœ¬å¥½è·‘åœ¨ github ä¸Šï¼Œå½“æ—¶æ³¨å†Œ github æ—¶è¿˜ä¸çŸ¥é“ä»€ä¹ˆæ˜¯é™æ€åŠ¨æ€åšå®¢ï¼Œå‚»ä¹ä¹åœ°ä¼ äº†ä¸ª wordpress çš„åŠ¨æ€ç‰ˆæœ¬åœ¨ github ä¸Šä¹±æï¼Œä¹‹ååœ¨å‘ç°äº† hexo ç‰ˆæœ¬çš„æ­£ç¡®ä½¿ç”¨å§¿åŠ¿å°±æˆåŠŸ copy å¥½äº†ï¼Œä¸è¿‡å‘ç°æ²¡æœ‰ä»€ä¹ˆå¥½å†™çš„å°±ä¸¢åœ¨ä¸€è¾¹äº†ã€‚ ä¹‹ååˆ°äº†ä»¤å’Œçš„ä»Šå¤©ï¼Œæ´›è°·ä¸Šå·²ç»ä¸¢äº†å‡ ç¯‡è¿˜ç®—æœ‰æ„ä¹‰çš„æ–‡ï¼Œæ„Ÿè§‰æ˜¯æ—¶å€™é‡å¯åšå®¢ä¼åˆ’äº†ï¼Œæ‰€ä»¥å°±æ‰¾äº†æœ‰çˆ±â™‚å·¢ç»éªŒçš„åŒå­¦ç®€å•å­¦äº†ä¸‹æµç¨‹ï¼ˆåœ¨æ­¤é¸Ÿè°¢ zlxFTHå­¦çŸ­ çš„æŒ‡å¯¼ï¼‰ï¼Œäº†è§£äº†ä¸‹å¤§æ¦‚åŸç†ï¼Œè·Ÿç€å‚»ç“œå¼æ•™å­¦å†æ¬¡æ­å¥½äº†åšå®¢ï¼Œä¸è¿‡å¾ˆä¸ç¬¦ç°åœ¨çš„å®¡ç¾ï¼Œæœ¬ç€å¼ºè¿«ç—‡çš„ç†å¿µä¸æ–­æ”¹æ”¹æ”¹æˆäº†ç°åœ¨çš„æ¨¡æ ·ï¼Œä¸è¿‡è¿˜æ²¡æœ‰å®Œå…¨ç«£å·¥å–µï¼Œåæ§½ä¸€ä¸‹åˆ°å¤„æ‰¾ç§‘æŠ€æœ€åä¸å¦‚å—¯å † cssï¼Œæ€»ä¹‹è¿˜æ˜¯å¾ˆæœ‰å®¶çš„æ„Ÿè§‰å‘è¯ºå“’ï¼ ä¸ºä¹‹å‰çš„åšæ–‡ç´¯æ­»ç´¯æ´»åœ°é€‚é…äº†ç®€ä»‹å’Œå›¾ç‰‡ï¼Œè¿˜æ˜¯éå¸¸æœ‰æˆå°±æ„Ÿå“’ï¼Œä½†æ„Ÿè§‰è‡ªå·±çš„åŠªåŠ›ä¸ä¹‹å‰æƒ³çš„æ”¹å˜ä¸–ç•Œçš„æŠ€æœ¯å®…å¼—å¦‚è¿œç”šï¼Œåˆ°åº•æ˜¯å“ªé‡Œå‡ºäº†é—®é¢˜å‘¢ï¼Ÿ ç«‹ä¸€ä¸ªå¤šå¤šå†™æ–‡çš„ flagï¼Œå†™å®Œè¿™ç¯‡ï¼Œè¿˜æœ‰ä¸‰ç¯‡ï¼Œå¾€åçš„äººç”Ÿä¹Ÿè¯·å¤šå¤šæŒ‡æ•™å•¦ï¼","categories":[],"tags":[{"name":"æ–‡è®°","slug":"æ–‡è®°","permalink":"https://saigonoinorio.github.io/tags/æ–‡è®°/"}],"keywords":[]},{"title":"èƒŒåŒ…ä¹±å­¦","slug":"èƒŒåŒ…ä¹±å­¦","date":"2022-11-04T09:21:55.000Z","updated":"2023-03-04T15:58:19.154Z","comments":false,"path":"2022/11/04/èƒŒåŒ…ä¹±å­¦/","link":"","permalink":"https://saigonoinorio.github.io/2022/11/04/èƒŒåŒ…ä¹±å­¦/","excerpt":"","text":"01èƒŒåŒ… nnn ä»¶ç‰©å“å¸¦ä½“ç§¯ cic_iciâ€‹ ä»·å€¼ wiw_iwiâ€‹ ï¼Œé€‰æ‹©è‹¥å¹²ä¸ªä½“ç§¯å’Œ â‰¤V\\leq Vâ‰¤V çš„ç‰©å“ä»·å€¼æœ€å¤§ã€‚ for(rint i=1;i&lt;=n;i++) for(rint j=all;j&gt;=c[i];j--) f[j]=max(f[j],f[j-c[i]]+w[i]); æ—¶é—´ O(nV)O(nV)O(nV) ï¼Œç©ºé—´ O(V)O(V)O(V) ã€‚ å®Œå…¨èƒŒåŒ… nnn ç§ç‰©å“å¸¦ä½“ç§¯ cic_iciâ€‹ ä»·å€¼ wiw_iwiâ€‹ æ— é™ä¸ªï¼Œé€‰æ‹©è‹¥å¹²ä¸ªä½“ç§¯å’Œ â‰¤V\\leq Vâ‰¤V çš„ç‰©å“ä»·å€¼æœ€å¤§ã€‚ for(rint i=1;i&lt;=n;i++) for(rint j=c[i];j&lt;=all;j++) f[j]=max(f[j],f[j-c[i]]+w[i]); æ—¶é—´ O(nV)O(nV)O(nV) ï¼Œç©ºé—´ O(V)O(V)O(V) ã€‚ å¤šé‡èƒŒåŒ… nnn ç§ç‰©å“å¸¦ä½“ç§¯ cic_iciâ€‹ ä»·å€¼ wiw_iwiâ€‹ æœ‰ numinum_inumiâ€‹ ä¸ªï¼Œé€‰æ‹©è‹¥å¹²ä¸ªä½“ç§¯å’Œ â‰¤V\\leq Vâ‰¤V çš„ç‰©å“ä»·å€¼æœ€å¤§ã€‚ å¯ä»¥æŠŠæ•°é‡äºŒè¿›åˆ¶æ‹†åˆ†åè·‘01èƒŒåŒ…ï¼Œæ—¶é—´ O(Vâˆ‘logâ¡numi)O(V\\sum \\log num_i)O(Vâˆ‘lognumiâ€‹) ï¼Œç©ºé—´ O(V)O(V)O(V) ã€‚ for(rint i=1;i&lt;=n;i++) { int cc=read(),ww=read(),num=read(); for(rint j=1;j&lt;num;j&lt;&lt;=1) num-=j,c[++nn]=cc*j,w[nn]=ww*j; c[++nn]=cc*num,w[nn]=ww*num; } ä¹Ÿå¯ä»¥å¯¹äºæ¯ç§ç‰©å“é€šè¿‡æšä¸¾%ä½“ç§¯çš„ä½™æ•°åˆ†å¼€è½¬ç§»ï¼Œåˆ©ç”¨å•è°ƒé˜Ÿåˆ—ä¼˜åŒ–è½¬ç§»ï¼Œæ—¶é—´ O(nV)O(nV)O(nV)ï¼Œç©ºé—´ O(V)O(V )O(V) ã€‚ for(rint i=1,ii=1;i&lt;=n;i++,ii^=1) { int c=read(),w=read(),num=read(); for(rint j=0;j&lt;c;j++) for(rint k=0,hh=0,tt=-1;j+k*c&lt;=all;k++) { while(hh&lt;=tt&amp;&amp;k-q[hh]&gt;num) hh++; if(hh&lt;=tt) f[ii][j+k*c]=max(f[!ii][j+k*c],f[!ii][j+q[hh]*c]+(k-q[hh])*w); else f[ii][j+k*c]=f[!ii][j+k*c]; while(hh&lt;=tt&amp;&amp;f[!ii][j+q[tt]*c]-q[tt]*w&lt;=f[!ii][j+k*c]-k*w) tt--; q[++tt]=k; } } æ··åˆèƒŒåŒ… å°±æ˜¯èƒŒåŒ…æœ‰1ã€è‹¥å¹²ã€æ— é™ä¸ªï¼ŒæŒ‰ç±»å‹è½¬ç§»å³å¯ã€‚ äºŒç»´è´¹ç”¨èƒŒåŒ… å¤šåŠ ä¸€ç»´å³å¯ã€‚ bool èƒŒåŒ… ä¾‹å¦‚æ±‚å­é›†å’Œä¹‹ç±»çš„ï¼Œbitset ä¼˜åŒ–ï¼Œæ—¶ç©ºå¤æ‚åº¦é™¤ Ï‰\\omegaÏ‰ ã€‚ åˆ†ç»„èƒŒåŒ… æ¯ç»„æœ€å¤šé€‰ä¸€ä»¶ç‰©å“ï¼Œå†…å±‚æšä¸¾ç»„å†…å³å¯ã€‚ æ ‘å½¢èƒŒåŒ… æ ‘ä¸Šçš„èƒŒåŒ…ï¼Œèƒ½å¦é€‰æ‹©ä¾èµ–æ ‘ä¸Šçš„å…³ç³»ï¼Œæœ´ç´ å®šä¹‰çŠ¶æ€ä¸€èˆ¬ä¸º f[u][i]f[u][i]f[u][i] è¡¨ç¤º uuu å­æ ‘é€‰ iii ä¸ªç‚¹çš„ä»·å€¼ï¼Œæœ´ç´ è½¬ç§»ä¸º f[u][i+j]=âˆ‘f[u][i]Ã—f[v][j]f[u][i+j]=\\sum f[u][i]\\times f[v][j]f[u][i+j]=âˆ‘f[u][i]Ã—f[v][j] ï¼Œå±•å¼€åˆ—é¡¹è®¡ç®—æˆ–æ˜¯è€ƒè™‘æ¯ä¸ªç‚¹å¯¹åªä¼šåœ¨ LCA è´¡çŒ® O(1)O(1)O(1) éƒ½å¯ä»¥å¾—å‡º O(nk2)O(nk^2)O(nk2) çš„å¤æ‚åº¦ï¼Œç‰©å“å¤§å°ä¸º1çš„è¯å»æ‰ä¸å¿…è¦çš„è½¬ç§»åˆ™ä¸º O(nk)O(nk)O(nk)ã€‚ æ ‘ä¸Šé€‰å®¹é‡ä¸º kkk çš„å¸¦ä½“ç§¯æƒå€¼ç‚¹ä¸”å±äºæ ¹è¿é€šå—çš„æœ€å¤§æƒå€¼å’Œï¼Œæœ´ç´  O(nk2)O(nk^2)O(nk2) ï¼Œè€ƒè™‘å¯¹åŸæ ‘ååºéå†åå¯ä»¥ä¾æ¬¡æ·»åŠ ï¼Œf[i][j]=max(f[iâˆ’1][jâˆ’c[i]]+w[i],f[iâˆ’sz[i]][j])f[i][j]=max(f[i-1][j-c[i]]+w[i],f[i-sz[i]][j])f[i][j]=max(f[iâˆ’1][jâˆ’c[i]]+w[i],f[iâˆ’sz[i]][j]) ï¼Œçœå»äº†åˆå¹¶æ“ä½œï¼Œå°±å¯ä»¥åšåˆ° O(nk)O(nk)O(nk) ã€‚ æ ‘ä¸Šé€‰å®¹é‡ä¸º kkk çš„å¸¦ä½“ç§¯æƒå€¼ç‚¹ä¸”å±äºä¸€ä¸ªè¿é€šå—çš„æœ€å¤§æƒå€¼å’Œï¼Œä¸Šè¿°åšæ³•+ç‚¹åˆ†æ²»ï¼Œæ ¹æ®ä¸»å®šç†ä»ç„¶ O(nk)O(nk)O(nk) ã€‚ æœ‰ trick æ˜¯ç»´æŠ¤å‰åç¼€èƒŒåŒ…ï¼Œå¯ä»¥å¿«é€Ÿè®¡ç®—æ’é™¤æŸä¸ªèŠ‚ç‚¹ä¸é€‰çš„æƒ…å†µã€‚ èƒŒåŒ…æ–¹æ¡ˆ å…·ä½“æ–¹æ¡ˆå’Œæ–¹æ¡ˆæ•°éƒ½æ˜¯å…ˆåšä¸€éèƒŒåŒ…å†å€’è¿‡æ¥æœã€‚ æ€»æ•°é‡å°çš„èƒŒåŒ… O(2n/2)O(2^{n/2})O(2n/2) æŠ˜åŠæœç´¢ã€‚ æ»šåŠ¨å‰åç¼€èƒŒåŒ… å‰ç¼€èƒŒåŒ…æ˜¾ç„¶å¯ä»¥æ»šåŠ¨ï¼Œæ»šåŠ¨åç¼€èƒŒåŒ…è€ƒè™‘å…ˆæ±‚å‡ºæ€»èƒŒåŒ…ç„¶åä¾æ¬¡æ’¤å›ï¼Œå®¹æ˜“å‘ç°æ’¤å›å…¶å®å°±æ˜¯å€’ç€å»æ‰ç‰©å“çš„è´¡çŒ®ã€‚ æ€»ä½“ç§¯å°çš„å­é›†å’Œ å¯ä»¥è¯æ˜äºŒè¿›åˆ¶æ‹†åˆ†åç‰©å“æ€»æ•°é‡çº§åˆ«ä¸º O(V)O(\\sqrt V)O(Vâ€‹) ï¼Œç„¶åè·‘01èƒŒåŒ…ï¼Œæ—¶é—´ O(n+VV)O(n+V\\sqrt V)O(n+VVâ€‹) ï¼Œç©ºé—´ O(n+C)O(n+C)O(n+C) ã€‚ å•ä½“ç§¯å°çš„èƒŒåŒ… å­é›†å’Œ nnn ä¸ª â‰¤D\\leq Dâ‰¤D çš„å…ƒç´ ï¼Œæ±‚æ˜¯å¦å­˜åœ¨å­é›†å’Œä¸º CCCã€‚ é¦–å…ˆæ‰¾åˆ°æ»¡è¶³ âˆ‘kwiâ‰¤C\\sum^k w_i\\leq Câˆ‘kwiâ€‹â‰¤C æœ€å¤§çš„ kkk ï¼ŒæŠŠå‰é¢çš„å–è´Ÿï¼Œè¿™æ · Câ†Câˆ’âˆ‘kwi&lt;DC\\leftarrow C-\\sum^k w_i &lt; DCâ†Câˆ’âˆ‘kwiâ€‹&lt;D ï¼Œè€ƒè™‘å®šä¹‰ can(tot,l,r)can(tot,l,r)can(tot,l,r) è¡¨ç¤ºæ˜¯å¦å­˜åœ¨ Î»âˆˆ{0,1}\\lambda \\in\\{0,1\\}Î»âˆˆ{0,1} ä½¿å¾— âˆ‘i=1lâˆ’1wi+âˆ‘i=lrÎ»iwi=tot\\sum_{i=1}^{l-1}w_i+\\sum^r_{i=l}\\lambda _iw_i=totâˆ‘i=1lâˆ’1â€‹wiâ€‹+âˆ‘i=lrâ€‹Î»iâ€‹wiâ€‹=tot ï¼Œå‘ç°å›ºå®š tot,rtot,rtot,r åˆ™ can(tot,l,r)=1can(tot,l,r)=1can(tot,l,r)=1 çš„ lll ä¸ºä¸€æ®µå‰ç¼€ï¼ŒåŒç†å›ºå®š tot,ltot,ltot,l åˆ™ can(tot,l,r)=1can(tot,l,r)=1can(tot,l,r)=1 çš„ rrr ä¸ºä¸€æ®µåç¼€ï¼Œå®šä¹‰ f[tot][r]f[tot][r]f[tot][r] è¡¨ç¤ºæ»¡è¶³ can(tot,l,r)=1can(tot,l,r)=1can(tot,l,r)=1 çš„æœ€å¤§çš„ lll ï¼Œæ˜¾ç„¶æœ‰ f[tot][r]â‰¤f[tot][r+1]f[tot][r]\\leq f[tot][r+1]f[tot][r]â‰¤f[tot][r+1] ï¼Œè€ƒè™‘è½¬ç§»æœ‰ {f[tot+wr+1][r+1]â†f[tot][r]f[tot][r+1]â†f[tot][r]f[totâˆ’wl][r]â†l,lâˆˆ[f[tot][râˆ’1],f[tot][r])\\left\\{\\begin{matrix}f[tot+w_{r+1}][r+1]\\leftarrow f[tot][r] &amp; &amp; \\\\ f[tot][r+1]\\leftarrow f[tot][r] &amp; &amp; \\\\ f[tot-w_l][r]\\leftarrow l,l\\in[f[tot][r-1],f[tot][r]) &amp; &amp; \\end{matrix}\\right. â©â¨â§â€‹f[tot+wr+1â€‹][r+1]â†f[tot][r]f[tot][r+1]â†f[tot][r]f[totâˆ’wlâ€‹][r]â†l,lâˆˆ[f[tot][râˆ’1],f[tot][r])â€‹â€‹â€‹ æ—¶é—´ O(nD)O(nD)O(nD) ï¼Œç©ºé—´ O(n+D)O(n+D)O(n+D) ã€‚ for(rint i=N-W+1;i&lt;=N;i++) dp[0][i]=0; for(rint i=N+1;i&lt;=N+W;i++) dp[0][i]=1; dp[0][N-C+sum]=st; for(int i=st;i&lt;=n;i++,ii^=1) { for(rint j=N-W+1;j&lt;=N+W;j++) dp[ii][j]=dp[ii^1][j]; for(rint j=N-W+1;j&lt;=N;j++) dp[ii][j+w[i]]=max(dp[ii][j+w[i]],dp[ii^1][j]); for(rint j=N+w[i];j&gt;N;j--) for(rint k=dp[ii][j]-1;k&gt;=dp[ii^1][j];k--) dp[ii][j-w[k]]=max(dp[ii][j-w[k]],k); } éšæœºæ‰“ä¹±é›†åˆï¼ŒæœŸæœ›è¿‡ç¨‹ä¸­æœ€å€¼ä¸º O(nD)O(\\sqrt nD)O(nâ€‹D) ï¼Œç›´æ¥ bitset æš´åŠ›èƒŒåŒ…ï¼Œæ—¶é—´ O(nnDÏ‰)O(\\frac {n\\sqrt nD} {\\omega})O(Ï‰nnâ€‹Dâ€‹) ï¼Œç©ºé—´ O(n+nDÏ‰)O(n+\\frac {\\sqrt nD} {\\omega})O(n+Ï‰nâ€‹Dâ€‹) ã€‚ å‡¸å‡½æ•° max å·ç§¯ å‰ç½®çŸ¥è¯†ï¼šå‡¸å‡½æ•° (max,+)(max,+)(max,+) å·ç§¯ï¼Œå³æ±‚ ci=max(aj+biâˆ’j)c_i=max(a_j+b_{i-j})ciâ€‹=max(ajâ€‹+biâˆ’jâ€‹)ï¼Œä¸” bbb ä¸ºå‡¸å‡½æ•° ã€‚è®° cic_iciâ€‹ åœ¨ bbb çš„å†³ç­–ä½ç½®ä¸º posipos_iposiâ€‹ ï¼Œé‚£ä¹ˆæœ‰ posiâˆ’1â‰¤posipos_{i-1}\\leq pos_iposiâˆ’1â€‹â‰¤posiâ€‹ ï¼Œå¯ä»¥åˆ†æ²»åšåˆ° O(nlogâ¡)O(n\\log)O(nlog) ã€‚ 01èƒŒåŒ… ç‰©å“ä½“ç§¯ â‰¤D\\leq Dâ‰¤Dï¼Œå®¹é‡ä¸º CCC ã€‚å¯¹äºç›¸åŒé‡é‡çš„ç‰©å“ï¼Œæˆ‘ä»¬è‚¯å®šå°†ä»·å€¼ä»å¤§åˆ°å°è´ªå¿ƒå–ï¼Œå›¾åƒä¸ºä¸€ä¸ªå‡¸å‡½æ•°ã€‚å› æ­¤æˆ‘ä»¬å°†èƒŒåŒ…åœ¨æ¨¡ CCC æ„ä¹‰ä¸‹åˆ†åˆ«åš (max,+)(max,+)(max,+) å·ç§¯å³å¯ï¼Œæ—¶é—´ O(nlogâ¡+DClogâ¡C)O(n\\log+DC\\log C)O(nlog+DClogC)ï¼Œç©ºé—´ O(n+C)O(n+C)O(n+C)ã€‚ å®Œå…¨èƒŒåŒ… ç‰©å“ä½“ç§¯ â‰¤D\\leq Dâ‰¤Dï¼Œå®¹é‡ä¸º CCC ã€‚æ³¨æ„åˆ°å¯¹äº i&gt;Di&gt;Di&gt;Dï¼Œæœ‰ dpi=maxj+k=i(dpj+dpk)dp_i=max_{j+k=i}(dp_j+dp_k)dpiâ€‹=maxj+k=iâ€‹(dpjâ€‹+dpkâ€‹)ï¼Œä¸”å¦‚æœ âˆ£jâˆ’kâˆ£&gt;D|jâˆ’k|&gt;Dâˆ£jâˆ’kâˆ£&gt;Dï¼Œæˆ‘ä»¬å§‹ç»ˆå¯ä»¥è°ƒæ•´å¾—åˆ° âˆ£jâˆ’kâˆ£â‰¤D|jâˆ’k|â‰¤Dâˆ£jâˆ’kâˆ£â‰¤Dã€‚ å› æ­¤é€šè¿‡ [dpjâˆ’D/2,â‹¯,dpj+D/2][dp_{jâˆ’D/2},â‹¯,dp_{j+D/2}][dpjâˆ’D/2â€‹,â‹¯,dpj+D/2â€‹] ä»¥åŠ [dpkâˆ’D/2,â‹¯,dpk+D/2][dp_{kâˆ’D/2},â‹¯,dp_{k+D/2}][dpkâˆ’D/2â€‹,â‹¯,dpk+D/2â€‹]ï¼Œå¯ä»¥æš´åŠ›å·ç§¯å¾—åˆ° dpj+kdp_{j+k}dpj+kâ€‹ çš„å€¼ã€‚ ç°åœ¨ï¼Œå‡å¦‚æˆ‘ä»¬çŸ¥é“äº† [dpkâˆ’D,â‹¯,dpk+D][dp_{kâˆ’D},â‹¯,dp_{k+D}][dpkâˆ’Dâ€‹,â‹¯,dpk+Dâ€‹]ï¼Œå®ƒå·è‡ªå·±å¯ä»¥å¾—åˆ° [dp2kâˆ’D,â‹¯,dp2k+D][dp_{2kâˆ’D},â‹¯,dp_{2k+D}][dp2kâˆ’Dâ€‹,â‹¯,dp2k+Dâ€‹]ï¼Œå› æ­¤é‡‡ç”¨å€å¢çš„å½¢å¼å¯ä»¥å¿«é€Ÿè®¡ç®—å‡º [dpCâˆ’D,â‹¯,dpC][dp_{Câˆ’D},â‹¯,dp_C][dpCâˆ’Dâ€‹,â‹¯,dpCâ€‹]ï¼Œç­”æ¡ˆå³ä¸ºå…¶ä¸­çš„æœ€å¤§å€¼ã€‚ åˆå§‹åŒ–çš„åœ°æ–¹ï¼Œæš´åŠ›è®¡ç®— [dp0,â‹¯,dp2D][dp_0,â‹¯,dp_{2D}][dp0â€‹,â‹¯,dp2Dâ€‹] å³å¯ï¼Œæ—¶é—´ O(D2logâ¡C)O(D^2\\log C)O(D2logC)ï¼Œç©ºé—´ O(n+D)O(n+D)O(n+D)ã€‚ Referenceï¼šèƒŒåŒ…ï¼Œå­é›†å’Œä»¥åŠ (max, +) å·ç§¯åœ¨ç‰¹æ®Šæƒ…å½¢ä¸‹çš„æ±‚æ³• - wlzhouzhuan - åšå®¢å›­","categories":[],"tags":[{"name":"noip","slug":"noip","permalink":"https://saigonoinorio.github.io/tags/noip/"}],"keywords":[]},{"title":"CSP-S 2022 çè®°","slug":"CSP-S 2022 çè®°","date":"2022-10-29T18:37:10.000Z","updated":"2023-03-04T16:05:05.757Z","comments":false,"path":"2022/10/30/CSP-S 2022 çè®°/","link":"","permalink":"https://saigonoinorio.github.io/2022/10/30/CSP-S 2022 çè®°/","excerpt":"","text":"ä¸ä¼šå†™æ–‡ï¼Œä¸è¿‡éƒ½æœ€åä¸€å›äº†è¿˜æ˜¯å†™ä¸€å†™ï¼Œè¿‘æœŸè®°å¿†åŠ›è¡°é€€ä¸¥é‡ä¸å†™å¯èƒ½å°±çœŸå¿˜äº†ï¼Œäº‰å–å†™çš„ä¸æ¯”å»å¹´çƒ‚ï¼Œå„ç§å•¥å•¥æ ‡ç‚¹ç”¨è¯æ–­å¥æ’åºè¯¦ç•¥æˆ‘éƒ½è€ƒè™‘ä¸ç®¡äº†ï¼Œåæ­£æˆ‘ä»æ¥éƒ½æ²¡çœ¼çœ‹è‡ªå·±å†™çš„ä¸œè¥¿ã€‚ day -100+ ç»§æ‰¿åˆ°äº†ç¬¬ä¸€éƒ¨æ™ºèƒ½æœº iPhoneXsï¼Œç”¨ç€å¾ˆèˆ’æœï¼Œè€ƒè™‘åˆ°æˆ‘æ¯”è¾ƒç„¦è™‘æ‰€ä»¥å½“æ—¶æ²¡å•¥æ­£åé¦ˆã€‚ å—è¿«æ€§è¢«è´­ç½®äº†ä¸€å°ç¬”è®°æœ¬ï¼Œç”¨ç€å¾ˆèˆ’æœï¼Œè€ƒè™‘åˆ°æˆ‘æ¯”è¾ƒç„¦è™‘æ‰€ä»¥å½“æ—¶æ²¡å•¥æ­£åé¦ˆã€‚ æ€»ä¹‹æ–°æœºè£…ä¿®è¿˜æ˜¯goodçˆ½å•Šï¼Œåæ­£æˆ‘ä»å°å°±å–œæ¬¢è¿™ä¸ªï¼Œå¯èƒ½æ¯”è¾ƒç±»ä¼¼äºæ”¶é›†ç™–ä¹‹ç±»çš„ï¼Œæ„Ÿè§‰ä¸ç”¨å±•å¼€è®²ã€‚ ç¦»å¼€äº†åŒ—æµ·æ¥åˆ°äº†æ£®èŒæ‰¾åˆ°äº†å¸ˆå‚…ï¼Œç‰›æ ¡å‡ºç‰›å­ï¼Œè¢«å°ä¸¤å¹´çš„ç‰›å­éšæ„åŠæ‰“ï¼Œä¹‹å‰å­¦çš„å¤ªè‡ªé—­äº†ï¼Œçƒ­é—¹ç‚¹å­¦èµ·æ¥è¿˜æ˜¯å¾ˆå¿«ä¹çš„ã€‚ æ—¶é—´è¿‡å¾—å°±æ˜¯å¾ˆå¿«ï¼Œå‘ç”Ÿçš„å¾ˆå¤šå·²ç»è®°ä¸åˆ°äº†ï¼Œæˆ‘ä¸ªäººå¯èƒ½æåº¦å³å€¾ï¼Œä¸ä¼šé€‚åº”ç¯å¢ƒå’Œç¤¾äº¤ä¹‹ç±»çš„ï¼Œæ“ä½œå°±éå¸¸å˜å½¢éå¸¸æ‹‰å®ï¼Œåªèƒ½åŠè‡ªå·±çœ‹å¼€ç‚¹ç®—äº†ã€‚ day -50+ è‡ªç„¶è€Œç„¶çš„å‘å±•äº†ä¸€äº›å¨±ä¹æ´»åŠ¨ï¼Œå¯èƒ½éœ€è¦ç¨å¾®å›æƒ³ä¸€ä¸‹ï¼Œæ‘¸äº†å‡ æ‰‹æ¸¸æˆè¿˜æ˜¯å¾ˆæ§åˆ¶å‰‚é‡çš„ï¼Œvcbå¤æ´»äº†å»å·äº†æ‰‹æ’­æ”¾å™¨ï¼Œçœ‹äº†takagi3ï¼ŒArcaneï¼Œ93589ï¼ŒC100ï¼Œåæ­£ä¸è°ˆçç¢çš„è¯ï¼Œç¡®å®æˆ‘äººç”Ÿçš„è½¨è¿¹éƒ½æ˜¯è¿™äº›ç‚¹ç¼€çš„ï¼Œç°å®ç¡®å®æ²¡å•¥çˆ±å¥½ä¸æ„Ÿå…´è¶£ï¼Œåªèƒ½è¯´è¿˜æ˜¯è¦çˆ±æƒœè®°å¿†åŠ›ï¼Œå·²ç»å¼€å§‹è®°ä¸ä½å¾ˆå¤šä¸œè¥¿äº†ï¼Œå¦å¤–è¿˜çœ‹äº†å¾ˆå¤šå¾ˆæ£’çš„åº”è¯¥ä¹Ÿæ²¡å¿…è¦åˆ—ä¸¾äº†ï¼Œè¿˜æ˜¯ä¸æ–­æœ‰æ–°å…ƒç´ ï¼Œä¹‹å‰æ–‡åŒ–è¯¾çš„æ—¶å€™ç¡®å®æ˜¯ç²¾ç¥è¥å…»ä¸è‰¯ï¼Œäººéƒ½ä½ä¿—äº†ä¸€æˆªï¼Œç°åœ¨å¢ƒå†µè¿˜æ˜¯éå¸¸ä¸é”™çš„ã€‚ åæ­£å‡ å¤©çš„æš‘å‡å°±è¿™æ ·è¿‡å»äº†ï¼Œå°½åŠ›å»åšäº†äº›æœ‰æ„ä¹‰çš„äº‹æƒ…ï¼Œè‡³å°‘ç°åœ¨æˆ‘è¿˜è®°å¾—åˆ°ã€‚ ç„¶åæ˜¯ç–«æƒ…å°æ§ï¼Œæ“ä½œå°±éå¸¸çš„è¿·æƒ‘ï¼Œæ„Ÿè§‰å°±æå…¶è‡ªé—­ï¼Œè¶Šæ‰“è¶Šçƒ‚è¶Šçƒ‚è¶Šè‡ªé—­ï¼Œå°è±¡ä¸Šåæ­£å°±æ˜¯ç‰¹åˆ«ä½è°·ï¼Œåæ­£åé¢å°±çƒ‚åˆ°æ¯å¤©ä¸€ä¸¤ç‚¹è¿‡ç¡äº†ï¼Œä½œæ¯å°±ä¸€æ‹“ç­”è¾©ï¼Œåé¢çš„ç”Ÿç‰©é’Ÿä¹Ÿæ˜¯ä¹±åˆ°ç°åœ¨ï¼Œåæ­£å°±è€ƒè™‘ä¸ç®¡äº†èº«ä½“å·²ç»ä¹ æƒ¯äº†ï¼Œåº”è¯¥ä¹Ÿæ˜¯åŠ å‰§äº†å¤´ç–¼è®°å¿†åŠ›è¡°é€€ï¼Œä¸è¿‡ä»¥å‰ä¹Ÿæ˜¯è¿™ä¸ªé¬¼æ ·ï¼Œå› ç´ è¿˜æ˜¯å¾ˆå¤šçš„ï¼Œå¯èƒ½è¿˜æ˜¯è€ƒè™‘è§£å†³æŸäº›æ ¹æºä¸Šçš„é—®é¢˜ï¼Œä¸è¿‡ç¡®å®è¦æ…¢æ…¢å¾€å‰å¤šè°ƒè°ƒäº†ï¼Œé“ç†è¿˜æ˜¯å¾ˆæ˜¾ç„¶çš„ï¼Œåªèƒ½è¯´å°½é‡ï¼Œå› ä¸ºæˆ‘ç°åœ¨å°±åœ¨ç†¬å¤œç è¿™äº›å­—æˆ‘ä¹Ÿä¸æ™“å¾—æˆ‘ä¸ºå•¥å­è¦æ—©ç¡ä¸ºå•¥å­ä¸æ—©ç¡ã€‚ è¿˜æ˜¯å°è¯•äº†å¾ˆå¤šä»¥å‰æ²¡è¯•è¿‡çš„ä¸œè¥¿ï¼Œè¿˜æ˜¯éå¸¸åˆºæ¿€çš„ï¼Œä¸æ™“å¾—å¥½ä¹…ä»¥å‰ç•™ä¸‹çš„äº†ï¼Œåæ­£å°±æ˜¯å•¥å­éƒ½è¦å»è¯•ä¸€ä¸‹ï¼Œæ–°äº‹ç‰©çš„ä½“éªŒæ˜¯ç»æ— ä»…æœ‰çš„ï¼Œæœ‰ä¸€ç§äººç±»é‡æ€§çš„ç¾ã€‚ day -10+ é¦–å…ˆåˆ¨å»ä¸€è½¦æ²¡è¥å…»æŠŠæŠŠå«åº•çš„è”è€ƒã€‚ ä½“è‚²æ´»åŠ¨è¿˜æ˜¯å¾ˆå¥½çš„ï¼Œå”¤èµ·äº†å¾ˆå¤šè‚Œè‚‰è®°å¿†ï¼Œéå¸¸ç¥å¥‡çš„ï¼Œåº”è¯¥ä¹Ÿå”¤èµ·äº†å¾ˆå¤šæ¿€ç´ ä¹‹ç±»çš„ï¼Œç²¾ç¥å¥½äº†å¾ˆå¤šï¼Œæˆ‘éƒ½ä¸€å¹´å¤šæ²¡ä¸Šè¿‡ä½“è‚²è¯¾äº†ï¼Œå…³äºä½“è‚²è¯¾çº¯ç²¹å¥½è€çš„è®°å¿†å¥½åƒéƒ½åœåœ¨äº†å°å­¦ï¼Œå¯èƒ½æ˜¯æˆ‘æœ¬æ¥å°±ä¸å–œæ¬¢æ­£ç»ç«æŠ€ç±»ä½“è‚²è¿åŠ¨çš„ç¼˜æ•…ã€‚ æƒ³ä¸èµ·æ¥æœ‰å•¥å­å¯ä»¥å†™çš„äº†ï¼Œç¤¾äº¤æ„Ÿè§‰è¾¾åˆ°äº†æ­£å¸¸äººæ ‡å‡†ï¼Œå¯å–œå¯è´ºå¯å–œå¯è´ºã€‚ day -7+ å›äº†åŒ—æµ·ï¼Œåˆ°äº†å°±é¼»ç‚æ¶åŒ–ä»¥åŠæŸç§çœ¼éƒ¨ç–¾ç—…ï¼Œéš”ç¦»ä¸¤å¤©æ‘†äº†ä¸¤å¤©ï¼Œåƒäº†è¯å¯èƒ½æœ‰çº¢èŒ¶æ•ˆæœä¹ç‚¹é’Ÿå°±ç¡äº†ï¼Œç¬¬äºŒå¤©äººå°±æ­£å¸¸äº†å¾ˆå¤šï¼Œçœ‹ä¸Šå»æ—©ç¡å¯ä»¥è§£å†³å¤§å¤šæ•°é—®é¢˜ã€‚ æ•´äº†ä¸ªæ¨¡ç‰ˆè¡¥å®Œè®¡åˆ’ï¼Œpræ²¡å¤šå°‘ï¼Œä¸è¿‡è¿˜æ˜¯è¶…è¿‡äº†æœŸæœ›ï¼Œåšå®¢å•¥çš„è€ƒè™‘éœ€æ±‚å±‚æ¬¡ç†è®ºè¿˜æ˜¯å’•å’•å’•ç®—äº†ã€‚ æƒ³æ¿åˆ·ACwingè‡ªå·±è¿˜æ˜¯å¤ªæ‹‰äº†ï¼Œè€ƒè™‘ç”»å¤§é¥¼æ˜¯äººç±»é€šç—…ã€‚ å›äº†åŒ—æµ·æœºæˆ¿çœ‹åˆ°ä¸€ç‰‡ç‹¼è—‰ï¼Œæ–°ä¸€å±Šçš„å«ç”Ÿå®‰å…¨å­¦æœ¯éƒ½å¤ªæ‹‰å®äº†ï¼Œè™½ç„¶å½“æ—¶çš„æˆ‘è¿˜åœ¨å­¦æœç´¢ä¹‹ç±»çš„ï¼Œæ¡ä»¶ä¹Ÿæ²¡æœ‰ç°åœ¨è¿™ä¹ˆå¥½ï¼Œä½†è‡³å°‘åŸºæœ¬èŠ‚æ“å¾—æœ‰ï¼Œç°åœ¨å›å¤´çœ‹æ¥å­¦å¥½ç¡®å®éœ€è¦ä¸€äº›é‡è¦çš„ä¸œè¥¿ï¼Œæˆ‘ä¸è®¤ä¸ºä»–ä»¬ä¼šæ¯”æˆ‘å¼ºï¼Œä¸è¿‡åº”è¯¥æœ‰ä¸ªåˆ«æ­£å¸¸äººï¼Œè€ƒè™‘ä¸ç®¡ï¼ŒåŒ—æµ·ç¡®å®æ˜¯çƒ‚å®Œäº†ã€‚ ç¿»äº†ç¿»æ•™ç»ƒæ¬è¿‡æ¥çš„æ—§ä¹¦ï¼Œä¸€è½¦é—»æ‰€æœªé—»çš„è¿œå¤oiæ•™è¾…ï¼Œçœ‹äº†ä¸‹16å¹´çš„wcç™½çš®ä¹¦ï¼Œå‘ç°åŸæ¥beatsä¹Ÿæ˜¯åœ¨åŒ—æµ·è®²çš„ï¼ŒçœŸçš„æ˜¯ç¥–ä¸Šè£å…‰ï¼Œéš¾ä»¥æƒ³è±¡æ˜¯æ€ä¹ˆçƒ‚å¾—è¿™ä¹ˆå¿«çš„ã€‚ å­¦äº†æ‰‹NoiLinuxå’ŒArbiterçš„ä½¿ç”¨ï¼Œæ„Ÿè§‰è¿˜æ˜¯æœ‰å¿…è¦å¼€è™šæ‹Ÿæœºã€‚ æ‰“äº†csp2020å’Œcsp2021ï¼Œéšæ„300+ï¼Œä¸æ˜¯å¾ˆç†è§£ä»¥å‰çš„æˆ‘åœ¨æé©¬ï¼Œä¸è¿‡ä¿¡å¿ƒç¡®å®å¾ˆé‡è¦çš„ï¼Œå®åŠ›å¼±ä¸ç®¡ï¼Œå¿ƒæ€ä¸€å®šè¦å¥½ï¼Œè€ƒè™‘äººç±»ç§ã€‚ day 1 æ˜¨å¤©æ‰“äº†æ¨¡ç‰ˆæ´—äº†æ¾¡é™¶å†¶äº†æƒ…æ“ï¼Œæ—©ä¸Šèµ·æ¥åˆæ´—äº†ä¸ªæ¾¡ï¼Œæ‰§è¡Œçš„éå¸¸æ£’ï¼Œå°±æ˜¯ä¸­åˆæ¶¦å»è¥¿æ©™çš„æ—¶å€™å®¶é•¿å®‰æ’ç´Šä¹±æ‹–äº†å¾ˆå¤šè¡Œæå¾ˆä¹±å¾ˆåŒ†å¿™ï¼Œå¤§æ¦‚å†…å¿ƒæƒ³æ³•å’ŒSheldonæ˜¯ä¸€æ ·çš„ã€‚ æ€»ä¹‹åˆ°äº†è¥¿æ©™ï¼Œè¿˜æ˜¯æœ‰å¾ˆå¤šæ„Ÿæ…¨ä¸è¿‡è¦è€ƒè¯•æ‰€ä»¥è€ƒè™‘ä¸ç®¡ï¼Œè¿›å»äº†ä¹‹åæ„Ÿè§‰æ¯”å»å¹´éšæ„äº†å¾ˆå¤šï¼Œå°‘äº†å¾ˆå¤šæ–°é²œæ„Ÿï¼Œå‘ç°äº†ä»Šå¹´åŒ—æµ·äººè¿˜æ˜¯æ¯”è¾ƒå¤šï¼Œç„¶åå¬åˆ°äº†æœ‰ä½¬åœ¨å¼¹é’¢ç´ï¼Œä¸‹æ„è¯†å¬æˆäº†abçš„æ›²ï¼Œå“äº†ä¸€è·³ï¼Œç„¶åå‘ç°ä¸æ˜¯ã€‚ ä¸Šæ¥¼è¿›äº†è€ƒåœºï¼Œæ“ä½œæ¯”å»å¹´è‡ªç„¶ç†Ÿç»ƒäº†ä¸å°‘ï¼Œç»ˆäºåƒä¸ªæ­£å¸¸äººäº†ï¼Œå‘ç°æ—è¾¹çš„åŒå­¦åœ¨æ•²é”®ç›˜ï¼Œäºæ˜¯æˆ‘ä¹Ÿå¼€æ•²ï¼Œè°ƒäº†ä¸‹Devè®¾ç½®æ•²å®Œç¼ºçœæºï¼Œå°è¯•æ‰“å¼€è™šæ‹Ÿæœºï¼Œå‘ç°æœ‰å¯†ç ï¼Œæˆ‘ä¸çŸ¥é“å¯†ç ï¼Œå¯èƒ½æ˜¯å› ä¸ºçœé€‰çš„é˜´å½±æ²¡æœ‰é—®ç›‘è€ƒè€å¸ˆï¼Œè¯•å¯†ç è¯•åˆ°å¼€è€ƒä¹Ÿæ²¡è¯•å‡ºæ¥ï¼Œç»™è‡ªå·±å®šçš„é¢„æœŸç›®æ ‡æ˜¯ä¸€å®šè¦300+ã€‚ ä¸‹å‘äº†å‹ç¼©åŒ…ï¼Œé¢˜ç›®åå­—éƒ½æ¯”è¾ƒé«˜çº§ï¼Œæ²¡æœ‰bracketè¿™ç§æ¯’ç˜¤åå­—å…¶å®ä¹Ÿä¸æ…Œã€‚ æ…¢æ…¢ä»”ç»†çš„è¯»å®Œäº†T1ï¼Œé¢˜æ„å¾ˆæ¸…æ™°ï¼Œæ‰€ä»¥å°±å°è¯•å»åˆ‡ï¼Œèƒ¡ä¹±æƒ³äº†å¾ˆå¤šï¼Œè¿˜æ˜¯æ²¡æœ‰ä»€ä¹ˆå¥½çš„æ€è·¯ï¼ŒæœŸæœ›0.5håˆ‡æ‰ç»“æœ40minè¿˜æ²¡å¥½çš„æ€è·¯ï¼Œä¸è¿‡è¿™æ¬¡å¿ƒæ€æ¯”è¾ƒç¨³ï¼Œäºæ˜¯å†·é™çš„å»è¯»äº†T2ï¼Œæ„Ÿè§‰ä¸€çœ¼ç§’äº†åˆçœ‹äº†ä¸€éï¼Œç¡®è®¤åˆ‡äº†å‡†å¤‡å»çœ‹T3ï¼Œå‘ç°é¢˜ç›®æ¯”è¾ƒé•¿å‡†å¤‡ä¹‹åå†æ¥è¯»ï¼Œäºæ˜¯å¼€ç T2çº¿æ®µæ ‘ï¼Œå¤§æ¦‚10minå¤šå†™å®Œï¼Œä½†æ˜¯æ ·ä¾‹æŒ‚äº†åˆå¾ˆéš¾æ‰‹ç©ï¼Œäºæ˜¯ä¸‹å†³å¿ƒå†™äº†ä¸ªå¯¹æ‹ï¼Œç„¶åæ‰‹ç©æ”¹æ”¹æ”¹ï¼Œå¤§æ¦‚èŠ±äº†30miné¡ºåˆ©åˆ‡æ‰ã€‚ å›å¤´æƒ³T1åˆç»•äº†ä¸€äº›å¼¯è·¯ï¼Œå¿½ç„¶å°±æé†’äº†è‡ªå·±ä¸€ä¸‹è¿™æ˜¯T1ï¼Œè¿‡äº†ä¸€ä¸‹å¾€å¹´çš„éš¾åº¦äºæ˜¯å¼€å§‹æ¢å¼±æ™ºæ€è·¯ï¼Œå‘ç°è‡ªå·±ç¡®å®è¢«è¯ˆéª—äº†å°±å¿«é€Ÿç äº†ä¸ªmx123ï¼Œæ ·ä¾‹å¾ˆæ°´ä¸€ä¸‹å°±è¿‡äº†ï¼Œè¿™ä¸ªæ—¶å€™æ€»æ—¶é—´è¿‡å»äº†å¤§æ¦‚1h40minã€‚ å¼€å§‹è¯»T3ï¼Œéå¸¸é¡ºåˆ©åœ°è¯»å®Œäº†ï¼Œæ„Ÿè§‰æš´åŠ›éšä¾¿å†™ä½†æ˜¯æ­£è§£æ²¡æœ‰å¥½çš„æ€è·¯ï¼Œäºæ˜¯å»çœ‹T4ï¼ŒT4é¢˜æ„å¾ˆæ¸…æ™°ä¸è¿‡æœ‰ç§T1çš„æ—¢è§†æ„Ÿï¼Œæƒ³äº†ä¸ªå‡æš´åŠ›åšæ³•ä½†æ˜¯è·ŸT4éš¾åº¦ä¸æœï¼Œè§‰å¾—è‡ªå·±è‚¯å®šå‡ä½†æ˜¯å¾ˆå¥½å†™ï¼Œäºæ˜¯å…ˆç å†è¯´ï¼Œç å®Œå‘ç°è¿‡ä¸äº†æ ·ä¾‹è§‚å¯Ÿå‡ºäº†å‡ç‚¹ï¼Œdfsæ”¹æˆbfsæš´åŠ›å°±å†™å¥½äº†ã€‚ å‡†å¤‡å›å¤´å†™T3ï¼Œç®—äº†ç®—è‡ªå·±æ¯›ä¼°ä¼°300ï¼Œå·²ç»è¾¾åˆ°é¢„æœŸï¼Œäºæ˜¯å¯¹æ‹T1æ±‚ç¨³ï¼Œå¾ˆé¡ºåˆ©åœ°æ‹å®Œäº†ï¼Œè¿™æ—¶å¤§æ¦‚è¿˜å‰©1.5hï¼Œå‡†å¤‡å¼€å§‹å†™T3æš´åŠ›ï¼Œæˆ‘è¿˜æ²¡æƒ³å¥½æ€ä¹ˆåˆ¤å®šäºæ˜¯å…ˆå†™å®Œæ“ä½œï¼Œå†™å®Œå‘ç°åˆ¤å®šå¾ˆç®€å•ï¼Œäºæ˜¯ç¨å¾®æ”¹äº†ä¸‹é¡ºåˆ©è¿‡äº†æ ·ä¾‹ã€‚ å›å¤´çœ‹T4ï¼Œæš´åŠ›æ¡£å¾ˆå¤šï¼Œä¸è¿‡çœ‹åˆ°ç‰¹æ®Šæ€§è´¨åˆ†å¾ˆå¤šäºæ˜¯ä¸ç®¡k=1å’Œk=2å»æƒ³ç‰¹æ®Šæ€§è´¨ï¼Œå‘ç°å¾ˆç®€å•äºæ˜¯å¼€å†™ï¼Œé”…äº†å°±æ‰‹ç©æ ·ä¾‹æ…¢æ…¢è°ƒå‡ºæ¥äº†ï¼Œä¸­é€”è¿˜å»T3éšæ„å†™äº†å†™ä¸¤ä¸ª10åˆ†çš„éƒ¨åˆ†ï¼Œéšä¾¿åŠ äº†ä¸ªå¡æ—¶ï¼Œä¹Ÿæ²¡æœ‰æ‰“ç®—æ­£ç»æ‹¿åˆ†ï¼Œè°ƒT4æœ€åèŠ±äº†æŒºå¤šæ—¶é—´ï¼Œå¤§æ¦‚åœ¨ç»“æŸå‰10minè°ƒå‡ºæ¥äº†ï¼Œåå¤çªäº†å‡ éå››é“é¢˜æ²¡æœ‰å‘ç°é—®é¢˜å°±å‡†å¤‡äº¤å·äº†ã€‚ è€ƒå®Œæ‰å‘ç°è‡ªå·±ä¸€å£æ°´éƒ½æ²¡å–ä¹Ÿæ²¡ä¸Šå•æ‰€ï¼Œä¹Ÿæ²¡æœ‰æ³¨æ„åˆ°æœ‰äººå»ä¸Šå•æ‰€ï¼Œæ„è¯†åˆ°ä»Šå¤©å‘æŒ¥å¾ˆæ­£å¸¸ï¼Œæ½œæ„è¯†æƒ‹æƒœäº†ä¸‹å»å¹´çš„è‡ªå·±ã€‚ å‡ºäº†è¥¿æ©™æ ¡é—¨å‘ç°å¤©éƒ½é»‘å®Œäº†å•¥ä¹Ÿçœ‹ä¸æ¸…ï¼Œç„¶åå°±å…‰é€Ÿåä¸Šè¥å…»å¿«çº¿äº†ã€‚ ä¼°åˆ†ï¼š100+100+50+68=318 CCFï¼š100+100+95+68=363 day2 å‡Œæ™¨ç¡®å®æ˜¯day2ï¼Œå†™äº†è¿™ç¯‡æ–‡ç« ï¼Œå®Œç»“æ’’èŠ±èŠ±ã€‚ Tenshi","categories":[],"tags":[{"name":"æ–‡è®°","slug":"æ–‡è®°","permalink":"https://saigonoinorio.github.io/tags/æ–‡è®°/"}],"keywords":[]},{"title":"NOIP æ•°å­¦ç®€ç»“","slug":"NOIP æ•°å­¦ç®€ç»“","date":"2022-09-23T02:31:59.000Z","updated":"2023-03-07T14:38:05.454Z","comments":false,"path":"2022/09/23/NOIP æ•°å­¦ç®€ç»“/","link":"","permalink":"https://saigonoinorio.github.io/2022/09/23/NOIP æ•°å­¦ç®€ç»“/","excerpt":"","text":"ç´ æ•°å’Œçº¦æ•° ç´ æ•°åˆ¤å®š O(n)O(\\sqrt n)O(nâ€‹)ï¼šæšä¸¾â‰¤n\\leq \\sqrt nâ‰¤nâ€‹çš„æ•°çœ‹æ˜¯å¦èƒ½æ•´é™¤ã€‚ O(klogâ¡n)O(k\\log n)O(klogn)ï¼šMiller-Rabinç®—æ³•ï¼Œkä¸€èˆ¬å–10ï¼Œæœ€å¥½å–å‰12ä¸ªè´¨æ•°LLå†…ç¨³å®šåˆ¤ç´ . bool Miller_Rabin(int x) { if(x&lt;3||!(x&amp;1)) return x==2; int a=x-1,b=0; while(!(a&amp;1)) a&gt;&gt;=1,b++; int k=10; while(k--) { __int128 y=qp(rd()%(x-2)+2,a,x); if(y==1) continue; bool can=0; for(rint i=1;i&lt;=b;i++) { if(y==x-1) {can=1;break;} y=y*y%x; } if(!can) return 0; } return 1; } ç­›æ³• O(nlogâ¡logâ¡)O(n\\log\\log)O(nloglog)ï¼šåŸƒæ°ç­›ï¼Œæšä¸¾ç´ æ•°å€æ•°ï¼Œæ³¨æ„å‰ªæã€‚ void ishai(int n) { susu[++tot]=2; for(rint i=3;i&lt;=x;i+=2) if(!use[i]) { susu[++tot]=i; for(rint j=i*i;j&lt;=x;j+=2*i) use[j]=1; } } â€‹ O(n)O(n)O(n)ï¼šæ¬§æ‹‰ç­›ï¼Œåˆ©ç”¨æ˜¯å¦ä¸ºç´ æ•°ä¸ºç§¯æ€§å‡½æ•°æ¥ç­›ï¼Œè¿˜å¯ä»¥åœ¨æ­¤è¿‡ç¨‹ä¸­è®°å½•æ¯ä¸ªæ•°çš„ä¸€ä¸ªç´ å› å­åšåˆ° O(logâ¡)O(\\log)O(log) åˆ†è§£è´¨å› æ•°ï¼Œå¯¹äºç­›ç§¯æ€§å‡½æ•°éœ€è¦å®šä¹‰ f(p)f(p)f(p) å’Œ f(pk)f(p^k)f(pk) ï¼Œå¹¶ä¸”è®°å½• lowilow_ilowiâ€‹ è¡¨ç¤º iii çš„æœ€å°ç´ å› é¡¹ã€‚ void oshai(int n) { for(rint i=2;i&lt;=n;i++) { if(!use[i]) susu[++tot]=i; for(rint j=1;j&lt;=tot&amp;&amp;i*susu[j]&lt;=n;j++) { use[i*susu[j]]=1; if(!(i%susu[j])) break; } } } void ex_oshai(int n) { f[1]=low[1]1; for(rint i=2;i&lt;=n;i++) { if(!use[i]) susu[++tot]=i,f[i]=f_p,low[i]=i; for(rint j=1;j&lt;=tot&amp;&amp;i*susu[j]&lt;=n;j++) { use[i*susu[j]]=1; if(!(i%susu[j])) { low[i*susu[j]]=low[i]*susu[j]; if(low[i]==i) f[i*susu[j]]=f_p_k; else f[i*susu[j]]=f[i/low[i]]*f[low[i]*susu[j]]; break; } low[i*susu[j]]=susu[j]; f[i*susu[j]]=f[i]*f[susu[j]]; } } } æ•°è®ºåˆ†å— åˆ©ç”¨ âŒŠniâŒ‹\\left \\lfloor \\frac{n}{i} \\right \\rfloorâŒŠinâ€‹âŒ‹ åªæœ‰n\\sqrt nnâ€‹ç§å–å€¼ï¼Œç›¸åŒå–å€¼çš„ä¸€èµ·è®¡ç®—å³å¯ï¼Œr=n/n/lr=n/n/lr=n/n/lï¼Œkç»´æ•°è®ºåˆ†å—æ˜¯ O(kn)O(k\\sqrt n)O(knâ€‹) çš„ã€‚ æœ€å¤§å…¬çº¦æ•° å…·æœ‰å¯å¹¶æ€§ï¼Œå¯ä»¥ç”¨stè¡¨/çº¿æ®µæ ‘ç»´æŠ¤ã€‚ ä¸æ–­æ·»æ•°çš„è¯ï¼Œæ€»ä½“çš„ gcdâ¡\\gcdgcd åªä¼šå˜åŒ– logâ¡\\loglog æ¬¡ã€‚ å¯ä»¥æ‹†ä½ï¼Œè½¬åŒ–ä¸ºå¯¹å„è´¨å› æ•°çš„å¹‚æ¬¡å–minï¼ŒlcmåŒç†ã€‚ åŒä½™ è£´èœ€å®šç† ax+by=gcdâ¡(a,b)ax+by=\\gcd(a,b)ax+by=gcd(a,b)å¿…æœ‰ä¸€ç»„æ•´æ•°è§£ (x,y)(x,y)(x,y)ï¼Œå¯ä»¥æ‹“å±•åˆ°å¤šä¸ªçš„æƒ…å†µã€‚ è¿›ä¸€æ­¥ç»“è®ºï¼šæ»¡è¶³ ax+by=n(x,y,a,bâˆˆN)ax+by=n(x,y,a,b\\in N)ax+by=n(x,y,a,bâˆˆN) æœ‰è§£çš„ nnn ä»»æ„ä¸€å¯¹æ»¡è¶³ ni+njâ‰ aâˆ—bâˆ’aâˆ’bn_i+n_j\\ne a*b-a-bniâ€‹+njâ€‹î€ =aâˆ—bâˆ’aâˆ’b. åŒä½™æ–¹ç¨‹ æ‰©æ¬§å¯æ±‚ ax+by=gcdâ¡(a,b)ax+by=\\gcd(a,b)ax+by=gcd(a,b) çš„ä¸€ç»„å¯è¡Œè§£ï¼Œä¸€è§£å¯å¾—ä»»æ„è§£ï¼Œç”±æ­¤å¯æ±‚åŒä½™æ–¹ç¨‹ axâ‰¡1(modb)ax\\equiv 1\\pmod baxâ‰¡1(modb) è§£ã€‚ void exgcd(int a,int b,int &amp;x,int &amp;y) { if(!b) return x=1,y=0,void(); exgcd(b,a%b,x,y); swap(x,y),y=y-(a/b)*x; } æ‰©å±•æ¬§æ‹‰å®šç† abâ‰¡{ab%Ï†(p)gcdâ¡(a,p)=1abgcdâ¡(a,p)â‰ 1,b&lt;Ï†(p)ab%Ï†(p)+Ï†(p)gcdâ¡(a,p)â‰ 1,bâ‰¥Ï†(p)(modp)\\begin{equation} a^b\\equiv \\begin{cases} a^{b\\% \\varphi(p)}&amp;\\gcd(a,p)=1\\\\ a^b&amp;\\gcd(a,p)\\neq 1,b&lt;\\varphi(p)\\\\ a^{b\\%\\varphi(p)+\\varphi(p)}&amp;\\gcd(a,p)\\neq 1,b\\geq\\varphi(p) \\end{cases} \\pmod p \\end{equation} abâ‰¡â©â¨â§â€‹ab%Ï†(p)abab%Ï†(p)+Ï†(p)â€‹gcd(a,p)=1gcd(a,p)î€ =1,b&lt;Ï†(p)gcd(a,p)î€ =1,bâ‰¥Ï†(p)â€‹(modp)â€‹â€‹ è´¹é©¬å°å®šç† å¯¹äº pâˆˆprime&amp;gcdâ¡(a,p)=1p\\in prime\\&amp;\\gcd(a,p)=1pâˆˆprime&amp;gcd(a,p)=1ï¼Œæœ‰ apâˆ’1=1a^{p-1}=1apâˆ’1=1 . å¯ç”¨äºæ±‚è§£é€†å…ƒã€‚ å¨å°”é€Šå®šç† ppp ä¸ºç´ æ•° â‡”\\Leftrightarrowâ‡” (pâˆ’1)!â‰¡âˆ’1(modp)(p-1)!\\equiv -1\\pmod p(pâˆ’1)!â‰¡âˆ’1(modp). ä¹˜æ³•é€†å…ƒ O(logâ¡)O(\\log)O(log) å¿«é€Ÿå¹‚ï¼Œé€‚ç”¨äºæ»¡è¶³è´¹é©¬å°å®šç†çš„æƒ…å†µ. O(logâ¡)O(\\log)O(log) æ‰©æ¬§ï¼Œå³æ±‚è§£åŒä½™æ–¹ç¨‹ axâ‰¡1(modp)ax\\equiv1\\pmod paxâ‰¡1(modp)ï¼Œgcdâ¡(a,p)â‰ 1\\gcd(a,p)\\ne 1gcd(a,p)î€ =1 æ—¶æ— è§£ã€‚ O(n)âˆ’O(1)O(n)-O(1)O(n)âˆ’O(1) é¢„å¤„ç†ã€‚ inv[1]=1; for(rint i=2;i&lt;=n;i++) inv[i]=(p-p/i)*inv[p%i]%p; æ‰©å±•ä¸­å›½å‰©ä½™å®šç† æ±‚è§£æ¨¡çº¿æ€§åŒä½™æ–¹ç¨‹ç»„ {xâ‰¡b1 (mod a1)xâ‰¡b2 (mod a2)...xâ‰¡bn (mod an)\\begin{cases} x \\equiv b_1\\ ({\\rm mod}\\ a_1) \\\\ x\\equiv b_2\\ ({\\rm mod}\\ a_2) \\\\ ... \\\\ x \\equiv b_n\\ ({\\rm mod}\\ a_n)\\end{cases}â©â¨â§â€‹xâ‰¡b1â€‹ (mod a1â€‹)xâ‰¡b2â€‹ (mod a2â€‹)...xâ‰¡bnâ€‹ (mod anâ€‹)â€‹ è€ƒè™‘å¦‚ä½•å°†ä¸¤æ–¹ç¨‹åˆå¹¶ä¸ºä¸€ä¸ªï¼Œè€ƒè™‘å°† xxx å†™æˆä¸¤ä¸ªå«å¾…å®šç³»æ•°æ–¹ç¨‹çš„å½¢å¼ï¼Œåˆ™å¯åˆ—ç­‰å¼ï¼Œå‘ç°æ˜¯ä¸€ä¸ªä¸å®šæ–¹ç¨‹çš„å½¢å¼ï¼Œå…ˆç”¨è£´èœ€å®šç†åˆ¤æ— è§£ï¼Œå†ç”¨æ‰©æ¬§æ±‚ä¸€ç»„ç‰¹è§£ï¼Œå›ä»£æ±‚å‡ºä¸€ä¸ªç‰¹å®šçš„ xxx ï¼Œé‚£ä¹ˆæ–°çš„ a=lcm(a1,a2),b=x%aa=lcm(a_1,a_2),b=x\\%aa=lcm(a1â€‹,a2â€‹),b=x%a . ç»„åˆæ•°å­¦ äºŒé¡¹å¼å®šç† (a+b)n=âˆ‘(ni)aibnâˆ’i(a+b)^n=\\sum \\binom n i a^ib^{n-i}(a+b)n=âˆ‘(inâ€‹)aibnâˆ’i , (âˆ‘txi)n=âˆ‘(nn1,n2,...,nt)âˆtxini(\\sum^t x_i)^n=\\sum \\binom n {n_1,n_2,...,n_t} \\prod^t x_i^{n_i}(âˆ‘txiâ€‹)n=âˆ‘(n1â€‹,n2â€‹,...,ntâ€‹nâ€‹)âˆtxiniâ€‹â€‹ å¤šé‡æ’åˆ—ç»„åˆ å¤šé‡é›†æ’åˆ—æ•°=å¤šé‡ç»„åˆæ•°= (nn1,n2,...,nt)\\binom n {n_1,n_2,...,n_t}(n1â€‹,n2â€‹,...,ntâ€‹nâ€‹) = nâˆtni!\\frac n {\\prod^t n_i!}âˆtniâ€‹!nâ€‹ å¤šé‡é›†ç»„åˆæ•°ï¼šè‹¥é€‰æ‹©æ•°&lt;=æœ€å°æ•°é‡ï¼Œåˆ™é—®é¢˜ç­‰ä»·äº âˆ‘kxi=r\\sum^k x_i=râˆ‘kxiâ€‹=r çš„éè´Ÿæ•´æ•°è§£æ•°ç›®ï¼Œæ’æ¿æ³•å¯å¾— ans=(r+kâˆ’1kâˆ’1)ans=\\binom {r+k-1} {k-1}ans=(kâˆ’1r+kâˆ’1â€‹) . å¦åˆ™è€ƒè™‘å®¹æ–¥åŸç†æšä¸¾å“ªäº›æ•°é€‰å®Œï¼Œans=âˆ‘p=0k(âˆ’1)pâˆ‘âˆ£Aâˆ£=p(k+râˆ’1âˆ’pâˆ’âˆ‘nAikâˆ’1)ans=\\sum _{p=0}^k(-1)^p\\sum_{|A|=p} \\binom {k+r-1-p-\\sum n_{A_i}} {k-1}ans=âˆ‘p=0kâ€‹(âˆ’1)pâˆ‘âˆ£Aâˆ£=pâ€‹(kâˆ’1k+râˆ’1âˆ’pâˆ’âˆ‘nAiâ€‹â€‹â€‹) ä¸ç›¸é‚»ç»„åˆ nnn ä¸ªç›¸åŒç‰©å“é€‰ kkk ä¸ªä¸ç›¸é‚»çš„= (nâˆ’k+1k)\\binom {n-k+1} k(knâˆ’k+1â€‹) ï¼Œç†è§£ä¸ºåœ¨ nâˆ’kn-knâˆ’k ä¸ªæ•°é‡Œæ’ kkk ä¸ªä¸ç›¸é‚»çš„éš”æ¿ã€‚ åœ†æ’åˆ— (nâˆ’1)!(n-1)!(nâˆ’1)! ï¼Œè€ƒè™‘ä»»ä½•ä¸€ç§æ™®é€šæ’åˆ—éƒ½æœ‰nç§ç­‰ä»·åœ†æ’åˆ—ã€‚ é”™æ’ Dn=(nâˆ’1)(Dnâˆ’1+Dnâˆ’2)=nDnâˆ’1+(âˆ’1)n=n!âˆ‘(âˆ’1)ii!D_n=(n-1)(D_{n-1}+D_{n-2})=nD_{n-1}+(-1)^n=n!\\sum \\frac {(-1)^i} {i!}Dnâ€‹=(nâˆ’1)(Dnâˆ’1â€‹+Dnâˆ’2â€‹)=nDnâˆ’1â€‹+(âˆ’1)n=n!âˆ‘i!(âˆ’1)iâ€‹ ç»„åˆæ’ç­‰å¼ æ¯”ä¾‹å…¬å¼ (nk)=nk(nâˆ’1kâˆ’1)\\binom n k=\\frac n k \\binom {n-1} {k-1} (knâ€‹)=knâ€‹(kâˆ’1nâˆ’1â€‹) äºŒé¡¹å¼å®šç†ç‰¹ä¾‹ âˆ‘(âˆ’1)i(ni)=[n=0]\\sum (-1)^i\\binom n i=[n=0] âˆ‘(âˆ’1)i(inâ€‹)=[n=0] èŒƒå¾·è’™å¾·å·ç§¯ âˆ‘(ni)(mmâˆ’i)=(m+nm)\\sum \\binom n i \\binom m {m-i}=\\binom {m+n} m âˆ‘(inâ€‹)(mâˆ’imâ€‹)=(mm+nâ€‹) èŒƒå¾·è’™å¾·å·ç§¯ç‰¹ä¾‹(n=m) âˆ‘(ni)2=(2nn)\\sum \\binom n i ^2=\\binom {2n} n âˆ‘(inâ€‹)2=(n2nâ€‹) ç»„åˆæ•°å¸¦æƒå’Œ âˆ‘i(ni)=n2nâˆ’1\\sum i\\binom n i=n2^{n-1} âˆ‘i(inâ€‹)=n2nâˆ’1 å¯¹æ¶ˆå…¬å¼ (nm)(mk)=(nk)(nâˆ’kmâˆ’k)\\binom n m\\binom m k=\\binom n k\\binom {n-k} {m-k} (mnâ€‹)(kmâ€‹)=(knâ€‹)(mâˆ’knâˆ’kâ€‹) è‡ªå·å…¬å¼ âˆ‘(nâˆ’ii)=Fibn+1\\sum \\binom {n-i} i=Fib_{n+1} âˆ‘(inâˆ’iâ€‹)=Fibn+1â€‹ å¸æ”¶å…¬å¼ (nk)k=(nâˆ’1kâˆ’1)n\\binom n k k=\\binom {n-1} {k-1} n (knâ€‹)k=(kâˆ’1nâˆ’1â€‹)n (nk)(nâˆ’k)=(nâˆ’1k)n\\binom n k (n-k)=\\binom {n-1} k n (knâ€‹)(nâˆ’k)=(knâˆ’1â€‹)n å¹³è¡Œæ±‚å’Œ âˆ‘k(n+ii)=(n+k+1k)\\sum^k \\binom {n+i} i=\\binom {n+k+1} k âˆ‘kâ€‹(in+iâ€‹)=(kn+k+1â€‹) ä¸ŠæŒ‡æ ‡æ±‚å’Œ âˆ‘n(ik)=(n+1k+1)\\sum^n \\binom i k=\\binom {n+1} {k+1} âˆ‘nâ€‹(kiâ€‹)=(k+1n+1â€‹) ä¸‹æŒ‡æ ‡å·®æ±‚å’Œ âˆ‘k(ni)(âˆ’1)i=(âˆ’1)k(nâˆ’1k)\\sum ^k \\binom n i (-1)^i=(-1)^k\\binom {n-1} k âˆ‘kâ€‹(inâ€‹)(âˆ’1)i=(âˆ’1)k(knâˆ’1â€‹) Lucaså®šç† (nm)â‰¡(n/pm/p)Ã—(n%pm%p)(modp)\\binom n m\\equiv \\binom {n/p} {m/p} \\times \\binom {n\\%p} {m\\%p} \\pmod p (mnâ€‹)â‰¡(m/pn/pâ€‹)Ã—(m%pn%pâ€‹)(modp) å¡ç‰¹å…°æ•° Hn=âˆ‘Hiâˆ’1Hnâˆ’i=Hnâˆ’1(4nâˆ’2)n+1=(2nn)n+1=(2nn)âˆ’(2nnâˆ’1)H_n=\\sum H_{i-1}H_{n-i}=\\frac {H_{n-1}(4n-2)} {n+1}=\\frac {\\binom {2n} n} {n+1}=\\binom {2n} n -\\binom {2n} {n-1} Hnâ€‹=âˆ‘Hiâˆ’1â€‹Hnâˆ’iâ€‹=n+1Hnâˆ’1â€‹(4nâˆ’2)â€‹=n+1(n2nâ€‹)â€‹=(n2nâ€‹)âˆ’(nâˆ’12nâ€‹) â€‹ å«ä¹‰ï¼šâ‘  nnn ä¸ª 111 å’Œ nnn ä¸ª âˆ’1-1âˆ’1 æ’åˆ—ä½¿å¾—æ— è´Ÿå‰ç¼€çš„æ–¹æ¡ˆæ•°ã€â‘¡ nÃ—nn\\times nnÃ—n ç½‘æ ¼ä»å·¦ä¸‹åˆ°å³ä¸Šä¸”ä¸ç©¿å¯¹è§’çº¿çš„éé™è·¯å¾„æ•°ã€â‘¢ åœ†ä¸Š 2n2n2n ä¸ªç‚¹åˆ’ nnn æ¡çº¿æ®µä¸äº¤çš„æ–¹æ¡ˆæ•°ã€â‘£ n+2n+2n+2 ä¸ªç‚¹çš„å‡¸å¤šè¾¹å½¢ä¸‰è§’å‰–åˆ†æ–¹æ¡ˆæ•°ã€â‘¤ é•¿ä¸º nnn çš„å‡ºæ ˆåºåˆ—æ•°é‡ã€â‘¥ nnn ä¸ªç‚¹çš„äºŒå‰æ ‘å½¢æ€æ•°ã€‚ æ–¯ç‰¹æ—æ•° ç¬¬äºŒç±»æ–¯ç‰¹æ—æ•°ï¼š {nk}{n \\brace k}{knâ€‹} å³ S(n,k)S(n,k)S(n,k) ï¼Œè¡¨ç¤ºå°† nnn ä¸ªæ•°åˆ†ä¸º kkk ä¸ªéç©ºé›†åˆçš„æ–¹æ¡ˆæ•°. {nk}={nâˆ’1kâˆ’1}+k{nâˆ’1k}=âˆ‘m(âˆ’1)mâˆ’iini!(mâˆ’i)!{n \\brace k}={n-1 \\brace k-1}+k{n-1 \\brace k}=\\sum^m \\frac {(-1)^{m-i}i^n} {i!(m-i)!} {knâ€‹}={kâˆ’1nâˆ’1â€‹}+k{knâˆ’1â€‹}=âˆ‘mâ€‹i!(mâˆ’i)!(âˆ’1)mâˆ’iinâ€‹ ç¬¬ä¸€ç±»æ–¯ç‰¹æ—æ•°ï¼š [nk]{n \\brack k}[knâ€‹] ï¼Œè¡¨ç¤ºå°† nnn ä¸ªæ•°åˆ†ä¸º kkk ä¸ªåœ†æ’åˆ—çš„æ–¹æ¡ˆæ•°ã€‚ [nk]=[nâˆ’1kâˆ’1]+(nâˆ’1)[nâˆ’1k]{n \\brack k}={n-1 \\brack k-1}+(n-1){n-1 \\brack k} [knâ€‹]=[kâˆ’1nâˆ’1â€‹]+(nâˆ’1)[knâˆ’1â€‹] åäºŒé‡è®¡æ•°æ³• çƒä¸åŒç›’ä¸åŒï¼šmnm^nmnã€ çƒä¸åŒç›’ä¸åŒæ— ç©ºï¼šâˆ‘m(âˆ’1)i(mi)(mâˆ’i)n\\sum^m (-1)^i\\binom m i (m-i)^nâˆ‘m(âˆ’1)i(imâ€‹)(mâˆ’i)n ï¼ˆå®¹æ–¥ï¼‰ çƒä¸åŒç›’åŒï¼šâˆ‘m{ni}\\sum^m {n \\brace i}âˆ‘m{inâ€‹} çƒä¸åŒç›’åŒæ— ç©ºï¼š{nm}{n \\brace m}{mnâ€‹} çƒåŒç›’ä¸åŒï¼š(n+mâˆ’1mâˆ’1)\\binom {n+m-1} {m-1}(mâˆ’1n+mâˆ’1â€‹) çƒåŒç›’ä¸åŒéç©ºï¼š(nâˆ’1mâˆ’1)\\binom {n-1} {m-1}(mâˆ’1nâˆ’1â€‹) çƒåŒç›’åŒï¼šDPï¼ŒFn,m=Fnâˆ’m,m+Fn,mâˆ’1F_{n,m}=F_{n-m,m}+F_{n,m-1}Fn,mâ€‹=Fnâˆ’m,mâ€‹+Fn,mâˆ’1â€‹ï¼Œè€ƒè™‘å…¨éƒ¨+1æˆ–æ·»0å³å¯ çƒåŒç›’åŒéç©ºï¼šFnâˆ’m,mF_{n-m,m}Fnâˆ’m,mâ€‹ çº¿æ€§ä»£æ•° çŸ©é˜µä¹˜æ³• å…·æœ‰ç»“åˆå¾‹æ²¡æœ‰äº¤æ¢å¾‹ï¼Œå¯ä»¥åšå¿«é€Ÿå¹‚ï¼Œå¯ä»¥å¾ªç¯å±•å¼€ä¼˜åŒ–å¸¸æ•°ã€‚ åŠ é€Ÿé€’æ¨ã€ä½œä¸ºè¡¨è¾¾ä¿®æ”¹çš„tag å®šé•¿è·¯å¾„ç»Ÿè®¡ï¼šå®šé•¿è·¯å¾„æ•°é‡å³åškæ¬¡é‚»æ¥çŸ©é˜µçš„çŸ©ä¹˜ï¼Œå®šé•¿æœ€çŸ­è·¯å³åškæ¬¡é‚»æ¥çŸ©é˜µçš„floydï¼Œè‹¥ç»Ÿè®¡çš„æ˜¯ â‰¤\\leqâ‰¤ åŠ ä¸Šè‡ªç¯å³å¯ã€‚ é«˜æ–¯æ¶ˆå…ƒ é€æ­¥æ¶ˆæˆå¯¹è§’çŸ©é˜µå³å¯ï¼Œå½“å‰å…ƒè¦æ‰¾æ‰€åœ¨åˆ—ä¸­ç³»æ•°ç»å¯¹å€¼æœ€å¤§çš„ä¸€è¡Œï¼Œç„¶åå¯¹å…¶ä»–è¡Œæ¶ˆé™¤è¯¥å…ƒå³å¯ã€‚ è§£nå…ƒä¸€æ¬¡æ–¹ç¨‹ç»„ï¼Œç­”æ¡ˆå³ä¸ºç¬¬n+1åˆ—ã€‚ è®¡ç®—è¡Œåˆ—å¼ï¼šäº¤æ¢ä¸¤è¡Œæ—¶ç­”æ¡ˆå–åï¼Œæœ€ç»ˆç­”æ¡ˆå³ä¸ºå¯¹è§’ä¸Šçš„æ•°ä¹˜ç§¯ã€‚ æ±‚é€†çŸ©é˜µï¼šåœ¨åŸçŸ©é˜µå³è¾¹æ‹¼ä¸Šä¸€ä¸ªå•ä½çŸ©é˜µï¼ŒæŠŠå·¦è¾¹æ¶ˆæˆå•ä½çŸ©é˜µå³è¾¹å°±æ˜¯é€†çŸ©é˜µäº†ï¼Œæ¶ˆä¸å‡ºæ¥åˆ™æ— è§£ã€‚ å¼‚æˆ–æ–¹ç¨‹ç»„ï¼šè§£æ³•åŒç†ã€‚ çº¿æ€§åŸº ä¸€èˆ¬æŒ‡å¼‚æˆ–çº¿æ€§åŸºï¼Œç»´æŠ¤æ•°é›†çš„å¼‚æˆ–é›†åˆ(ä¸å«0ï¼Œå¦‚è¦ç»Ÿè®¡åˆ™è€ƒè™‘e[0]åè®°å½•æ˜¯å¦å‡ºç°0ï¼Œæ²¡æœ‰è¢«é€‰è¿›çº¿æ€§åŸºçš„æ•°å¯ç­‰ä»·çœ‹ä½œä¸º0)ï¼Œå¯ä»¥è´ªå¿ƒæ„é€ ï¼Œç»´æŠ¤ç‚¹å¯¹çš„å¼‚æˆ–é›†åˆæ˜¯01trieã€‚ void insert(int x) { for(rint i=50;~i;i--) if(x&gt;&gt;i&amp;1) { if(!e[i]) {e[i]=x;break;} x^=e[i]; } } å¼‚æˆ–çº¿æ€§åŸºçš„å¤§å°åªæœ‰ logâ¡V\\log VlogVï¼Œåˆå¹¶åªèƒ½é€ä¸ªæ’å…¥æ˜¯ O(logâ¡2)O(\\log ^2)O(log2) çš„ï¼ŒåŒºé—´çº¿æ€§åŸºå¯ä»¥ç”¨å‰ç¼€çº¿æ€§åŸºæ¥è´ªå¿ƒç»´æŠ¤ï¼Œé¢å¤–ç»´æŠ¤æ—¶é—´ä¿¡æ¯ï¼Œç›¸å¼‚æˆ–æ—¶swapç•™ä¸‹æ—¶é—´æ›´å¤§çš„ä¸€é¡¹å³å¯ã€‚ å®æ•°çº¿æ€§åŸºï¼šè€ƒè™‘å¼‚æˆ–çº¿æ€§åŸºçš„01æ”¹æˆäº†å®æ•°ï¼Œæ€§è´¨æ˜¯ç›¸åŒçš„ï¼Œå¤æ‚åº¦ä¼šé«˜ä¸€ç»´ã€‚","categories":[],"tags":[{"name":"noip","slug":"noip","permalink":"https://saigonoinorio.github.io/tags/noip/"}],"keywords":[]}]}